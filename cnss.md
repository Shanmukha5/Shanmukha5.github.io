- **Network Security and Cyber Defence (CNSS)**
    - This course provides a holistic view of modern network security including operating system hardening, firewalls, intrusion-detection systems, VPNs and Encryption. Physical Security, Standards, System Security and Security Policies are also included.
    - **Course Objectives**
        - Achieve skills to jump into penetration testing
        - Prepare for the Certified Network Security Specialist Exam
    - **Audience**
        - System administrators, network administrators, security professionals, students and anyone who is interested in network security technologies.
    - **Prerequisites **
        - Basic Familiarity with Windows Operating System
- **Module 1 : Introduction to Network Security**
    - Before diving into how to protect a network, exploring what networks are, would probably be a good idea.
    - For many readers this section will be a review, but for some it might be new material. Whether this is a review for you, or new information, having a thorough understanding of basic networking before attempting to study network security is critical. Also, be aware this is just a brief introduction of basic network concepts.
    - A network is simply a way for machines / computers to communicate.
    - At the physical level, it consists of all the machines you want to connect and the devices you use to connect them. Individual machines are connected either with a physical connection (a category 5 cable going into a network interface card, or NIC) or wirelessly. To connect multiple machines together, each machine must connect to a hub or switch, and then those hubs / switches must connect together. In larger networks, each subnetwork is connected to the others by a router.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d93df3ab-923b-4549-a1d5-8a76caf6945a/Annotation_2020-05-22_095802.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d93df3ab-923b-4549-a1d5-8a76caf6945a/Annotation_2020-05-22_095802.png)
    - **1.1.1 Basic Network Structure**
    - Some connection point(s) must exist between your network and the outside world. A barrier is set up between that network and the Internet, usually in the form of a firewall. The real essence of networks is communication allowing one machine to communicate with another.
    - However, every path of communication is also a possibility for an attack.
    - The first step in understanding how to defend a network, is having a detailed understanding of how computers communicate over a network. Network interface cards, switches, routers, hubs, and firewalls are the fundamental physical pieces of a network. The way they are connected and the format they use for communication is the network architecture.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/59ef1fee-e28b-41a2-b709-32fdf6d73c42/Annotation_2020-05-22_100053.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/59ef1fee-e28b-41a2-b709-32fdf6d73c42/Annotation_2020-05-22_100053.png)
    - **1.1.2 Data Packets**
    - After you have established a connection with the network (whether it is physical or wireless), you need to send data. The first part is to identify where you want to send it. All computers (as well as routers and switches), have an IP address that is a series of four numbers between 0 and 255 and is separated by periods, such as 192.168.0.1.
    - The second part is to format the data for transmission. All data is in binary form (1s and 0s). This binary data is put into packets, all less than about 65,000 bytes. The first few bytes are the header. That header tells where the packet is going, where it came from, and how many more packets are coming as part of this transmission. There is actually more than one header, but for now, we will just discuss the header as a single entity. Some attacks (IP spoofing, for example) try to change the header of packets in order to give false information. Other methods of attacks simply try to intercept packets and read the content (thus compromising the data).
    - A packet can have multiple headers. In fact, most packets will have at least three headers. The IP header has information such as IP addresses for the source and destination, as well as what protocol the packet is. The TCP header has information such as port number. The Ethernet header has information such as the MAC address for the source and destination. If a packet is encrypted with Transport Layer Security (TLS), it will also have a TLS header.
    - **1.1.3 IP Addresses**
    - The first major issue to understand is how to get packets to their proper destination. Even small networks have many computers that could potentially be the final destination of any packet sent. The Internet has millions of computers spread out across the globe. How do you ensure that a packet gets to its proper destination? The problem is not unlike addressing a letter and ensuring it gets to the correct destination. Let’s begin by looking at IP version 4 addressing because it is the most common in use today. This section also briefly discusses IP version 6.
    - An IP version 4 address is a series of four three-digit numbers separated by periods (An example is 192.168.1.1.) Each of the three-digit numbers must be between 0 and 255. An address of 192.168.0.257 would not be a valid one. The reason for this rule is that these addresses are actually four binary numbers: The computer simply displays them to you in decimal format.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/edbb07b7-96c5-47e9-a5b2-240744905153/Annotation_2020-05-22_100458.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/edbb07b7-96c5-47e9-a5b2-240744905153/Annotation_2020-05-22_100458.png)
    - Recall that 1 byte is 8 bits (1s and 0s), and an 8-bit binary number converted to decimal format will be between 0 and 255. The total of 32 bits means that approximately 4.2 billion possible IP version 4 addresses exist.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c2edfdc2-782c-4c9d-a6e0-2a7dfcfadd5b/Annotation_2020-05-22_100545.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c2edfdc2-782c-4c9d-a6e0-2a7dfcfadd5b/Annotation_2020-05-22_100545.png)
    - The IP address of a computer tells you a lot about that computer. The first byte (or the first decimal number) in an address reveals what network class that machine belongs to. Table 1-3 summarizes the five network classes.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8dcbfe11-d236-4106-a86c-1af9ebffe0be/Annotation_2020-05-22_100648.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8dcbfe11-d236-4106-a86c-1af9ebffe0be/Annotation_2020-05-22_100648.png)
    - The IP range of 127 is not listed in the above table. The IP address 127.0.0.1 designates the machine you are on, regardless the IP address assigned to your machine. This address is referred as the loopback address. That address is used in testing the machine and the NIC card.
    - These particular classes are important as they tell you what part of the address represents the network and what part represents the node. For example, in a Class A address, the first octet represents the network, and the remaining three represent the node. In a Class B address, the first two octets represent the network, and the second two represent the node. And finally, in a Class C address, the first three octets represent the network, and the last represents the node. There are also some very specific IP addresses and IP address ranges you should be aware of.
    - The first, as previously mentioned, is 127.0.0.1, or the loopback address. It is another way of referring to the network interface card of the machine you are on. Private IP addresses are another issue to be aware of. Certain ranges of IP addresses have been designated for use within networks.
    - These cannot be used as public IP addresses but can be used for internal
    - Workstations and servers. Those IP addresses are:
        - **10.0.0.0 to 10.255.255.255**
        - **172.16.0.0 to 172.31.255.255**
        - **192.168.0.0 to 192.168.255.255**
    - Sometimes people who are new to networking, have some trouble understanding public and private IP addresses. A good example is an office building. Within a single office building, each office number must be unique. You can only have one 101. And within that building, if you refer office 101 it is immediately clear what you are talking about.
    - But there are other office buildings, many of which have their own office 101. You can think of private IP addresses as office numbers. They must be unique within their network, but there may be other networks with the same private IP. Public IP addresses are more like traditional mailing addresses. Those must be unique worldwide.
    - When communicating from office to office you can use the office number, but to get a letter to another building you have to use the complete mailing address. It is much the same with networking. You can communicate within your network using private IP addresses, but to communicate with any computer outside your network, you have to use public IP addresses.
    - One of the roles of a gateway router is to perform what is called network address translation (NAT). Using NAT, a router takes the private IP address on outgoing packets and replaces it with the public IP address of the gateway router so that the packet can be routed through the Internet.
    - We have already discussed IP version 4 network addresses. Now let’s turn our attention to subnetting. Subnetting is simply splitting up a network into smaller portions. For example, if you have a network using the IP address 192.168.1.X (X being whatever the address is for the specific computer), then you have allocated 255 possible IP addresses. What if you want to divide that into two separate subnetworks? Subnetting is how you do that.
    - More technically, the subnet mask is a 32-bit number that is assigned to each host to divide the 32-bit binary IP address into network and node portions. You also cannot just put in any number you want. The first value of a subnet mask must be 255; the remaining three values can be 255, 254, 252, 248, 240, 224, or 128. Your computer will take your network IP address and the subnet mask and use a binary AND operation to combine them.
    - It may surprise you to know that you already have a subnet mask even if you have not used subnetting. If you have a Class C IP address, then your network subnet mask is 255.255.255.0. If you have a Class B IP address, then your subnet mask is 255.255.0.0. And finally, if it is Class A, your subnet mask is 255.0.0.0.
    - Now think about these numbers in relationship to binary numbers. The decimal value 255 converts to 11111111 in binary. So you are literally “masking” the portion of the network address that is used to define the network, and the remaining portion is used to define individual nodes. Now if you want fewer than 255 nodes in your subnet, then you need something like 255.255.255.240 for your subnet. If you convert 240 to binary, it is 11110000. That means the first three octets and the first 4 bits of the last octet define the network. The last 4 bits of the last octet define the node. That means you could have as many as 1111 (in binary) or 15 (in decimal) nodes on this subnetwork. This is the basic essence of subnetting.
    - Subnetting only allows you to use certain, limited subnets. Another approach is CIDR, or classless interdomain routing. Rather to define a subnet mask, you have the IP address followed by a slash and a number. That number can be any number between 0 and 32, which results in IP addresses like these:
        - 192.168.1.10/24 (basically a Class C IP address)
        - 192.168.1.10/31 (much like a Class C IP address with a subnet mask)
    - When you use this, rather than having classes with subnets, you have variable-length subnet masking (VLSM) that provides classless IP addresses. This is the most common way to define network IP addresses today.
    - You should not be concerned that new IP addresses are likely to run out soon. The IP version 6 standard is already available and methods are in place already to extend the use of IPv4 addresses. The IP addresses come in two groups: public and private.
    - The public IP addresses are for computers connected to the Internet. No two public IP addresses can be the same. However, a private IP address, such as one on a private company network, has to be unique only in that network. It does not matter if other computers in the world have the same IP address, because this computer is never connected to those other worldwide computers.
    - Network administrators often use private IP addresses that begin with a 10, such as 10.102.230.17. The other private IP addresses are 172.16.0.0–172.31.255.255 and 192.168.0.0–192.168.255.255.
    - Also, note that an ISP often will buy a pool of public IP addresses and assign them to you when you log on. Therefore, an ISP might own 1,000 public IP addresses and have 10,000 customers. Because all 10,000 customers will not be online at the same time, the ISP simply assigns an IP address to a customer when he or she logs on, and the ISP un-assigns the IP address when the customer logs off.
    - IPv6 utilizes a 128-bit address (instead of 32) and utilizes a hex numbering method in order to avoid long addresses such as 132.64.34.26.64.156.143.57.1.3.7.44.122.111.201.5.
    - The hex address format appears in the form of 3FFE:B00:800:2::C, for example. This gives you 2128 possible addresses (many trillions of addresses), so no chance exists of running out of IP addresses in the near future.
    - There is no subnetting in IPv6. Instead, it only uses CIDR. The network portion is indicated by a slash followed by the number of bits in the address that are assigned to the network portion, such as
        - /48
        - /64
    - There is a loopback address for IPv6, and it can be written as ::/128.
    - Other differences between IPv4 and IPv6 are described here:
        - Other stateful configuration flag (O flag).
        - When set to 1, the device should use DHCPv6 to obtain other TCP/IP configuration settings. In other words, it should use the DHCP server to set things like the IP address of the gateway and DNS servers.
        - Link/machine-local.
        - IPv6 version of IPv4’s APIPA or Automatic Private IP Addressing. So if the machine is configured for dynamically assigned addresses and cannot communicate with a DHCP server, it assigns itself a generic IP address. DHCP, or Dynamic Host Configuration Protocol, is used to dynamically assign IP addresses within a network.
        - IPv6 link/machine-local IP addresses all start with fe80::. So if your computer has this address, that means it could not get to a DHCP server and therefore made up its own generic IP address.
        - Site/network-local.
        - IPv6 version of IPv4 private address. In other words, these are real IP addresses, but they only work on this local network. They are not routable on the Internet.
        - All site/network-local IP addresses begin with FE and have C to F for the third hexadecimal digit: FEC, FED, FEE, or FEF.
        - DHCPv6 uses the Managed Address Configuration Flag (M flag).
        - When set to 1, the device should use DHCPv6 to obtain a stateful IPv6 address.
        - Other stateful configuration flag (O flag).
        - When set to 1, the device should use DHCPv6 to obtain other TCP/IP configuration settings. In other words, it should use the DHCP server to set things like the IP address of the gateway and DNS servers.
    - **1.1.4 Uniform Resource Locator (URL)**
    - For most people, the main purpose for getting on the Internet is web pages (but there are other things such as e-mail and file downloading). If you had to remember IP addresses and type those in, then surfing the Net would be difficult. Fortunately, you do not have to. You type in domain names that make sense to humans and those are translated into IP addresses. For example, you might type in [www.microsoft.com](http://www.microsoft.com/) to go to Microsoft’s website.
    - Your computer, or your ISP, must translate the name you typed in (called a Uniform Resource Locator, or URL) into an IP address. The DNS (Domain Name Service) protocol, which is introduced along with other protocols a bit later, handles this translation process. Therefore, you are typing in a name that makes sense to humans, but your computer is using a corresponding IP address to connect. If that address is found, your browser sends a packet (using the HTTP protocol) to TCP port 80. If that target computer has software that listens and responds to such requests (like web-server software such as Apache or Microsoft Internet Information Services), then the target computer will respond to your browser’s request and communication will be established.
    - This method is how web pages are viewed. If you have ever received an Error 404: File Not Found, what you’re seeing is that your browser received back a packet (from the web server) with error code 404, designating that the web page you requested could not be found. The web server can send back a series of error messages to your web browser, indicating different situations.
    - E-mail works the same way as visiting websites. Your e-mail client will seek out the address of your e-mail server. Then your e-mail client will use either POP3 to retrieve your incoming e-mail, or SMTP to send your outgoing e-mail. Your e-mail server (probably at your ISP or your company) will then try to resolve the address you are sending to. If you send something to [johndoe@gmail.com](mailto:johndoe@gmail.com), your e-mail server will translate that e-mail address into an IP address for the e-mail server at [gmail.com](http://gmail.com/), and then your server will send your e-mail there. Note that newer e-mail protocols are out there; however, POP3 is still the most commonly used.
    - IMAP is now widely used as well. Internet Message Access Protocol operates on port 143. The main advantage of IMAP over POP3 is it allows the client to download only the email headers, and then the user can choose which messages to fully download. This is particularly useful for smart phones.
    - **1.1.5 MAC Addresses**
    - MAC addresses are an interesting topic. A MAC address is a unique address for a network interface card (NIC). Every NIC in the world has a unique address that is represented by a six-byte hexadecimal number. The Address Resolution Protocol (ARP) is used to convert IP addresses to MAC addresses. So, when you type in a web address, the DNS protocol is used to translate that into an IP address. The ARP protocol then translates that IP address into a specific MAC address of an individual NIC.
    - IEEE assigns the first three bytes (24 bits) of the MAC address to a vendor. This part of the address is known as Organizationally Unique Identifier (OUI). The OUI helps professionals to determine the MAC address manufacturer. The remaining three bytes (24 bits) are assigned by the vendor. The MAC address is equal to 48 bits.
    - **1.1.6 Protocols**
    - Different types of communications exist for different purposes. The different types of network communications are called protocols. A protocol is, essentially, an agreed method of communication. In fact, this definition is exactly how the word protocol is used in standard, non-computer usage. Each protocol has a specific purpose and normally operates on a certain port. The table below lists some of the most important protocols.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/50ce0c9c-387e-4a60-83f5-6aa8ff88c7d4/Annotation_2020-05-22_113807.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/50ce0c9c-387e-4a60-83f5-6aa8ff88c7d4/Annotation_2020-05-22_113807.png)
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6f81ef03-6ff0-43cd-ab73-59a8b8e849cb/Annotation_2020-05-22_113832.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6f81ef03-6ff0-43cd-ab73-59a8b8e849cb/Annotation_2020-05-22_113832.png)
    - You should note that this list is not complete and hundreds of other protocols exist. All these protocols are part of a suite of protocols referred to as TCP/IP (Transmission Control Protocol/Internet Protocol).
    - The most important thing for you to realize is that the communication on networks takes place via packets, and those packets are transmitted according to certain protocols, depending on the type of communication that is occurring.
    - You might be wondering what a port is. Don’t confuse this type of port with the connections on the back of your computer, such as a serial port or parallel port. A port in networking terms is a handle, a connection point. It is a numeric designation for a particular pathway of communications.
    - All network communication, regardless of the port used, comes into your computer through the connection on your NIC. You might think of a port as a channel on your TV. You probably have one cable coming into your TV but you can view many channels. You have one cable coming into your computer, but you can communicate on many different ports.
    - ## 1.2 Guided Exercise: Analysing Network Traffic
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/041e2d7a-2606-42bb-8b35-08b334a974f5/Annotation_2020-05-22_114047.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/041e2d7a-2606-42bb-8b35-08b334a974f5/Annotation_2020-05-22_114047.png)
    - In this exercise you will use Wireshark to analyse network traffic.
    - Wireshark is already installed and you may start it by openening the Desktop folder called Exercises and then Wireshark. Double click Wireshark to open it.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9df7eaf-1c8b-48d6-acac-5ce1d7e1d2bd/Annotation_2020-05-22_114156.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9df7eaf-1c8b-48d6-acac-5ce1d7e1d2bd/Annotation_2020-05-22_114156.png)
    - Once Wireshark starts go to File -> Open and select the file called http form the folder Exercises -> Wireshark
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/07437254-f564-4682-a6d9-b7c041a6e0ac/Annotation_2020-05-22_114255.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/07437254-f564-4682-a6d9-b7c041a6e0ac/Annotation_2020-05-22_114255.png)
    - Once the file opens locate the Source and Destination IPv4 addresses. These should be 145.254.160.237 and 65.208.228.223 respectively.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2471ae38-c149-4704-8d7a-2fbd7f8651e8/Annotation_2020-05-22_114405.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2471ae38-c149-4704-8d7a-2fbd7f8651e8/Annotation_2020-05-22_114405.png)
    - Determine the Source Port and the Destination Port. These should be 3372 and 80 respectively.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/93cca765-f37e-4ae9-bd99-1ad5cb542106/Annotation_2020-05-22_114443.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/93cca765-f37e-4ae9-bd99-1ad5cb542106/Annotation_2020-05-22_114443.png)
    - ## 1.3 Guided Exercise: Analysing Telnet Network Traffic
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1cde67f1-70b2-4f0d-b12a-9eb180659bd7/Annotation_2020-05-22_114751.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1cde67f1-70b2-4f0d-b12a-9eb180659bd7/Annotation_2020-05-22_114751.png)
    - In this exercise you will use Wireshark to analyse network traffic.
    - Wireshark is already installed and you may start it by opening the Desktop folder called Exercises and then Wireshark. Double click Wireshark to open it.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/239f170a-0e23-4ed2-9e15-d808765e26d9/Annotation_2020-05-22_114859.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/239f170a-0e23-4ed2-9e15-d808765e26d9/Annotation_2020-05-22_114859.png)
    - Once Wireshark starts go to File -> Open and select the file called telnet-raw from the folder Exercises -> Wireshark.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d2536afc-656a-4fe3-8535-c7e85a1bf41a/Annotation_2020-05-22_114930.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d2536afc-656a-4fe3-8535-c7e85a1bf41a/Annotation_2020-05-22_114930.png)
    - Once the file opens locate the Source and Destination IPv4 addresses. These shoud be 192.168.0.2 and 192.168.0.1 respectively.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/264a456e-2e62-4a6e-9738-62617f872073/Annotation_2020-05-22_115004.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/264a456e-2e62-4a6e-9738-62617f872073/Annotation_2020-05-22_115004.png)
    - Determine the Source Port and Destination Port. These should be 1254 and 23 respectively.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/80ea12d6-e347-4095-99dd-dff2970472aa/Annotation_2020-05-22_115028.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/80ea12d6-e347-4095-99dd-dff2970472aa/Annotation_2020-05-22_115028.png)
    - Select packet number 4 and then right click on it. Go to Follow and then click on TCP Stream
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4f572944-e569-4d09-b08e-99af5299d6fb/Annotation_2020-05-22_115100.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4f572944-e569-4d09-b08e-99af5299d6fb/Annotation_2020-05-22_115100.png)
    - On the new window that opens you will observe the username and password the user used to login to the telnet server. This username is “fake” and the password is “user”.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1cff15e8-88aa-4fac-b081-ebf42811c888/Annotation_2020-05-22_115147.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1cff15e8-88aa-4fac-b081-ebf42811c888/Annotation_2020-05-22_115147.png)
    - ## 1.4 Basic Network Utilities
    - Now that you know what IP addresses and URLs are, you need to be familiar with some basic network utilities. You can execute some network utilities from a command prompt (Windows) or from a shell (Unix/Linux). Many people are already familiar with Windows, so we will focus on how to execute the commands from the Windows command-prompt perspective. However, these utilities are available in all operating systems.
    - ### 1.4.1 Ipconfig
    - The first thing you want to do is get information about your own system. To accomplish this, you must get a command prompt. In Windows, you do this by going to the Start menu, selecting All Programs, and then choosing Accessories. You can also go to Start, Run, and type cmd to get a command prompt. In Windows 10 you go to Search and type cmd. Now you can type in ipconfig. (You could input the same command in UNIX or Linux by typing in ifconfig from the shell.) After typing in ipconfig (ifconfig or ip addr in Linux), you should see something much like the below screenshot.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c1c94a47-2c75-4ea5-9dc7-449bd4a42d41/Annotation_2020-05-22_115614.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c1c94a47-2c75-4ea5-9dc7-449bd4a42d41/Annotation_2020-05-22_115614.png)
    - This command gives you information about your connection to a network (or to the Internet). Most importantly, you find out your own IP address. The command also has the IP address for your default gateway, which is your connection to the outside world. Running the ipconfig command is a first step in determining your system’s network configuration. Most commands including ipconfig have a number of parameters, or flags, which can be passed to the commands to make the computer behave in a certain way. You can find out what these commands are by typing in the command, followed by a space, and then typing in hyphen question mark: -?.
    - As you can see, you might use a number of options to find out different details about your computer’s configuration. The most commonly used method would probably be ipconfig/all.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/839163b2-2dd8-4af2-9419-e42b62fd03a9/Annotation_2020-05-22_115736.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/839163b2-2dd8-4af2-9419-e42b62fd03a9/Annotation_2020-05-22_115736.png)
    - ### 1.4.2 Ping
    - Another common used command is ping. Ping is used to send a test packet, or echo packet, to a machine to find out whether the machine is reachable and how long the packet takes to reach the machine. This useful diagnostic tool can be employed in elementary hacking techniques. Figure 1-3 shows the command.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/85eb3165-2efd-48fe-8567-fa32d64a765c/Annotation_2020-05-22_115844.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/85eb3165-2efd-48fe-8567-fa32d64a765c/Annotation_2020-05-22_115844.png)
    - The above command shows that a 32-byte echo packet was sent to the destination and returned. The TTL means “time to live.” That time unit is how many intermediary steps, or hops, the packet should take to the destination before giving up. Remember that the Internet is a vast conglomerate of interconnected networks. Your packet probably won’t go straight to its destination. It will have to take several hops to get there. As with ipconfig, you can type in ping -? to find out various ways you can refine your ping.
    - ### 1.4.3 Tracert
    - The next command is tracert. This command is a sort of “ping deluxe.” Tracert not only tells you whether the packet got there and how long it took, but it also tells you all the intermediate hops it took to get there. (This same command can be executed in Linux or UNIX, but it is called traceroute rather than tracert.) You can see this utility in Figure 1-4.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/350299ac-53cb-4c91-9a5e-ab5b6e1288bb/Annotation_2020-05-22_120259.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/350299ac-53cb-4c91-9a5e-ab5b6e1288bb/Annotation_2020-05-22_120259.png)
    - With tracert, you can see (in milliseconds) the time the IP addresses of each intermediate step listed, and how long it took to get to that step. Knowing the steps required to reach a destination can be very important.
    - ### 1.4.4 Netstat
    - Netstat is another interesting command. It is an abbreviation for Network Status. Essentially, this command tells you what connections your computer currently has. Don’t panic if you see several connections; that does not mean a hacker is in your computer. You will see many private IP addresses. This means your network has internal communication going on. You can see this in Figure 1-5.
    - Certainly, other utilities can be used when working with network communications. However, the four we just examined are the core utilities. These four (ipconfig, ping, tracert, and netstat) are absolutely essential to any network administrator.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b79cedcb-19f7-4109-b329-5ce2cd5c6c24/Annotation_2020-05-22_120744.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b79cedcb-19f7-4109-b329-5ce2cd5c6c24/Annotation_2020-05-22_120744.png)
    - ## 1.5 Guided Exercise: Using Basic Network Utilities
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/edb6eed5-bbb0-46f7-be2a-9aa5c0501526/Annotation_2020-05-22_120937.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/edb6eed5-bbb0-46f7-be2a-9aa5c0501526/Annotation_2020-05-22_120937.png)
    - In this exercise, you will use basic network utilities.
    - Use the ipconfig command on Windows 10 to identify the IP address.
    - Login to Windows 10 using the following credentials:
    - Username: Admin
    - Password: Pa$$w0rd
    - Once logged in right click on Start button.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dace99c6-bcce-4eee-84cd-1ffcb1f9a4bf/Annotation_2020-05-22_121457.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dace99c6-bcce-4eee-84cd-1ffcb1f9a4bf/Annotation_2020-05-22_121457.png)
    - Then select Command Prompt (Admin) and click Yes on the User Account Control window. On the command prompt window write the command ipconfig and then press the enter button.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a625aea4-7373-4abd-9899-01f6a4a7445f/Annotation_2020-05-22_121535.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a625aea4-7373-4abd-9899-01f6a4a7445f/Annotation_2020-05-22_121535.png)
    - Use the ping command on Windows 10 to ping the host 192.168.1.20
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/30523a5a-c299-4bf8-a7a6-73013f071a95/Annotation_2020-05-22_121610.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/30523a5a-c299-4bf8-a7a6-73013f071a95/Annotation_2020-05-22_121610.png)
    - Use the ipconfig command on Windows Server 2012 to identify the IP address.
    - Login to Windows Server 2012 using the following credentials:
    - Username: Administrator
    - Password: Pa$$w0rd
    - Then right click on the Start button and select Command Prompt (Admin)
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/599f381c-d56a-4639-9cc6-7f17812eab9a/Annotation_2020-05-22_121705.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/599f381c-d56a-4639-9cc6-7f17812eab9a/Annotation_2020-05-22_121705.png)
    - On the command prompt window write the command ipconfig and press enter.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9939a83a-28fd-4980-be0a-b4ccf077939d/Annotation_2020-05-22_121740.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9939a83a-28fd-4980-be0a-b4ccf077939d/Annotation_2020-05-22_121740.png)
    - Use the ping command on Windows Server 2012 to ping the host 192.168.1.30.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/21f88ed1-8ece-4b68-91ee-8376adf0538d/Annotation_2020-05-22_121808.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/21f88ed1-8ece-4b68-91ee-8376adf0538d/Annotation_2020-05-22_121808.png)
    - Use the ifconfig command on Ubuntu Server to identify the IP address. Login with the following credentials:
    - Username: user
    - Password: Pa$$w0rd
    - Once logged in click on the terminal icon (last icon) the left side menu.
    - On the terminal window write the command ifconfig and press enter.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/48680bab-79dd-4484-b7a2-3269a000ea31/Annotation_2020-05-22_121903.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/48680bab-79dd-4484-b7a2-3269a000ea31/Annotation_2020-05-22_121903.png)
    - Open a terminal window and use the command “ping –c 4 192.168.1.10” on Ubuntu Server to ping the host 192.168.1.10.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/082ab3f5-15c8-41aa-8b92-b3ff61b1ccef/Annotation_2020-05-22_121930.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/082ab3f5-15c8-41aa-8b92-b3ff61b1ccef/Annotation_2020-05-22_121930.png)
    - Use the command “netstat -tulpn” on the Ubuntu Server and observe the output. You will notice the Local Address bound with a port which is a specific service listening on that port and the Foreign Address which is a remote host connected to that specific service and the State which is Listening or can be Established in the case of a remote host connection.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/12b07f07-f3a7-4e0a-beb5-31d182de7325/Annotation_2020-05-22_122011.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/12b07f07-f3a7-4e0a-beb5-31d182de7325/Annotation_2020-05-22_122011.png)
    - Use the command “netstat –a” on the Windows Server 2012 and observe the output. You will notice the Local Address bound with a port which is a specific service listening on that port and the Foreign Address which is a remote host connected to that specific service and the State which is Listening or can be Established in the case of a remote host connection.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7f547c3e-e947-4dbc-a8a5-765666ec304d/Annotation_2020-05-22_122101.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7f547c3e-e947-4dbc-a8a5-765666ec304d/Annotation_2020-05-22_122101.png)
    - ## 1.6 The OSI Model
    - The Open Systems Interconnect (OSI) model describes how networks communicate (see Table 1-3). It describes the various protocols and activities and states how the protocols and activities relate to each other. This model is divided into seven layers. It was originally developed by the International Organisation for Standardization (ISO) in the 1980s.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e5d28d0b-5575-498f-81c5-b4bd7b826793/Annotation_2020-05-22_140818.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e5d28d0b-5575-498f-81c5-b4bd7b826793/Annotation_2020-05-22_140818.png)
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/16e7a034-e107-4857-b5a7-1a70804d0233/Annotation_2020-05-22_140913.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/16e7a034-e107-4857-b5a7-1a70804d0233/Annotation_2020-05-22_140913.png)
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dae49da9-463c-4c4c-9bd5-373137ccd15a/Annotation_2020-05-22_141006.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dae49da9-463c-4c4c-9bd5-373137ccd15a/Annotation_2020-05-22_141006.png)
    - ## 1.7 Threat Classification
    - Your network certainly faces real security threats, and these threats can manifest themselves in a variety forms. There are different ways one might choose to classify the various threats to your system. You could choose to classify them by the damage caused, the level of skill required to execute the attack, or perhaps even by the motivation behind the attack. For our purposes we categorize attacks by what they actually do. Based on that philosophy most attacks can be categorized as one of three broad classes:
        - Intrusion
        - Blocking
        - Malware
    - Figure 1-6 shows the three categories. The intrusion category includes attacks meant to breach security and gain unauthorised access to a system. This group of attacks includes any attempt to gain unauthorised access to a system. This is generally, what hackers do. The second category of attack, blocking, includes attacks designed to prevent legitimate access to a system. Blocking attacks are often called denial of service attacks (or simply DoS). In these types of attacks, the purpose is not to actually get into your system but simply to block legitimate users from gaining access. The third category of threats is the installation of malware on a system. Malware is a generic term for software that has a malicious purpose. It includes virus attacks, Trojan horses, and spyware.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4fe40454-7a49-4581-8820-ff292700aa7d/Annotation_2020-05-22_141501.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4fe40454-7a49-4581-8820-ff292700aa7d/Annotation_2020-05-22_141501.png)
    - ### 1.7.1 Malware
    - Malware is probably the most common threat to any system, including home users’ systems, small networks, and large enterprise wide-area networks. One reason is that malware is designed to spread on its own, without the creator of the malware having to be directly involved. This makes the malware attack much easier to spread across the Internet, and hence more widespread.
    - The most obvious example of malware is the computer virus. You probably have a general idea of what a virus is. If you consult different textbooks you will probably see the definition of a virus worded slightly differently. One definition for a virus is “a program that can ‘infect’ other programs by modifying them to include a possibly evolved copy of itself.” A computer virus is analogous to a biological virus in that both replicate and spread. The most common method for spreading a virus is using the victim’s e-mail account to spread the virus to everyone in his address book. Some viruses do not actually harm the system itself, but all of them cause network slowdowns or shutdowns due to the heavy network traffic caused by the virus replication.
    - Another type of malware, often closely related to the virus, is the Trojan horse. The term is borrowed from the ancient tale. In this tale, the city of Troy was besieged for a long period of time, but the attackers could not gain entrance. They constructed a huge wooden horse and left it one night in front of the gates to Troy. The next morning, the residents of Troy saw the horse and assumed it a gift, consequently rolling the wooden horse into the city. Unbeknownst to them, several soldiers were hidden inside the horse. That evening, the soldiers left the horse, opened the city gates, and let their fellow attackers into the city.
    - An electronic Trojan horse works in the same manner, appearing to be benign software but secretly downloading a virus or some other type of malware onto your computer. In short, you have an enticing gift that you install on your computer, and later find out it has unleashed something quite different from what you expected. It is a fact that Trojan horses are more likely to be found in illegitimate software. There are many places on the Internet to get pirated copies of commercial software. Finding that such software is actually part of a Trojan horse is not at all uncommon
    - Trojan horses and viruses are the two most widely encountered forms of malware. A third category of malware is spyware, which is increasing in a dramatic pace. Spyware is software that literally spies on what you do on your computer. This can be as simple as a cookie, a text file that your browser creates and stores on your hard drive.
    - Cookies are downloaded onto your machine by websites you visit. This text file is then used to recognise you when you return to the same site. That file can enable you to access pages more quickly and save you from having to enter your information multiple times on pages you visit frequently. However, in order to do this, that file must be read by the website; this means it can also be read by other websites. Any data that the file saves can be retrieved by any website, so your entire Internet browsing history can be tracked.
    - Another form of spyware, called a key logger, records all of your keystrokes. Some also take periodic screen shots of your computer. Data is then either stored for retrieval later by the party who installed the key logger or is sent immediately back via e-mail. In either case, everything you do on your computer is recorded for the interested party.
    - ### 1.7.2 Intrusions
    - Intrusions are those attacks that are actually trying to intrude into the system. They are different from attacks that simply deny users access to the system (blocking), or attacks that are not focused on a particular target such as viruses and worms (malware). Intrusion attacks are designed to gain access to a specific targeted system and are commonly referred to as hacking, although that is not the term hackers use. Hackers call this type of attack cracking, which means intruding onto a system without permission, usually with malicious intent. Any attack designed to breach security, either via some operating system flaw or any other means, can be classified as cracking.
    - Using security flaws is not the only method for intruding into a system. In fact, some methods can be technologically much easier to execute. For example, one completely not technologically based method for breaching a system’s security is called social engineering, which, as the name implies, relies more on human nature than technology. This was the type of attack that the famous hacker Kevin Mitnick most often used. Social engineering uses techniques to get users to offer up the information needed to gain access to a target system. The way this method works is rather simple.
    - The perpetrator obtains preliminary information about a target organisation, such as the name of its system administrator, and leverages it to gain additional information from the system’s users. For example, he might call someone in accounting and claim to be one of the company’s technical support personnel. The intruder could use the system administrator’s name to validate that claim. He could then ask various questions to learn additional details about the system’s specifications. A well-informed intruder might even get a person to provide a username and password. As you can see, this method is based on how well the intruder can manipulate people and actually has little to do with computer skills.
    - Social engineering and exploiting software flaws are not the only means of executing an intrusion attack. The growing popularity of wireless networks gives rise to new kinds of attacks. The most obvious and dangerous activity is war driving. This type of attack is an offshoot of war-dialing. With war-dialing, a hacker sets up a computer to call phone numbers in sequence until another computer answers to try and gain entry to its system. War driving, using much the same concept, is applied to locating vulnerable wireless networks. In this scenario, a hacker simply drives around trying to locate wireless networks. Many people forget that their wireless network signal often extends as much as 100 feet (thus, past walls). At DEFCON 2003, the annual hackers’ convention, contestants participated in a war-driving contest in which they drove around the city trying to locate as many vulnerable wireless networks as they could.
    - ### 1.7.3 Denial of Service
    - The third category of attacks is blocking attacks, an example of which is the denial of service attack (DoS). In this attack, the attacker does not actually access the system, but rather simply blocks access to the system from legitimate users. In the words of the CERT (Computer Emergency Response Team) Coordination Centre (the first computer security incident response team), “A ‘denial-of-service’ attack is characterised by an explicit attempt by attackers to prevent legitimate users of a service from using that service.” One often-used blocking method is flooding the targeted system with so many false connection requests that it cannot respond to legitimate requests. DoS is an extremely common attack method.
    - # 1.8 Security Terminology
    - Security professionals have specific terminology. Individuals or system administrators having experience in network administration are probably already familiar with most of these terms. Although most hacking terminology describes the activity or the person performing it (phreaking, sneaker, etc.).
    - The first and most basic security device is the firewall. A firewall is a barrier between a network and the outside world. Sometimes a firewall is a stand-alone server, sometimes a router, and sometimes software running on a machine. Whatever it’s physical form, the purpose is the same: to filter traffic entering and exiting a network. Firewalls are related to, and often used in conjunction with, a proxy server. A proxy server hides your internal network IP addresses and presents a single IP address (its own) to the outside world.
    - Firewalls and proxy servers are added to networks to provide basic perimeter security. They filter incoming and outgoing network traffic but do not affect traffic on the network. Sometimes these devices are augmented by an intrusion-detection system (IDS). An IDS monitor’s traffic looking for suspicious activity that might indicate an attempted intrusion.
    - Access control is another important computer security term. Access control is the aggregate of all measures taken to limit access to resources. This includes logon procedures, encryption, and any method that is designed to prevent unauthorised personnel from accessing a resource. Authentication is clearly a subset of access control, perhaps the most basic security activity.
    - Authentication is simply the process of determining whether the credentials given by a user or another system, such as a username and password, are authorised to access the network resource in question. When a user logs in with a username and password, the system attempts to authenticate that username and password. If they are authenticated, the user will be granted access.
    - Non-repudiation is another term you encounter frequently in computer security. It is any technique that is used to ensure that someone performing an action on a computer cannot falsely deny that they performed that action. Non-repudiation provides reliable records of what user took a particular action at a specific time. In short, it is methods to track what actions are taken by what user. Various system logs provide one method for non-repudiation. One of the most important security activities is auditing. Auditing is the process of reviewing logs, records, and procedures to determine whether they meet standards.
    - Least privilege is a concept you should keep in mind when assigning privileges to any user or device. The concept is that you only assign the minimum privileges required for that person to do his job, no more. Keep this simple but critical concept in mind.
    - You should also keep in mind the CIA triad, or Confidentiality, Integrity, and Availability. All security measures should affect one or more of these areas. For example, hard drive encryption and good passwords help protect confidentiality. Digital signatures help ensure integrity, and a good backup system, or network server redundancy, can support availability.
    - ### 1.8.1 Hacking Terminology
    - Note that hacking terminology is not precise, and that many definitions can be debated. No “official” hacker vocabulary exists. The terms evolve through their use by the hacker community. Clearly, beginning this examination by defining hacker, a term used in movies and news broadcasts, would be sensible.
    - Most people use it to describe any person who breaks into a computer system. However, security professionals and hackers themselves use this term differently. In the hacking community, a hacker is an expert on a particular system or systems who wants to learn more about the system. Hackers feel that looking at a system’s flaws is the best way to learn about it.
    - For example, someone well versed in the Linux operating system who works to understand that system by learning its weaknesses and flaws would be a hacker. However, this does often means seeing whether a flaw can be exploited to gain access to a system. This “exploiting” part of the process is where hackers differentiate themselves into three groups:
        - White hat hackers, upon finding vulnerability in a system, will report the vulnerability to the vendor of that system. For example, if they were to discover some flaw in Red Hat Linux, they would then e-mail the Red Hat company (probably anonymously) and explain what the flaw is and how it was exploited.
        - Black hat hackers are the people normally depicted in the media (e.g., movies and news). After they gain access to a system, their goal is to cause some type of harm. They might steal data, erase files, or deface websites. Black hat hackers are sometimes referred to as crackers.
        - Grey hat hackers are typically law-abiding citizens, but in some cases will venture into illegal activities. They might do so for a wide variety of reasons. Commonly, grey hat hackers conduct illegal activities for reasons they feel are ethical, such as hacking into a system belonging to a corporation that the hacker feels is engaged in unethical activities.
    - ## 1.9 Approaches of Network Security
    - Organisations can choose from several approaches to network security. A particular approach, or paradigm, will influence all subsequent security decisions and set the tone for the entire organisation’s network security infrastructure. Network security paradigms can be classified by either the scope of security measures taken (perimeter, layered) or how proactive the system is.
    - ### 1.9.1 Perimeter Security Approach
    - In a perimeter security approach, the bulk of security efforts are focused on the perimeter of the network. This focus might include firewalls, proxy servers, password policies, and any technology or procedure that makes unauthorised access of the network less likely. Little or no effort is made to secure the systems within the network. In this approach, the perimeter is secured, but the various systems within that perimeter are often vulnerable.
    - This perimeter approach is clearly flawed. So why do some companies use it? A small organisation might use the perimeter approach if they have budget constraints or inexperienced network administrators. This method might be adequate for small organisations that do not store sensitive data, but it rarely works in a larger corporate setting.
    - ### 1.9.2 Layered Security Approach
    - A layered security approach is one in which not only is the perimeter secured, but individual systems within the network are also secured. All servers, workstations, routers, and hubs within the network are secure. One way to accomplish this is to divide the network into segments and secure each segment as if it were a separate network so that, if perimeter security is compromised, not all internal systems are affected. Layered security is the preferred approach whenever possible.
    - You should also measure your security approach by how proactive and/or reactive it is. You do this by determining how much of the system’s security infrastructure and policies are dedicated to preventive measures as opposed to how much are devoted to simply responding to an attack after it has occurred.
    - A passive security approach takes few or no steps to prevent an attack. Conversely a dynamic security approach, or proactive defence, is one in which steps are taken to prevent attacks before they occur. One example of a proactive defence is the use of an IDS, which works to detect attempts to circumvent security measures. These systems can tell a system administrator that an attempt to breach security has been made, even if that attempt is not successful. An IDS can also be used to detect various techniques intruders use to assess a target system, thus alerting a network administrator to the potential for an attempted breach before the attempt is even initiated.
    - ### 1.9.3 Hybrid Security Approach
    - In the real world, network security is rarely completely in one paradigm or another. Networks generally fall along a continuum with elements of more than one security paradigm. The two categories also combine to form a hybrid approach. One can have a network that is predominantly passive but layered, or one that is primarily perimeter, but proactive. Considering approaches to computer security along a Cartesian coordinate system, with the x axis representing the level of passive-active approaches and the y axis depicting the range from perimeter to layered defence, can be helpful. The most desirable hybrid approach is a layered paradigm that is dynamic.
    - ## 1.10 Law and Network Security
    - An increasing number of legal issues affect how administrators approach network security. If your organisation is a publicly traded company, a government agency, or does business with either, there may be legal constraints to choose your security approach. Legal constraints include any laws that affect how information is stored or accessed. Even if your network is not legally bound to these security guidelines, reviewing the various laws impacting computer security and perhaps deriving ideas that can apply to your own security standards is useful.
    - One of the oldest pieces of legislation in the United States affecting computer security is the Computer Security Act of 1987 (100th Congress, 1987). This act requires government agencies to identify sensitive systems, conduct computer security training, and develop computer security plans. This law is a vague mandate ordering federal agencies in the United States to establish security measures without specifying any standards.
    - This legislation established a legal mandate to enact specific standards, paving the way for future guidelines and regulations. It also helped define certain terms, such as what information is indeed “sensitive,” according to the following quote found in the legislation itself:
    - Sensitive information is any information, the loss, misuse, or unauthorised access to or modification of which could adversely affect the national interest or the conduct of Federal programs, or the privacy to which individuals are entitled under section 552a of title 5, United States Code (the Privacy Act), but which has not been specifically authorised under criteria established by an Executive order or an Act of Congress to be kept secret in the interest of national defence or foreign policy.
    - Keep this definition in mind, for it is not just Social Security information or medical history that must be secured. When considering what information needs to be secure, simply ask the question: Would the unauthorised access or modification of this information adversely affect my organisation? If the answer is “yes,” then you must consider that information “sensitive” and in need of security precautions.
    - Computer Misuse Act 1990 is the base law for all other computer related laws in the UK. It applies to the whole of UK and is usually the underlying law used to charge a suspect over a computer crime. Crimes like credential stealing, hacking and phishing are considered Section 1 offences, which can lead to 6 months to 2 years in prison. Section 2 crimes are the crimes intended to be performed, after a hacker has penetrated the system, such as using the credentials stolen to access a server, or committing fraud. Guilty with the section 2 act of the computer misuse act can lead to up to 5 years in prison.
    - Keep in mind that any law that governs privacy (such as the Health Insurance Portability and Accountability Act [HIPAA], for medical records) also has a direct impact on computer security. If a system is compromised and data that is covered under any privacy statute is compromised, you might need to prove that you exercised due diligence to protect that data. A finding that you did not take proper precautions can result in civil liability.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7877ec70-bbe0-4fd3-b699-8bee8889a956/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7877ec70-bbe0-4fd3-b699-8bee8889a956/Untitled.png)
- **Module 2 : Denial of Service Attacks**
    - # 2.1 Denial of Service Attacks
    - The first type of attack to examine is the denial of service (DoS). A denial of service attack is any attack that aims to deny legitimate users of the use of the target system. This class of attack does not actually attempt to infiltrate a system or to obtain sensitive information. It simply aims to prevent legitimate users from accessing a given system.
    - This type of attack is one of the most common categories of attack. Many experts feel that it is so common because most forms of denial of service attacks are fairly easy to execute. The ease with which these attacks can be executed means that even attackers with minimal technical skills can often successfully perform a denial of service.
    - The concept underlying the denial of service attack is based on the fact that any device has operational limits. This fact applies to all devices, not just computer systems. For example, bridges are designed to hold weight up to a certain limit, aircraft have limits on how far they can travel without refuelling, and automobiles can only accelerate to a certain point. All of these various devices share a common trait: They have set limitations to their capacity to perform work. Computers are no different from these, or any other machine; they, too, have limits. Any computer system, web server, or network can only handle a finite load.
    - How a workload (and its limits) is defined varies from one machine to another. A workload for a computer system might be defined in a number of different ways, including the number of simultaneous users, the size of files, the speed of data transmission, or the amount of data stored. Exceeding any of these limits will stop the system from responding. For example, if you can flood a web server with more requests than it can process, it will be overloaded and will no longer be able to respond to further requests. This reality underlies the DoS attack. Simply overload the system with requests, and it will no longer be able to respond to legitimate users attempting to access the web server.
    - ### 2.1.1 SYN Flood
    - Simply sending a flood of pings is the most primitive method of performing a DoS. More sophisticated methods use specific types of packets. One popular version of the DoS attack is the SYN flood. This particular attack depends on the hacker’s knowledge of how connections are made to a server. When a session is initiated between the client and server in a network using the TCP protocol, a small buffer space in memory is set aside on the server to handle the “hand-shaking” exchange of messages that sets up the session. The session-establishing packets include a SYN field that identifies the sequence in the message exchange.
    - A SYN flood attempts to disrupt this process. In this attack, an attacker sends a number of connection requests very rapidly and then fails to respond to the reply that is sent back by the server. In other words, the attacker requests connections, and then never follows through with the rest of the connection sequence. This has the effect of leaving connections on the server half open, and the buffer memory allocated for them is reserved and not available to other applications. Although the packet in the buffer is dropped after a certain period of time (usually about three minutes) without a reply, the effect of many of these false connection requests is to make it difficult for legitimate requests for a session to be established.
    - ### 2.1.2 Smurf Attack
    - The Smurf attack is a popular type of DoS attack. It was named after the application first used to execute this attack. In the Smurf attack, an ICMP packet is sent out to the broadcast address of a network, but its return address has been altered to match one of the computers on that network, most likely a key server. All the computers on the network will then respond by pinging the target computer.
    - ICMP packets use the Internet Control Message Protocol to send error messages on the Internet. Because the address of packets are sent to is a broadcast address, that address responds by echoing the packet out to all hosts on the network, who then send it to the spoofed source address.
    - Continually sending such packets will cause the network itself to perform a DoS attack on one or more of its member servers. This attack is both clever and simple. The greatest difficulty is getting the packets started on the target network. This can be accomplished via some software such as a virus or Trojan horse that will begin sending the packets.
    - ### 2.1.3 Ping of Death
    - The Ping of Death (PoD), is perhaps the simplest and most primitive form of DoS attack and is based on overloading the target system. TCP packets have limited size. In some cases by simply sending a packet that is too large, can shut down a target machine.
    - The aim of this attack is to overload the target system and cause it to quit responding. The PoD works to compromise systems that cannot deal with extremely large packet sizes. If successful, the server will actually shut down. It can, of course, be rebooted.
    - The only real safeguard against this type of attack is to ensure that all operating systems and software are routinely patched. This attack relies on vulnerabilities in the way a particular operating system or application handles abnormally large TCP packets. When such vulnerabilities are discovered, the vendor customarily releases a patch. The possibility of PoD is one reason, among many, why you must keep patches updated on all of your systems.
    - This attack is becoming less common as newer versions of operating systems are better able to handle the overly large packets that Ping of Death depends on. If the operating system is properly designed, it will drop any oversized packets, thus negating any possible negative effects a PoD attack might have.
    - ### 2.1.4 UDP Flood
    - UDP (User Datagram Protocol) is a connectionless protocol and it does not require any connection setup procedure to transfer data. TCP packets connect and wait for the recipient to acknowledge receipt before sending the next packet. Each packet is confirmed. UDP packets simply send the packets without confirmation. This allows packets to be sent much faster, making it easier to perform a DoS attack.
    - A UDP flood attack occurs when an attacker sends a UDP packet to a random port on the victim system. When the victim system receives a UDP packet, it will determine what application is waiting on the destination port. When it realizes that no application is waiting on the port, it will generate an ICMP packet of destination unreachable to the forged source address. If enough UDP packets are delivered to ports on the victim, the system goes down.
    - ### 2.1.5 DoS Tools
    - One reason that DoS attacks are becoming so common is that a number of tools are available for executing DoS attacks. These tools are widely available on the Internet, and in most cases are free to download. This means that any cautious administrator should be aware of them. In addition to their obvious use as an attack tool, they can also be useful for testing your anti-DoS security measures.
    - Low Orbit Ion Cannon (LOIC) is probably the most well know and one of the simplest DoS tool. You first put the URL or IP address into the target box. Then click the Lock On button. You can change settings regarding what method you choose, the speed, how many threads, and whether or not to wait for a reply. Then simply click the IMMA CHARGIN MAH LAZER button and the attack is underway.
    - High Orbit Ion Cannon (HOIC) is a bit more advanced than LOIC, but actually simpler to run. Click the + button to add targets. A popup window will appear where you put in the URL as well as a few settings.
    - ## 2.2 Buffer Overflow Attacks
    - Another way of attacking a system is called a buffer overflow (or buffer overrun) attack. Some experts would argue that the buffer overflow occurs as often as the DoS attack, but this is less true now than it was a few years ago. A buffer overflow attack is designed to put more data in a buffer than the buffer was designed to hold. This means that although this threat might be less than it once was, it is still a very real threat.
    - Any program that communicates with the Internet or a private network must receive some data. This data is stored, at least temporarily, in a space in memory called a buffer. If the programmer who wrote the application was careful, the buffer will truncate or reject any information that exceeds the buffer limit.
    - Given the number of applications that might be running on a target system and the number of buffers in each application, the chance of having at least one buffer that was not written properly is significant enough to cause any cautious system administrator some concern. A person moderately skilled in programming can write a program that purposefully writes more data into the buffer than it can hold. For example, if the buffer can hold 1024 bytes of data and you try to fill it with 2048 bytes, the extra 1024 bytes is then simply loaded into memory.
    - If the extra data is actually a malicious program, then it has just been loaded into memory and is running on the target system. Or perhaps the perpetrator simply wants to flood the target machine’s memory, thus overwriting other items that are currently in memory and causing them to crash. Either way, the buffer overflow is a very serious attack.
    - Fortunately, buffer overflow attacks are a bit harder to execute than the DoS or a simple MS Outlook script virus. To create a buffer overflow attack, a hacker must have a good working knowledge of some programming language (C or C++ is often chosen) and understand the target operating system/application well enough to know whether it has a buffer overflow weakness and how it might exploit the weakness.
    - ## 2.3 IP Spoofing
    - IP spoofing is essentially a technique used by hackers to gain unauthorised access to computers. Although this is the most common reason for IP spoofing, it is occasionally done simply to mask the origins of a DoS attack. In fact DoS attacks often mask the actual IP address from which the attack is originating.
    - With IP spoofing, the intruder sends messages to a computer system with an IP address indicating that the message is coming from a different IP address than it is actually coming from. If the intent is to gain unauthorised access, then the spoofed IP address will be that of a system the target considers a trusted host.
    - To successfully perpetrate an IP spoofing attack, the hacker must first find the IP address of a machine that the target system considers a trusted source. Hackers might employ a variety of techniques to find an IP address of a trusted host. After they have that trusted IP address, they can then modify the packet headers of their transmissions so it appears that the packets are coming from that host.
    - IP spoofing, unlike many other types of attacks, was actually known to security experts on a theoretical level before it was ever used in a real attack. The concept of IP spoofing was initially discussed in academic circles as early as the 1980s. Although the concept behind this technique was known for some time, it was primarily theoretical until Robert Morris discovered a security weakness in the TCP protocol known as sequence prediction.
    - IP spoofing attacks are becoming less frequent, primarily because the venues they use are becoming more secure and in some cases are simply no longer used. However, spoofing can still be used, and all security administrators should address it.
    - A couple of different ways to address IP spoofing include:
        - Do not reveal any information regarding your internal IP addresses. This helps prevent those addresses from being “spoofed.”
        - Monitor incoming IP packets for signs of IP spoofing using network monitoring software. One popular product is Netlog. This and similar products seek incoming packets to the external interface that have both the source and destination IP addresses in your local domain, which essentially means an incoming packet that claims to be from inside the network, when it is clearly coming from outside your network. Finding one means an attack is underway
    - The danger from IP spoofing is that some firewalls do not examine packets that appear to come from an internal IP address. Routing packets through filtering routers is possible if they are not configured to filter incoming packets whose source address is in the local domain.
    - Examples of router configurations that are potentially vulnerable include:
        - Routers to external networks that support multiple internal interfaces
        - Proxy firewalls where the proxy applications use the source IP address for authentication
        - Routers with two interfaces that support subnetting on the internal network
        - Routers that do not filter packets whose source address is in the local domain
    - ## 2.4 Guided Exercise: Preventing IP Spoofing
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/805a1833-a4b4-4378-a2eb-ce4fdd01f007/Annotation_2020-05-24_114525.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/805a1833-a4b4-4378-a2eb-ce4fdd01f007/Annotation_2020-05-24_114525.png)
    - In this exercise you will need to configure the Ubuntu Server to avoid IP Spoofing.
    - Login to Ubuntu Server and once logged in run the command “sudo gedit /etc/host.conf”. Sudo will ask the user password and enter “Pa$$w0rd”. The host configuration file will open. The host.conf configuration file contains configuration information specific to the resolver library
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a44dd85c-bae9-4a16-90bd-a50b37fa55be/Annotation_2020-05-24_114632.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a44dd85c-bae9-4a16-90bd-a50b37fa55be/Annotation_2020-05-24_114632.png)
    - Make the changes shown in the screenshot below which you simply change the word multi to nospoof.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d1721e27-aac2-4df6-9b86-86cfa039ac4a/Annotation_2020-05-24_114707.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d1721e27-aac2-4df6-9b86-86cfa039ac4a/Annotation_2020-05-24_114707.png)
    - By adding the value nospoof on the resolver library will attempt to prevent hostname spoofing for enhanced security.
    - After making the changes press SAVE to to save the changes and then close the file.
    - ## 2.5 Session Hijacking
    - Another form of attack is session hacking or hijacking. TCP session hijacking is a process where a hacker takes over a TCP session between two machines. Because authentication frequently is done only at the start of a TCP session, this allows the hacker to break into the communication stream and take control of the session. For example, a person might log on to a machine remotely. After establishing a connection with the host, the hacker might use session hacking to take over that session and thereby gain access to the target machine.
    - One popular method for session hacking is using source-routed IP packets. This allows a hacker at point A on the network to participate in a conversation between B and C by encouraging the IP packets to pass through the hacker’s machine.
    - The most common sort of session hacking is the “man-in-the-middle attack.” In this scenario, a hacker uses some sort of packet-sniffing program to simply listen the transmissions between two computers, taking whatever information he or she wants but not actually disrupting the conversation. A common component of such an attack is to execute a DoS attack against one end point to stop it from responding. Because that end point is no longer responding, the hacker can now interject his own machine to stand in for that end point.
    - The point of hijacking a connection is to exploit trust and to gain access to a system to which one would not otherwise have access.
- **Module 3 : Fundamentals of Firewalls**
    - A firewall is a fence between your computer or your internal network and the outside world or the Internet. A particular firewall implementation might use one or more of the methods listed here to provide that barrier.
        - Packet filtering
        - Stateful packet filtering
        - User authentication
        - Client application authentication
    - At a minimum, a firewall will filter incoming packets based on parameters such as packet size, source IP address, protocol, and destination port.
    - As you may already know, both Linux and Windows (this includes every Windows version since XP through the Windows 10 and the server editions) ship with a simple firewall built into the operating system. Norton and McAfee both offer personal firewall solutions for individual PCs. These firewalls are meant for individual machines.
    - There are more advanced solutions available for networks. In an organisational setting, you will want a dedicated firewall between your network and the outside world. This might be a router that also has built-in firewall capabilities. (Cisco Systems is one company that is well-known for high quality routers and firewalls.) Alternatively, it might be a server that is dedicated to run firewall software. There are a number of firewall solutions that you can examine. Selecting a firewall is an important decision.
    - ## 3.2 Firewall Types
    - Packet filtering firewalls are the simplest and often the least expensive type of firewalls. Several other types of firewalls offer their own distinct advantages and disadvantages. The basic types of firewalls are:
        - Packet filtering
        - Application gateway
        - Circuit level gateway
        - Stateful packet inspection
    - ### 3.2.1 Packet Filtering Firewall
    - The packet filtering firewall is the most basic type of firewall. In a packet filtering firewall, each incoming packet is examined. Only those packets that match the criteria you set are allowed through. Many operating systems, such as Windows clients (such as Windows 8 and 10) and many Linux distributions, include basic packet filtering software with the operating system.
    - Packet filtering firewalls are also referred to as screening firewalls. They can filter packets based on packet size, protocol used, source IP address, and many other parameters. Some routers offer this type of firewall protection in addition to their normal routing functions.
    - Packet filtering firewalls work by examining a packet’s source address, destination address, source port, destination port, and protocol type. Based on these factors and the rules that the firewall has been configured to use, they either allow or deny passage to the packet. These firewalls are very easy to configure and inexpensive. Some operating systems, such as Windows 10 and Linux, include built-in packet filtering capabilities.
    - There are a few disadvantages of packet filtering firewalls. One disadvantage is that they do not actually examine the packet or compare it to previous packets; therefore, they are quite susceptible to either a ping flood or SYN flood. They also do not offer any user authentication. Because this type of firewall looks only at the packet header for information, it has no information about the packet contents.
    - It also does not track packets, so it has no information about the preceding packets. Therefore, if thousands of packets came from the same IP address in a short period of time, a host would not notice that this pattern is unusual. Such a pattern often indicates that the IP address in question is attempting to perform a DoS attack on the network.
    - To configure a packet filtering firewall, simply establish appropriate filtering rules. A set of rules for a given firewall would need to cover the following:
        - What types of protocols to allow (FTP, SMTP, POP3, etc.)
        - What source ports to allow
        - What destination ports to allow
        - What source IP addresses to allow (you can block certain IP addresses if you wish)
    - These rules will allow the firewall to determine what traffic to allow in and what traffic to block. Because this sort of firewall uses only very limited system resources, is relatively easy to configure, and can be obtained inexpensively or even for free. Although it is not the most secure type of firewall, you are likely to encounter it frequently.
    - ### 3.2.2 Stateful Packet Inspection
    - The stateful packet inspection (SPI) firewall is an improvement on basic packet filtering. This type of firewall will examine each packet, denying or permitting access based not only on the examination of the current packet, but also on data derived from previous packets in the conversation.
    - This means that the firewall is aware of the context in which a specific packet was sent. This makes these firewalls far less susceptible to ping floods and SYN floods, as well as being less susceptible to spoofing. SPI firewalls are less susceptible to these attacks for the following reasons:
        - They can tell whether the packet is part of an abnormally large stream of packets from a particular IP address, thus indicating a possible DoS attack in progress.
        - They can tell whether the packet has a source IP address that appears to come from inside the firewall, thus indicating IP spoofing is in progress.
        - They can also look at the actual contents of the packet, allowing for some very advanced filtering capabilities.
    - Most quality firewalls today use the stateful packet inspection method; when possible, this is the recommended type of firewall for most systems. In fact, most home routers have the option of using stateful packet inspection.
    - The name stateful packet inspection derives from the fact that in addition to examining the packet, the firewall is examining the packet’s state in relationship to the entire IP conversation. This means the firewall can refer to the preceding packets as well as those packets’ contents, source, and destination. As you might suspect, SPI firewalls are becoming quite common.
    - ### 3.2.3 Application Gateway
    - An application gateway (also known as application proxy or application-level proxy) is a program that runs on a firewall. This type of firewall derives its name from the fact that it works by negotiating with various types of applications to allow their traffic to pass the firewall. In networking terminology, negotiation is a term used to refer to the process of authentication and verification. In other words, rather than looking at the protocol and port the packet is using, an application gateway will examine the client application and the server-side application to which it is trying to connect.
    - It will then determine if that particular client application’s traffic is permitted through the firewall. This is significantly different from a packet filtering firewall, which examines the packets and has no knowledge of what sort of application sent them. Application gateways enable the administrator to allow access only to certain specified types of applications, such as web browsers or FTP clients.
    - When a client program, such as a web browser, establishes a connection to a destination service, such as a web server, it connects to an application gateway, or proxy. The client then negotiates with the proxy server in order to gain access to the destination service.
    - In effect, the proxy establishes the connection with the destination behind the firewall and acts on behalf of the client, hiding and protecting individual computers on the network behind the firewall. This process actually creates two connections. There is one connection between the client and the proxy server and another connection between the proxy server and the destination.
    - Once a connection is established, the application gateway makes all decisions about which packets to forward. Since all communication is conducted through the proxy server, computers behind the firewall are protected.
    - With an application gateway, each supported client program requires a unique program to accept client application data. This sort of firewall allows for individual user authentication, which makes them quite effective at blocking unwanted traffic. However, a disadvantage is that these firewalls use a lot of system resources. The process of authenticating client applications uses more memory and CPU time than simple packet filtering.
    - Application gateways are also susceptible to various flooding attacks (SYN flood, ping flood, etc.) for two reasons. The first potential cause of a flooding attack may be the additional time it takes for an application to negotiate authenticating a request. Remember that both the client application and the user may need to be authenticated. This takes more time than simply filtering packets based on certain parameters.
    - For this reason, a flood of connection requests can overwhelm the firewall, preventing it from responding to legitimate requests. Application gateways may also be more susceptible to flooding attacks because once a connection is made, packets are not checked. If a connection is established, then that connection can be used to send a flooding attack to the server it has connected to, such as a web server or e-mail server.
    - This vulnerability is mitigated somewhat by authenticating users. Provided the user logon method is secure (appropriate passwords, encrypted transmission, etc.), the likelihood that someone can use a legitimate connection through an application gateway for a flooding attack is reduced.
    - ### 3.2.4 Circuit Level Gateway
    - Circuit level gateway firewalls are similar to application gateways but are more secure and generally implemented on high-end equipment. These types of firewalls also employ user authentication, but they do so earlier in the process.
    - With an application gateway, first the client application is checked to see if access should be granted, and then the user is authenticated. With circuit level gateways, authenticating the user is the first step. The user’s logon ID and password are checked, and the user is granted access before the connection to the router is established. This means that each individual, either by username or IP address, must be verified before any further communication can take place.
    - Once this verification takes place and the connection between the source and destination is established, the firewall simply passes bytes between the systems. A virtual “circuit” exists between the internal client and the proxy server. Internet requests go through this circuit to the proxy server, and the proxy server delivers those requests to the Internet after changing the IP address. External users only see the IP address of the proxy server.
    - Responses are then received by the proxy server and sent back through the circuit to the client. It is this virtual circuit that makes the circuit level gateway secure. The private secure connection between the client application and the firewall is a more secure solution than some other options, such as the simple packet filtering firewall and the application gateway.
    - While traffic is allowed through, external systems never see the internal systems.
    - ## 3.3 Firewall Implementation
    - Administrators must be able to evaluate implementation issues to achieve a successful security solution for their systems. Understanding the type of firewall means knowing how the firewall will evaluate traffic and decide what to allow and what not to allow. Understanding the firewall’s implementation means understanding how that firewall is set up in relation to the network it is protecting. The most widely used configurations include:
        - Network host-based
        - Dual-homed host
        - Router-based firewall
        - Screened host
    - ### 3.3.1 Host Based
    - In the host-based (sometimes-called network host-based) scenario the firewall is a software solution installed on an existing machine with an existing operating system. The most significant concern in this scenario is that, no matter how good the firewall solution is, it is contingent upon the underlying operating system. In such a scenario, it is critical that the machine hosting the firewall have a hardened operating system. Hardening the operating system refers to taking several security precautions including:
        - Ensuring all patches are updated
        - Uninstalling unneeded applications or utilities
        - Closing unused ports
        - Turning off all unused services
    - In the network host-based implementation, you install the firewall software onto an existing server. Sometimes, the server’s operating system may come with such software. It is not at all uncommon for administrators to use a machine running Linux, configure its built-in firewall, and use that server as a firewall. The primary advantage to this option is cost. It is much cheaper to simply install firewall software onto an existing machine, and use that machine as your firewall.
    - ### 3.3.2 Dual-Homed Hosts
    - A dual-homed host is a firewall running on a server with at least two network interfaces. This is an older methodology. Most firewalls today are implemented in actual routers, rather than servers. The server acts as a router between the network and the interfaces to which it is attached.
    - To make this work, the automatic routing function is disabled, meaning that an IP packet from the Internet is not routed directly to the network. The administrator can choose what packets to route and how to route them. Systems inside and outside the firewall can communicate with the dual-homed host, but cannot communicate directly with each other.
    - The dual-homed host configuration is simply an expanded version of the network host firewall implementation. That means it is also dependent on the security of the underlying operating system. Any time a firewall is running on a server of any kind, the security of that server’s operating system becomes even more critical than normal.
    - This option has the advantage of being relatively simple and inexpensive. The primary disadvantage is its dependency on the underlying operating system.
    - ### 3.3.3 Router-Based Firewall
    - Administrators can implement firewall protection on a router. In fact, even the simplest, low-end routers today have some type of firewall included. In larger networks with multiple layers of protection, this is often the first layer of protection. Although various types of firewalls can be implemented on a router, the most common type uses packet filtering. Users of a broadband connection in a home or small office can get a packet filtering firewall router to replace the basic router provided by the broadband company.
    - In many cases, this solution is also ideal for the firewall novice. A number of vendors supply router-based firewalls that can be preconfigured by the vendor based on the customer’s needs. The customer can then install it between the network and external Internet connection. In addition, most of the widely known brands (Cisco, 3Com, etc.) offer vendor-specific training and certifications in their hardware, making it relatively easy to find qualified administrators or to train current staff.
    - Another valuable way to implement router-based firewalls is between subsections of a network. If a network is divided into segments, each segment needs to use a router to connect to the other segments. Using a router that also includes a firewall significantly increases security. If the security of one segment of the network is compromised, the rest of the network is not necessarily breached.
    - Perhaps the best advantage of router-based firewalls is the ease of setup. In many cases, the vendor will even configure the firewall for you, and you simply plug it in. Most home-based routers today, such as those from Linksys, Belkin, or Netgear, have a built-in firewall. And in fact virtually all higher-end routers include firewall capability.
    - ### 3.3.4 Screened Hosts
    - A screened host is really a combination of firewalls. In this configuration, a combination of a bastion host and a screening router is used. The combination creates a dual firewall solution that is effective at filtering traffic. The two firewalls can be different types. The bastion host might be an application gateway and the router packet screener (or vice versa). This approach gives the advantages of both types of firewalls and is similar in concept to the dual-homed host.
    - The screened host has some distinct advantages over the dual-homed firewall. Unlike the dual-homed firewall, the screened host needs only one network interface and does not require a separate subnet between the application gateway and the router. This makes the firewall more flexible but perhaps less secure because its reliance on only one network interface card means that it might be configured to pass certain trusted services to the application gateway portion of the firewall and directly to servers within the network.
    - The most significant concern when using the screened host is that it essentially combines two firewalls into one. Therefore, any security flaw or misconfiguration affects both firewalls. When you use a DMZ there are physically two separate firewalls, and the likelihood of any security flaw being propagated to both is low.
    - ## 3.4 Proxy Servers
    - A proxy server is often used with a firewall to hide the internal network’s IP address and present a single IP address (its own) to the outside world. A proxy server is a server that sits between a client application, such as a web browser, and a real server. Proxy servers prevent hackers from seeing the IP addresses of internal machines, knowing how many machines are behind the proxy server, or learning anything about the network configuration.
    - Proxy servers also provide a valuable control mechanism because most proxy servers log all outgoing traffic. This enables network administrators to see where employees go on the Internet. A proxy server normally runs as software on the same machine as your firewall.
    - The proxy server is configured to redirect certain traffic. For example, incoming traffic using the HTTP protocol is usually allowed through the proxy server but is redirected to the web server. That means that all outgoing and incoming HTTP traffic first goes through the proxy server. A proxy server can be configured to redirect any traffic you want. If an e-mail server or FTP server is on the network, all incoming and outgoing traffic for that network will run through the proxy server.
    - Using a proxy server means that when a machine inside the network visits a website, the website will only detect that the proxy server visited it. In fact, if dozens of different machines on the network visit a site that logs the IP addresses of incoming connections, they will all be logged with the same IP address—that of the proxy server.
    - For the most part this sort of proxy server has been supplanted by network address translation. However, the term proxy server is still used, but with a different application. Now proxy servers work with the firewall to filter things such as web content. They allow a network administrator to block certain sites and to record all the websites a given user visits.
    - This hiding of the network is a very valuable service because knowledge of internal IP addresses can be used to execute certain forms of attack. For example, IP spoofing is contingent upon knowing the IP address of some internal server. Hiding those IP addresses is an important step in network security. It can also be very useful to know where employees go on the Internet.
    - Proxy servers track such information, and many network administrators use this to restrict employees from using the company Internet connection for illicit purposes. This can also be a useful tool for stopping attacks. An employee who visits hacker websites might be a potential security risk. They may elect to try some of the techniques they read about on the network. Administrators can also detect potential industrial espionage. An employee who spends a lot of time on a competitor’s website might be considering a job change and might consider taking valuable data with him.
    - ### 3.4.1 NAT (Network Address Translation)
    - For many organisations, proxy servers have been superseded by a newer technology known as network address translation (NAT). Today what we call proxy servers don’t do what proxy servers originally did (i.e., translate a private IP address into a public IP address). Primarily, NAT translates internal addresses and external addresses to allow communication between network computers and outside computers. The outside sees only the address of the machine running NAT (often the firewall). From this perspective, it is functioning exactly like a proxy server.
    - NAT also provides significant security because, by default, it allows only connections that are originated on the inside network. This means that a computer inside the network can connect to an outside web server, but an outside computer cannot connect to a web server inside the network. You can make some internal servers available to the outside world via inbound mapping, which maps certain well-known TCP ports (80 for HTTP, 21 for FTP, etc.) to specific internal addresses, thus making services such as FTP or websites available to the outside world. However, this inbound mapping must be done explicitly; it is not present by default.
    - ## 3.5 Windows Firewalls
    - Windows first started shipping a primitive firewall, called Internet Connection Firewall (ICF), with Windows 2000. It was very simple. Each version of Windows since then has expanded upon this idea. Windows 10 ships with a fully functioning firewall. This firewall can block inbound and outbound packets. To access the Windows 10 firewall, click the Start button and type Firewall.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b3d658e8-4c22-4d5d-98fa-c74f615ab5b9/Annotation_2020-05-25_092036.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b3d658e8-4c22-4d5d-98fa-c74f615ab5b9/Annotation_2020-05-25_092036.png)
    - Beginning with Windows Server 2008 and all versions after that, Windows Firewalls are stateful packet inspection firewalls. With the Windows 10 Firewall, you can set different rules for outbound and inbound traffic. For example, your standard workstation will probably allow outbound HTTP traffic on port 80, but you might not want to allow inbound traffic (unless you are running a web server on that workstation).
    - You can also set up rules for a port, a program, a custom rule, or one of the many predefined rules that Microsoft has for you to select from. You can also choose not only to allow or block the connection, but to allow it only if it is secured by IPSec. That provides you with three options for any connection.
    - Rules allow or block a given application or port. You can also have different rules for inbound and outbound traffic. The rules allow you to decide whether a particular type of communication is blocked or allowed. You can have different settings for inbound and outbound traffic. You can set rules for individual ports (all 65,535 available network ports) and for applications. The rules in the Windows firewall give you a lot of flexibility.
    - More importantly, you can apply rules differently depending on where the traffic comes from. You can set up rules for three areas or profiles:
        - **Domain:** For those computers authenticated on your domain.
        - **Public:** For computers from outside your network. You would treat outside traffic more carefully than traffic coming from another machine in your domain.
        - **Private:** Private refers to traffic from your own computer, thus the term private.
    - Administrators should always follow these rules with all packet filtering firewalls:
        - If you do not explicitly need a port, then block it. For example, if you are not running a web server on that machine, then block all inbound port 80 traffic. With home machines, you can usually block all ports. With individual workstations on a network, you may need to keep some ports open in order to allow various network utilities to access the machine.
        - Unless you have a compelling reason not to, always block ICMP traffic because many utilities such as ping, tracert, and many port scanners use ICMP packets. If you block ICMP traffic, you will prevent many port scanners from scanning your system for vulnerabilities.
        - Occasionally, I would suggest continuing to write out acronyms such as ICMP just to make sure this is reinforced.
    - The Windows Firewall also has a logging feature, but it is disabled by default. Turn this feature on (when you configure the firewall you will see a place to turn on logging). Check this log periodically. You can find more details on the Windows 10 Firewall at [](https://docs.microsoft.com/en-us/windows/access-protection/windows-firewall/windows-firewall-with-advanced-security)https://docs.microsoft.com/en-us/windows/access-protection/windows-firewall/windows-firewall-with-advanced-security.
    - ## 3.6 Guided Exercise: Configuring Windows Firewall
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/763ace15-a730-46e3-abd9-c8b237f1b8c1/Annotation_2020-05-25_092551.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/763ace15-a730-46e3-abd9-c8b237f1b8c1/Annotation_2020-05-25_092551.png)
    - In this exercise, you are required to configure the firewall on the Windows machines.
    - Login to Windows 10 and enable the Firewall.
    - Click on the Start button and then write on the search box Firewall.
    - The select the Windows Firewall. Once the Windows Firewall window opens click on “Turn Windows Firewall on or off”.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dbcc6f8a-c8e7-4e03-9c0e-e9c4786276db/Annotation_2020-05-25_092706.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dbcc6f8a-c8e7-4e03-9c0e-e9c4786276db/Annotation_2020-05-25_092706.png)
    - On the Customize Settings window of Firewall select both radio buttons “Turn on Windows Firewall” for Private and Public network settings and then click OK.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/52a7c9be-1e85-4056-b6e1-5e17cb7bd350/Annotation_2020-05-25_092735.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/52a7c9be-1e85-4056-b6e1-5e17cb7bd350/Annotation_2020-05-25_092735.png)
    - Login to Windows Server and enable the Firewall.
    - Click on the Start button and write Firewall.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/38d03031-e4f1-4921-98cd-441db9db31fe/Annotation_2020-05-25_092827.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/38d03031-e4f1-4921-98cd-441db9db31fe/Annotation_2020-05-25_092827.png)
    - Click on Windows Firewall and the Windows Firewall window will be revealed.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e400e078-d301-49b9-a770-adb49fd6d5f9/Annotation_2020-05-25_092911.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e400e078-d301-49b9-a770-adb49fd6d5f9/Annotation_2020-05-25_092911.png)
    - From the Windows Firewall window click on “Turn Windows Firewall on or off” and the Customize Settings window will be shown.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4f8c1bd6-698c-40d4-8cde-fa1d651408a0/Annotation_2020-05-25_093001.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4f8c1bd6-698c-40d4-8cde-fa1d651408a0/Annotation_2020-05-25_093001.png)
    - On the Customize Settings window of Firewall select both radio buttons “Turn on Windows Firewall” for Private and Public network settings and then click OK.
    - Right click on the Windows Server Start button and select Command Prompt (Admin).
    - On the command prompt run the command ping 192.168.1.10.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fc9f3ab0-1929-4682-b5f0-78ee4532a566/Annotation_2020-05-25_093058.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fc9f3ab0-1929-4682-b5f0-78ee4532a566/Annotation_2020-05-25_093058.png)
    - Because we have enabled the firewall, it blocks ICMP packets.
    - In Windows 10 Firewall enable the Inbound rule titled “File and Printer Sharing (Echo Request – ICMPv4-In)”
    - Click on the Start button and then write on the search box Firewall.
    - From the Windows Firewall window click on Advanced Settings and the Windows Firewall with Advanced Security will open.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4a4a0f73-2329-4c5d-adf2-e3d2648fda56/Annotation_2020-05-25_093159.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4a4a0f73-2329-4c5d-adf2-e3d2648fda56/Annotation_2020-05-25_093159.png)
    - Click on Inbound Rules and enable the rules File and Print Sharing (Echo Request – ICMPv4-In) for both profiles Private and Domain. Enable them by right clicking on each rule and select Enable Rule.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3b98a391-3e19-4c2b-ac41-5c6627a475af/Annotation_2020-05-25_093257.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3b98a391-3e19-4c2b-ac41-5c6627a475af/Annotation_2020-05-25_093257.png)
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cc5f63dd-d442-488b-8b01-226f6d067331/Annotation_2020-05-25_093322.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cc5f63dd-d442-488b-8b01-226f6d067331/Annotation_2020-05-25_093322.png)
    - In Windows Server enable the Inbound rule titled “File and Printer Sharing (Echo Request – ICMPv4-In)”.
    - Click on the Start button and write Firewall.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/19c16a8e-7902-4f65-bf50-fa20caaf444c/Annotation_2020-05-25_093449.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/19c16a8e-7902-4f65-bf50-fa20caaf444c/Annotation_2020-05-25_093449.png)
    - Click on Windows Firewall and the Windows Firewall window will be revealed.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3f85434e-100b-43b7-95cf-722a12ce8647/Annotation_2020-05-25_093515.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3f85434e-100b-43b7-95cf-722a12ce8647/Annotation_2020-05-25_093515.png)
    - Click on the Advanced Settings and the Windows Firewall with Advanced Security window will open.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/78e1f0ae-86ba-49f3-9642-b907d24eeefa/Annotation_2020-05-25_093542.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/78e1f0ae-86ba-49f3-9642-b907d24eeefa/Annotation_2020-05-25_093542.png)
    - Click on Inbound Rules, select the rule “File and Printer Sharing (Echo Request – ICMPv4-In)” and enable it.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1741fb4e-3f08-4975-b485-ff66982aa51e/Annotation_2020-05-25_093611.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1741fb4e-3f08-4975-b485-ff66982aa51e/Annotation_2020-05-25_093611.png)
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3f75d6a4-5052-4e86-99a2-7e34e03f1e67/Annotation_2020-05-25_093634.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3f75d6a4-5052-4e86-99a2-7e34e03f1e67/Annotation_2020-05-25_093634.png)
    - In Windows 10 use the ping command to ping Windows Server (192.168.1.20)
    - Right click on the Start button and click on “Command Prompt (Admin)” and then Yes on the pop up window.
    - On the Command Prompt window write the command “ping 192.168.1.20”.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/daf44103-3147-4eff-8b15-135998d44149/Annotation_2020-05-25_093714.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/daf44103-3147-4eff-8b15-135998d44149/Annotation_2020-05-25_093714.png)
    - The server replies to the ICMP pings because we have enabled the rule on the Firewall.
    - ## 3.7 Linux Firewalls
    - Linux has firewall capabilities built into the operating system. This has been a part of the Linux operating system for many years, with occasional improvements in the technology.
    - ### 3.7.1 Iptables
    - The first widely used Linux firewall was called ipchains. It was essentially a chain of rules for filtering traffic. It was first introduced in version 2.2 of the Linux kernel and superseded the previous ipfwadm (which was not widely used). The more modern iptables replaced ipchains and is the primary firewall for Linux. The iptables service was first introduced in Linux kernel 2.4.
    - On most Linux systems, iptables is installed as /usr/sbin/iptables. However, if it was not included in your particular Linux installation, you can add it later.
    - An iptables firewall is made up of three different kinds of objects: tables, chains, and rules. Basically, the tables contain chains of rules. Put another way, iptables is an expansion on the concept of ipchains. Each chain has a series of rules that define how to filter packets. There are actually three tables and each has some standard rule chains in it. You can, of course, add your own custom rules. The three tables and their standard chains are as follow:
        - **Packet filtering:** This table is the essential part of the firewall. It is a packet filtering firewall and it contains three standard chains: INPUT, OUTPUT, and Forward. The INPUT chain processes incoming packets, and the OUTPUT chain processes traffic sent out from the machine. If the firewall system is also acting as a router, only the FORWARD chain applies to routed packets.
        - **Network address translation:** This table is used for performing network address translation on outbound traffic that initiates a new connection. This is used only if your machine is serving as a gateway or proxy server.
        - **Packet alteration:** This table is used only for specialized packet alteration. It is often called the mangle table because it alters, or mangles, packets. It contains two standard chains. This table might not even be needed for many standard firewalls.
    - ### 3.7.2 Iptables Configuration
    - Iptables requires some configuration. You can do it through the GUI (KDE, GNOME, etc.) but the shell commands are common to most distributions. Let’s take a look at some common basic configuration.
    - To cause iptables to function as a basic packet filtering firewall, you need these commands:
        - iptables -F
        - iptables -N block
        - iptables -A block -m state --state ESTABLISHED,RELATED -j ACCEPT
    - Obviously, that is the most basic and essential iptables configuration. However, here are some others.
    - To list the current iptables rules use:
        - iptables –L
    - To allow communication on a specific port, SSH port 22 and HTTP port 80 for example use:
        - iptables –A INPUT –p tcp –dport ssh –j ACCEPT
        - iptables –A INPUT –p tcp –dport 80 –j ACCEPT
    - Also there are several flags that can be passed to the iptables command. Below are listed the most common flags and what they do. Several other flags exist but are not listed.
    - A: Append this rule to a rule chain
    - -L: List the current filter rules
    - -p: The connection protocol used
    - --dport: The destination port required for the rule. A single port can be given or a range.
    - -i: Only match if the packet is coming in on the specified interface.
    - -v: Verbose output
    - -s, --source: address source specification
    - -d, --destination: address destination specification
    - ## 3.8 Guided Exercise: Configuring iptables Rules
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d7e25822-2d12-44fc-aa2f-87b8820e15e7/Annotation_2020-05-25_094428.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d7e25822-2d12-44fc-aa2f-87b8820e15e7/Annotation_2020-05-25_094428.png)
    - In this exercise, you are required to write custom iptables rules.
    - Login to Ubuntu Server and then run the command “sudo iptables -L”. It will ask for the user password. Enter the user password which is “Pa$$w0rd”, press enter and then it will show the current iptables rules.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2addd364-a80d-42d0-bd33-39f4553c51ed/Annotation_2020-05-25_094519.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2addd364-a80d-42d0-bd33-39f4553c51ed/Annotation_2020-05-25_094519.png)
    - Write the command “sudo iptables –A INPUT –p tcp --dport ssh –j ACCEPT” and if sudo asks for the user password enter “Pa$$w0rd”. Then run the command sudo iptables –L to list the iptables rules.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d72c879b-6f56-4f31-9960-b79893b8dca6/Annotation_2020-05-25_094550.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d72c879b-6f56-4f31-9960-b79893b8dca6/Annotation_2020-05-25_094550.png)
    - Write the command “sudo iptables –A INPUT –p tcp --dport 80 –j ACCEPT” and if sudo asks for the user password enter “Pa$$w0rd”. Then run the command sudo iptables –L to list the iptables rules.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/de08e0c0-fad9-4a1f-b406-e4e4695c57ce/Annotation_2020-05-25_094620.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/de08e0c0-fad9-4a1f-b406-e4e4695c57ce/Annotation_2020-05-25_094620.png)
    - To save the iptables rules run the command “sudo iptables-save”.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cc921b82-890b-4267-85ed-e6a91976e0db/Annotation_2020-05-25_094645.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cc921b82-890b-4267-85ed-e6a91976e0db/Annotation_2020-05-25_094645.png)
- **Module 4 : Intrusion-Detection Systems**
    - ## 4.1 IDS Concepts
    - There are six basic approaches to intrusion-detection and prevention. Some of these methods are implemented in various software packages, and others are simply strategies that an organisation can employ to decrease the likelihood of a successful intrusion.
    - Historically, when IDSs were first developed, hubs were used very frequently. Today, switches are used rather than hubs. With a hub, after a packet has travelled from its source network to the destination network (being routed by its destination IP address), it finally arrives at the network segment on which the target is located. After it gets to that final segment, the MAC address is used to find the target. All the computers on that segment can see the packet, but because the destination MAC address does not match the MAC address of their network card, they ignore the packet.
    - At some point, enterprise individuals realized that if they simply chose not to ignore packets not destined for their network card, they could see all the traffic on the network segment. In other words, one could look at all the packets on that network segment. Thus the packet sniffer was born. After that it was just a matter of time before the idea came about of analysing those packets for indications of an attack, thereby giving rise to intrusion-detection systems.
    - ### 4.1.1 Pre-emptive Blocking
    - Pre-emptive blocking seeks to prevent intrusions before they occur. This is done by observing any danger signs of imminent threats and then blocking the user or IP address from which these signs originate. Examples of this technique include attempts to detect the early Footprinting stages of an imminent intrusion, then blocking the IP or user that is the source of the Footprinting activity. If you find that a particular IP address is the source of frequent port scans and other scans of your system, then you would block that IP address at the firewall.
    - This sort of intrusion detection and avoidance can be quite complicated, and there is the potential of blocking a legitimate user by mistake. The complexity arises from distinguishing legitimate traffic from that indicative of an impending attack. This can lead to the problem of false positives, in which the system mistakenly identifies legitimate traffic as some form of attack.
    - Usually, a software system will simply alert the administrator that suspicious activity has taken place. A human administrator will then make the decision whether or not to block the traffic. If the software automatically blocks any addresses it deems suspicious, you run the risk of blocking out legitimate users. It should also be noted that nothing prevents the offending user from moving to a different machine to continue the attack. This sort of approach should only be one part of an overall intrusion-detection strategy and not the entire strategy.
    - ### 4.1.2 Anomaly Detection
    - Anomaly detection involves actual software that works to detect intrusion attempts and notify the administrator. This is what many people think of when they talk about intrusion-detection systems. The general process is simple: The system looks for any abnormal behaviour. Any activity that does not match the pattern of normal user access is noted and logged. The software compares observed activity against expected normal usage profiles. Profiles are usually developed for specific users, groups of users, or applications. Any activity that does not match the definition of normal behaviour is considered an anomaly and is logged. Sometimes we refer to this as “trace back” detection or process. We are able to establish from where this packet was delivered. The specific ways in which an anomaly is detected include:
        - Threshold monitoring
        - Resource profiling
        - User/group work profiling
        - Executable profiling
    - ### 4.1.2.1 Threshold Monitoring
    - Threshold monitoring pre-sets acceptable behaviour levels and observes whether these levels are exceeded. This could include something as simple as a finite number of failed login attempts or something as complex as monitoring the time a user is connected and the amount of data that user downloads. Thresholds provide a definition of acceptable behaviour. Unfortunately, characterizing intrusive behaviour only by the threshold limits can be somewhat challenging. It is often quite difficult to establish proper threshold values or the proper time frames at which to check those threshold values. This can result in a high rate of false positives in which the system misidentifies normal usage as a probable attack.
    - ### 4.1.2.2 Resource Profiling
    - Resource profiling measures system-wide use of resources and develops a historic usage profile. Looking at how a user normally utilizes system resources enables the system to identify usage levels that are outside normal parameters. Such abnormal readings can be indicative of illicit activity underway. However, it may be difficult to interpret the meaning of changes in overall system usage. An increase in usage might simply indicate something benign like increased workflow rather than an attempt to breach security.
    - ### 4.1.2.3 User/Group Work Profiling
    - In user/group work profiling, the IDS maintains individual work profiles about users and groups. These users and groups are expected to obey to these profiles. As the user changes his activities, his expected work profile is updated to reflect those changes. Some systems attempt to monitor the interaction of short-term versus long-term profiles. The short-term profiles capture recent changing work patterns, whereas the long-term profiles provide a view of usage over an extended period of time. However, it can be difficult to profile an irregular or dynamic user base. Profiles that are defined too broadly enable any activity to pass review, whereas profiles that are defined too narrowly may inhibit user work.
    - ### 4.1.2.4 Executable Profiling
    - Executable profiling seeks to measure and monitor how programs use system resources with particular attention to those whose activity cannot always be traced to a specific originating user. For example, system services usually cannot be traced to a specific user launching them. Viruses, Trojan horses, worms, trapdoors, and other software attacks are addressed by profiling how system objects such as files and printers are normally used not only by users, but also by other system subjects on the part of users. In most conventional systems, for example, any program, including a virus, inherits all of the privileges of the user executing the software. The software is not limited by the principle of least privilege to only those privileges needed to properly execute. This openness in the architecture permits viruses to covertly change and infect totally unrelated parts of the system.
    - Executable profiling enables the IDS to identify activity that might indicate an attack. Once a potential danger is identified, the method of notifying the administrator, such as by network message or e-mail, is specific to the individual IDS.
    - ## 4.2 Components and Processes of IDS
    - Regardless of what IDS you select, they all have certain components in common. It is important to have a general understanding of these components.
    - The following terms will familiarize you with basic components and functions in all IDSs:
        - An activity is an element of a data source that is of interest to the operator.
        - The administrator is the person responsible for organisational security.
        - A sensor is the IDS component that collects data and passes it to the analyser for analysis.
        - The analyser is the component or process that analyses the data collected by the sensor.
        - An alert is a message from the analyser indicating that an event of interest has occurred.
        - The manager is the part of the IDS used to manage, for example a console.
        - Notification is the process or method by which the IDS manager makes the operator aware of an alert.
        - The operator is the person primarily responsible for the IDS. This is often the administrator.
        - An event is an occurrence that indicates a suspicious activity may have occurred.
        - The data source is the raw information that the IDS uses to detect suspicious activity.
    - Beyond these basic components, IDSs can be classified either based on how they respond to detected anomalies or based on how they are deployed. An active IDS, now called an IPS (Intrusion Prevention System), will stop any traffic deemed to be malicious. A passive IDS simply logs the activity and perhaps alerts an administrator. The problem with IPS/active IDS is the possibility of false positives. It is possible to have activity that appears to be an attack, but really is not. You can also define IDS/IPS based on whether a single machine is monitored or an entire network segment is monitored. If it is a single machine, then it is called a HIDS (host-based intrusion-detection system) or HIPS (host-based intrusion prevention system). If it is a network segment then it is called a NIDS (network-based intrusion-detection system) or NIPS (network-based intrusion prevention system).
    - ## 4.3 Implementing IDS
    - Many vendors supply IDSs, and each of these systems has its own strengths and weaknesses. Deciding which system is best for a particular environment depends on many factors, including the network environment, security level required, budget constraints, and the skill level of the person who will be working directly with the IDS.
    - ### 4.3.1 Snort
    - Snort is perhaps the most well-known open source IDS available. It is a software implementation installed on a server to monitor incoming traffic. It typically works with a host-based firewall in a system in which both the firewall software and Snort run on the same machine. Snort is available for UNIX, Linux, Free BSD, and Windows. The software is free to download, and documentation is available at the website: [www.snort.org](http://www.snort.org/). Snort works in one of three modes: sniffer, packet logger, and network intrusion-detection.
    - ### 4.3.1.1 Sniffer
    - In packet sniffer mode, the console (shell or command prompt) displays a continuous stream of the contents of all packets coming across that machine. This can be a very useful tool for a network administrator. Finding out what traffic is traversing a network can be the best way to determine where potential problems lie. It is also a good way to check whether transmissions are encrypted.
    - ### 4.3.1.2 Packet Logger
    - Packet logger mode is similar to sniffer mode. The difference is that the packet contents are written to a text file log rather than displayed in the console. This can be more useful for administrators who are scanning a large number of packets for specific items. Once the data is in a text file, users can scan for specific information using a word processor’s search capability.
    - ### 4.3.1.3 Network Intrusion-Detection
    - In network intrusion-detection mode, Snort uses a heuristic approach to detecting anomalous traffic. This means it is rule-based and it learns from experience. A set of rules initially governs a process. Over time, Snort combines what it finds with the settings to optimize performance. It then logs that traffic and can alert the network administrator. This mode requires the most configuration because the user can determine the rules that wishes to implement for the scanning of packets. Snort works primarily from the command line (Shell in Unix/Linux, command prompt in Windows).
    - Configuring Snort is mostly a matter of knowing the correct commands to enter and understanding their output. Anyone with even moderate experience with either Linux shell commands or DOS commands can quickly master the Snort configuration commands. Snort is a good tool when used in conjunction with host-based firewalls or as an IDS on each server to provide additional security.
    - ### 4.3.2 Cisco Intrusion Detection and Prevention
    - The Cisco brand is widely recognised and well respected in the networking profession. Along with their firewalls and routers, Cisco has several models of intrusion detection, each with a different focus/purpose. In the past, Cisco had two specific, widely used IDS products, the Cisco IDS 4200 Series Sensors and Cisco Catalyst 6500 Series Intrusion-Detection System (IDSM-2) Services Module.
    - There are a number of products in this group, notably the Firepower 4100 series, the Firepower 8000 series, and the Firepower 9000 series. All the products include malware protection as well as sandboxing. These Cisco products also integrate cyber threat intelligence features.
    - The 4100 series is meant for small networks and the 9000 series is designed for large scale networks. One of the chief benefits of using Cisco security products is their widespread use across the industry and the availability of good training. The fact that so many organisations use Cisco indicates a high level of successful field testing, which generally indicates a reliable product. Cisco also sponsors a range of certifications on its products, making it easier to determine whether someone is qualified on a particular Cisco product.
    - ## 4.4 Guided Exercise: Implementing an IDS
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/703f7bb8-e975-472c-a40f-6101723661a2/Annotation_2020-05-25_135401.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/703f7bb8-e975-472c-a40f-6101723661a2/Annotation_2020-05-25_135401.png)
    - In this exercise you are required to install Snort on Windows Server and capture data for analysis.
    - Login to Windows Server and open the desktop folder Exercises -> Snort. Double click the Snort Installer file to install it.
    - Accept the License Agreement by clicking I Agree.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2e44ac86-ef5a-44a9-b5ac-3a52e8580366/Annotation_2020-05-25_135501.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2e44ac86-ef5a-44a9-b5ac-3a52e8580366/Annotation_2020-05-25_135501.png)
    - Click Next on the Choose Components window.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8c835749-a906-4d67-8db4-a2f5f64766e0/Annotation_2020-05-25_135542.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8c835749-a906-4d67-8db4-a2f5f64766e0/Annotation_2020-05-25_135542.png)
    - Click Next on the Choose Install Location.
    - Click Close once the installation finishes and then OK on the Snort Setup
    - Copy the file snort.conf from the Desktop folder Exercises -> Snort to C:\Snort\etc and overwrite the file that is already there. Copy the file local.rules from the Desktop folder Exercises -> Snort to C:\Snort\rules.
    - Open the file local.rules using WordPad. Under the LOCAL RULES section there are different rules having a header and a body. The first rule detects a SYN scan and the second rule detects an ACK scan.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/239d14b8-b6e6-404f-b7b6-50ebcd714b61/Annotation_2020-05-25_135653.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/239d14b8-b6e6-404f-b7b6-50ebcd714b61/Annotation_2020-05-25_135653.png)
    - On the folder Exercises -> Snort double click the file WinPcap to install it. Click Next on the WinPcap Setup window and then click I Agree. Click Install on the next window and leave the check mark on Automatically start the WinPcap driver at boot time.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ed4eaa8f-ea57-47c0-a401-2b7970d56555/Annotation_2020-05-25_135745.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ed4eaa8f-ea57-47c0-a401-2b7970d56555/Annotation_2020-05-25_135745.png)
    - Once the installation finishes click on Finish.
    - Open a command prompt by right clicking the Start button and select Command Prompt (Admin).
    - Type cd C:\Snort\bin where bin is the default directory where the snort executable resides.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a42e8214-a4f1-4dd5-a386-78b0a4d82cb8/Annotation_2020-05-25_135824.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a42e8214-a4f1-4dd5-a386-78b0a4d82cb8/Annotation_2020-05-25_135824.png)
    - Type the following command “snort –c C:\Snort\etc\snort.conf –i1 –l C:\Snort\log –A console” and press enter. The option –c tells Snort to find the configuration file. The option –i1 tells Snort to capture on interface 1. The –l option tells Snort to log alerts and where to save them. The –A console option tells Snort to send alerts also to the console. This option is normally not used because it slows down detection and Snort may drop packets.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b9b29574-32e4-4c1f-998f-6ac820dfcbd0/Annotation_2020-05-25_135902.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b9b29574-32e4-4c1f-998f-6ac820dfcbd0/Annotation_2020-05-25_135902.png)
    - Login to Ubuntu Server and run the comannd nmap –A 192.168.1.20. Allow the scan to complete and then check the Snort command prompt on Windows Server.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/02757ea7-a7e4-43a8-bf1f-d89b48999cad/Annotation_2020-05-25_140020.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/02757ea7-a7e4-43a8-bf1f-d89b48999cad/Annotation_2020-05-25_140020.png)
    - Switch to the Windows Server and on the Snort command prompt you should see 5 SYN scan alerts and 5 ACK scan allerts. Press Control + C to stop Snort.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/40ecdfcd-88a3-412e-8062-8e7db385bfa5/Annotation_2020-05-25_140047.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/40ecdfcd-88a3-412e-8062-8e7db385bfa5/Annotation_2020-05-25_140047.png)
    - Once you stop Snort a list with different statistics will be revealed.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d1019034-45fe-4777-8710-0352bf4458ac/Annotation_2020-05-25_140113.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d1019034-45fe-4777-8710-0352bf4458ac/Annotation_2020-05-25_140113.png)
    - ## 4.5 Honeypots
    - A honeypot is a single machine set up to simulate a valuable server or even an entire subnetwork. The idea is to make the honeypot so attractive that if a hacker breaches the network’s security, to be attracted to the honeypot rather than to the real system. Software can closely monitor everything that happens on that system, enabling tracking and perhaps identification of the intruder.
    - The underlying premise of the honeypot is that any traffic to the honeypot machine to be considered suspicious. Because the honeypot is not a real machine, no legitimate users should have a reason to connect to it. Therefore, anyone attempting to connect to that machine can be considered a possible intruder. The honeypot system can entice him to stay connected long enough to trace where is connecting from. Figure 5-3 illustrates the honeypot concept.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5ed0238b-47be-43ce-8a6f-1af46c54097e/Annotation_2020-05-25_140255.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5ed0238b-47be-43ce-8a6f-1af46c54097e/Annotation_2020-05-25_140255.png)
    - ### 4.5.1 Specter
    - Specter is a software honeypot solution. Complete product information is available at [www.specter.com](http://www.specter.com/). The Specter honeypot is comprised of a dedicated PC with the Specter software running on it. The Specter software can emulate the major Internet protocols/services such as HTTP, FTP, POP3, SMTP, and others, thus appearing to be a fully functioning server. The software was designed to run on Windows 2000 or XP but will execute on later versions of Windows, but it can simulate AIX, Solaris, UNIX, Linux, Mac, and Mac OS X.
    - Specter works by appearing to run a number of services common to network servers. In fact, in addition to simulating multiple operating systems, it can also simulate the following services:
        - SMTP
        - FTP
        - TELNET
        - FINGER
        - POP3
        - IMAP4
        - HTTP
        - SSH
        - DNS
        - SUN-RPC
    - Even though Specter appears to be running these servers, it is actually monitoring all incoming traffic. Because it is not a real server for your network, no legitimate user should be connecting to it. Specter logs all traffic to the server for analysis. Users can set it up in one of five modes:
        - Open: In this mode, the system behaves like a badly configured server in terms of security. The downside of this mode is that you are most likely to attract and catch the least skilful hackers.
        - Secure: This mode has the system behaving like a secure server.
        - Failing: This mode is interesting in that it causes the system to behave like a server with various hardware and software problems. This might attract some hackers because such a system is likely to be vulnerable.
        - Strange: In this mode, the system behaves in unpredictable ways. This sort of behaviour is likely to attract the attention of a more talented hacker and perhaps cause him to stay online longer trying to figure out what is going on. The longer the hacker stays connected, the better the chance of tracing him.
        - Aggressive: This mode causes the system to actively try to trace back the intruder and derive his identity. This mode is most useful for catching the intruder.
    - In all modes, Specter logs the activity, including all information it can derive from the incoming packets. It also attempts to leave traces on the attacker’s machine, which can provide clear evidence for any criminal action. Users can also configure a fake password file in all modes. These are particularly useful because most hackers attempt to access a password file to crack the passwords. If they are successful, they can then log on as a legitimate user. The holy grail of hacking is getting the administrator’s password. There are multiple ways to configure this fake password file:
        - **Easy:** In this mode the passwords are easy to crack, leading an intruder to believe that she has actually found legitimate passwords and usernames. Often a hacker with a legitimate logon will be less careful covering her tracks. If you know that logon is fake and the system is set up to monitor it, you can track it back to the hacker.
        - **Normal:** This mode has slightly more difficult passwords than the easy mode.
        - **Hard:** This mode has even harder passwords to crack. There is even a tougher version of this mode called mean, in which the passwords are very difficult to break so that the hacker can be traced while he is taking time to crack the passwords.
        - **Fun:** This mode uses famous names as usernames.
        - **Warning:** In this mode the hacker gets a warning telling him he has been detected if he is able to crack the password file. The theory behind this mode is that most hackers are simply trying to see if they can crack a system and do not have a specific objective. Letting this sort of hacker know he has been detected is often enough to scare him off.
    - ### 4.5.2 Symantec Decoy Server
    - Because Symantec is such a prominent vendor for both antivirus software and firewall solutions, it should come as no surprise that it also has a honeypot solution. The first Symantec honeypot product was Decoy Server. It simulated a real server by simulating many server functions, such as incoming and outgoing e-mail traffic.
    - As the Decoy Server works as a honeypot, it also works as an IDS monitoring the network for signs of intrusion. If an attack is detected, all traffic related to that attack is recorded for use later in whatever investigative, criminal, or civil procedures that may arise.
    - Decoy Server is designed to be part of a suite of enterprise security solutions that work together, including enterprise versions of Symantec’s antivirus software, firewall software, and antispyware.
- **Module 5 : Fundamentals of Encryption**
    - ## 5.1 The History of Encryption
    - Encrypting communications is a very old idea. People have found the need to send private communications for most of the history of civilization. The need for privacy originally started from military and political needs, but has expanded beyond that. Businesses need to keep data private to maintain a competitive edge. People want to keep certain information, such as their medical records and financial records, private.
    - For much of human history, private communications meant encrypting written communications. Over the past century, that has expanded to radio transmission, telephone communications, and computer/Internet communications. In the past several decades, the encryption of computerized transmissions has actually become ordinary. In fact you can find computer/Internet communications encrypted more often than phone or radio. The digital environment makes implementing a particular type of encryption much easier.
    - Whatever the nature of the data you are encrypting, or the mode of transmitting data, the basic concept is actually quite simple. Messages must be changed in such a way that they cannot be read easily by any party that intercepts them but can be decoded easily by the intended recipient. In this section, a few historical methods of encryption will be examined. Note that these are very old methods, and they cannot be used for secure communication today. An amateur could easily crack the methods discussed in this section. However, they are wonderful examples for conveying the concept of encryption without having to incorporate a great deal of math, which is required of the more complex encryption methods.
    - ### 5.1.1 The Caesar Cipher
    - One of the oldest recorded encryption methods is the Caesar cipher. This name is based on a claim that ancient Roman emperors used this method. This method is simple to implement, requiring no technological assistance.
    - You choose some number by which to shift each letter of a text. For example, if the text is “A cat” and you choose to shift by two letters, then the message becomes “C ecv”. Or, if you choose to shift by three letters, it becomes “D fdw”.
    - In this example, you can choose any shifting pattern you want. Either you can shift to the right or to left by any number of spaces you like. Because this is a simple method to understand, it makes a good place to start your study of encryption. It is, however, extremely easy to crack. You see, any language has a certain letter and word frequency, meaning that some letters are used more frequently than others. In the English language, the most common single-letter word is “a”. The most common three-letter word is “the”.
    - Knowing these two characteristics alone could help you decrypt a Caesar cipher. For example, if you saw a string of seemingly nonsense letters and noticed that a three-letter word was frequently repeated in the message, you might easily guess that this word was “the”—and the odds are highly in favour of this being correct.
    - Furthermore, if you frequently noticed a single-letter word in the text, it is most likely the letter “a”. You now have found the substitution scheme for a, t, h, and e. You can now either translate all of those letters in the message and attempt to surmise the rest or simply analyse the substitute letters used for a, t, h, and e and derive the substitution cipher that was used for this message. Decrypting a message of this type does not even require a computer. Someone with no background in cryptography could do it in less than ten minutes using pen and paper.
    - Caesar ciphers belong to a class of encryption algorithms known as substitution ciphers. The name derives from the fact that each character in the unencrypted message is substituted by one character in the encrypted text.
    - The particular substitution scheme used (for example, 12 or 11) in a Caesar cipher is called a substitution alphabet (that is, b substitutes for a, u substitutes for t, etc.). Because one letter always substitutes for one other letter, the Caesar cipher is sometimes called a mono-alphabet substitution method, meaning that it uses a single substitution for the encryption.
    - The Caesar cipher, like all historical ciphers, is simply too weak for modern use. It is presented here just to help you understand the concepts of cryptography.
    - ### 5.1.2 ROT 13
    - ROT 13 is another single alphabet substitution cipher. All characters are rotated 13 characters through the alphabet. For example the phrase “A CAT” will become “N PNG”.
    - ### 5.1.3 Multi-Alphabet Substitution
    - Eventually, a slight improvement on the Caesar cipher was developed, called multi-alphabet substitution (also called polyalphabetic substitution). In this scheme, you select multiple numbers by which to shift letters (that is, multiple substitution alphabets). For example, if you select three substitution alphabets (12, 22, 13), then “A CAT” becomes “C ADV”.
    - Notice that the fourth letter starts over with another 12, and you can see that the first A was transformed to C and the second A was transformed to D. This makes deciphering the underlying text more difficult. Although this is harder to decrypt than a Caesar cipher, it is not overly difficult to decode. It can be done with simple pen and paper and a bit of effort. It can be cracked quickly with a computer. In fact, no one would use such a method today to send any truly secure message, for this type of encryption is considered very weak.
    - Multi-alphabet ciphers are more secure than single-substitution ciphers. However, they are still not acceptable for modern cryptographic usage. Computer-based cryptanalysis systems can crack historical cryptographic methods (both single alphabet and multi-alphabet) easily. The single-substitution and multi-substitution alphabet ciphers are discussed just to show you the history of cryptography, and to help you get an understanding of how cryptography works.
    - ### 5.1.4 Rail Fence
    - All the preceding ciphers are substitution ciphers. Another approach to classic cryptography is the transposition cipher. The rail fence cipher may be the most widely known transposition cipher. You simply take the message you wish to encrypt and alter each letter on a different row. So “attack at dawn” is written as
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9f293b67-cd01-4fb8-a877-93a8b75cd02f/Annotation_2020-05-26_102533.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9f293b67-cd01-4fb8-a877-93a8b75cd02f/Annotation_2020-05-26_102533.png)
    - Next, you write down the text reading from left to right as one normally would, thus producing
    - atcadwtaktan
    - In order to decrypt the message, the recipient must write it out on rows:
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/01a1fff3-6f3c-47c6-861c-def7cd6f6100/Annotation_2020-05-26_102617.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/01a1fff3-6f3c-47c6-861c-def7cd6f6100/Annotation_2020-05-26_102617.png)
    - Then the recipient reconstructs the original message. Most texts use two rows as examples; however, this can be done with any number of rows you wish to use.
    - ### 5.1.5 Vigenère
    - Vigenère is a polyalphabetic cipher and uses multiple substitutions in order to disrupt letter and word frequency. Let us consider a simple example. Remember a Caesar cipher has a shift, for example a shift of +2 (two to the right). A polyalphabetic substitution cipher would use multiple shifts. Perhaps a +2, –1, +1, +3. When you get to the fifth letter, you simply start over again. So, consider the word “Attack”, being encrypted
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f9b323e3-73ce-49c2-9405-a5505a90cfb4/Annotation_2020-05-26_102944.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f9b323e3-73ce-49c2-9405-a5505a90cfb4/Annotation_2020-05-26_102944.png)
    - Therefore, the ciphertext is “CSUDEJ”. Given that each letter has four possible substitutions, the letter and word frequency is significantly disrupted.
    - Perhaps the most widely known polyalphabetic cipher is the Vigenère cipher. This cipher was actually invented in 1553 by Giovan Battista Bellaso, though it is named after Blaise de Vigenère. It is a method of encrypting alphabetic text by using a series of different mono-alphabet ciphers selected, based on the letters of a keyword. Bellaso added the concept of using any keyword one might wish, thereby making the choice of substitution alphabets difficult to calculate.
    - ### 5.1.6 Enigma
    - It is really impossible to have a discussion about cryptography and not talk about Enigma. Contrary to popular misconceptions, the Enigma is not a single machine but rather a family of machines. The first version was invented by German engineer Arthur Scherbius near the end of World War I. It was used by several different militaries, not just the Germans.
    - Some military texts encrypted using a version of Enigma were broken by Polish cryptanalysts Marian Rejewski, Jerzy Rozycki, and Henryk Zygalski. The three basically reverse engineered a working Enigma machine and used that information to develop tools for breaking Enigma ciphers, including one tool named the cryptologic bomb.
    - The core of the Enigma machine was the rotors, or disks, that were arranged in a circle with 26 letters on them. The rotors were lined up. Essentially, each rotor represented a different single substitution cipher. You can think of the Enigma as a sort of mechanical polyalphabetic cipher. The operator of the Enigma machine would be given a message in plaintext and then type that message into Enigma. For each letter that was typed in, Enigma would provide a different ciphertext based on a different substitution alphabet. The recipient would type in the ciphertext, getting out the plaintext, provided both Enigma machines had the same rotor settings.
    - There were actually several variations of the Enigma machine. The Naval Enigma machine was eventually cracked by British cryptographers working at the now famous Bletchley Park. Alan Turing and a team of analysts were able to eventually break the Naval Enigma machine. Many historians claim this shortened World War II by as much as two years.
    - ## 5.2 Modern Encryption Methods
    - Modern methods of encryption are more secure than the historical methods discussed in the previous section. All the methods discussed in this section are in use today and are considered reasonably secure. In some cases, the algorithm behind these methods requires a sophisticated understanding of mathematics.
    - Number theory often forms the basis for encryption algorithms. Fortunately, for our purposes, having the exact details of these encryption algorithms is not important; this means that you do not require a strong mathematics background to follow this material. More important is a general understanding of how a particular encryption method works and how secure it is.
    - ### 5.2.1 Symmetric Encryption
    - Symmetric encryption refers to the methods where the same key is used to encrypt and decrypt the plaintext.
    - ### 5.2.1.1 Binary Operations
    - Part of modern symmetric cryptography ciphers involves using binary operations. Various operations on binary numbers (numbers made of only zeroes and ones) are well known to programmers and programming students. However, for those readers not familiar with them, a brief explanation follows. When working with binary numbers, three operations are not found in normal math: AND, OR, and XOR operations. Each is illustrated next.
    - **AND**
    - To perform the AND operation, you take two binary numbers and compare them one place at a time. If both numbers have a “one” in both places, then the resultant number is a “one”. If not, then the resultant number is a “zero”, as you see below:
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c4790b9d-2fc9-4c84-83ea-5d4b469f05c2/Annotation_2020-05-26_103805.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c4790b9d-2fc9-4c84-83ea-5d4b469f05c2/Annotation_2020-05-26_103805.png)
    - **OR**
    - The OR operation checks to see whether there is a “one” in either or both numbers in a given place. If so, then the resultant number is “one”. If not, the resultant number is “zero”, as you see here:
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be9e6f1e-09a1-427f-a67c-11544f4275fa/Annotation_2020-05-26_103909.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be9e6f1e-09a1-427f-a67c-11544f4275fa/Annotation_2020-05-26_103909.png)
    - **XOR**
    - The XOR operation impacts your study of encryption the most. It checks to see whether there is a “one” in a number in a given place, but not in both numbers at that place. If it is in one number but not the other, then the resultant number is “one”. If not, the resultant number is “zero”, as you see here:
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/235cadc4-fd97-4a40-8f2e-933d62eeae50/Annotation_2020-05-26_104013.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/235cadc4-fd97-4a40-8f2e-933d62eeae50/Annotation_2020-05-26_104013.png)
    - XORing has an interesting property in that it is reversible. If you XOR the resultant number with the second number, you get back the first number. In addition, if you XOR the resultant number with the first number, you get the second number.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6e729e38-afc5-44a5-bccb-1e70c6f44c7f/Annotation_2020-05-26_104053.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6e729e38-afc5-44a5-bccb-1e70c6f44c7f/Annotation_2020-05-26_104053.png)
    - Binary encryption using the XOR operation opens the door for some rather simple encryption. Take any message and convert it to binary numbers and then XOR that with some key. Converting a message to a binary number is a simple two-step process. First, convert a message to its ASCII code, and then convert those codes to binary numbers.
    - Each letter/number will generate an eight-bit binary number. You can then use a random string of binary numbers of any given length as the key. Simply XOR your message with the key to get the encrypted text, and then XOR it with the key again to retrieve the original message.
    - This method is easy to use and great for computer science students; however, it does not work well for truly secure communications because the underlying letter and word frequency remains. This exposes valuable clues that even an amateur cryptographer can use to decrypt the message. Yet, it does provide a valuable introduction to the concept of single-key encryption.
    - Although simply XORing the text is not the method typically employed, single-key encryption methods are widely used today. For example, you could simply include a multi-alphabet substitution that was then XORed with some random bit stream—variations of which do exist in a few actual encryption methods currently used.
    - Modern cryptography methods, as well as computers, make decryption a rather advanced science. Therefore, encryption must be equally sophisticated in order to have a chance of success.
    - ### 5.2.1.2 Data Encryption Standard
    - Data Encryption Standard, or DES as it is often called, was developed by IBM in the early 1970s and made public in 1976. DES uses a symmetric key system, which means the same key is used to encrypt and to decrypt the message. DES uses short keys and relies on complex procedures to protect its information. The actual DES algorithm is quite complex. The basic concept, however, is as follows:
        - The data is divided into 64-bit blocks, and those blocks are then reordered.
        - Reordered data are then manipulated by 16 separate rounds of encryption, involving substitutions, bit-shifting, and logical operations using a 56-bit key.
        - Finally, the data are reordered one last time.
    - DES uses a 56-bit cipher key applied to a 64-bit block. There is actually a 64-bit key, but one bit of every byte is actually used for error detection, leaving just 56 bits for actual key operations. The problem with DES is the same problem that all symmetric key algorithms have: How do you transmit the key without it becoming compromised? This issue led to the development of public key encryption.
    - ### 5.2.1.3 Blowfish
    - Blowfish is a symmetric block cipher. This means that it uses a single key to both encrypt and decrypt the message and works on “blocks” of the message at a time. It uses a variable-length key ranging from 32 to 448 bits. This flexibility in key size allows you to use it in various situations. Blowfish was designed in 1993 by Bruce Schneier. It has been analysed extensively by the cryptography community and has gained wide acceptance. It is also a non-commercial (that is, free of charge) product, thus making it attractive to budget-conscious organisations.
    - ### 5.2.1.4 AES (Advanced Encryption Standard)
    - Advanced Encryption Standard (AES) uses the Rijndael algorithm. The developers of this algorithm have suggested multiple alternative pronunciations for the name, including “reign dahl,” “rain doll,” and “rhine dahl.” This algorithm was developed by two Belgian researchers, Joan Daemen of Proton World International and Vincent Rijmen, a postdoctoral researcher in the Electrical Engineering Department of Katholieke Universiteit Leuven.
    - AES specifies three key sizes: 128, 192, and 256 bits. By comparison, DES keys are 56 bits long, and Blowfish allows varying lengths up to 448 bits. AES uses a block cipher. This algorithm is widely used, considered very secure, and therefore a good choice for many encryption scenarios.
    - ### 5.2.2 Public Key Encryption
    - Public key encryption is essentially the opposite of single-key encryption. With any public key encryption algorithm, one key is used to encrypt a message (called the public key) and another is used to decrypt the message (the private key). You can freely distribute your public key so that anyone can encrypt a message to send to you, but only you have the private key and only you can decrypt the message. The actual mathematics behind the creation and applications of the keys is a bit complex and beyond the scope of this book. Many public key algorithms are dependent, to some extent, on large prime numbers, factoring, and number theory.
    - ### 5.2.2.1 RSA
    - The RSA method is a widely used encryption algorithm. You cannot discuss cryptography without at least some discussion of RSA. This public key method was developed in 1977 by three mathematicians: Ron Rivest, Adi Shamir, and Len Adleman. The name RSA is derived from the first letter of each mathematician’s last name.
    - One significant advantage of RSA is that it is a public key encryption method. That means there are no concerns with distributing the keys for the encryption. However, RSA is much slower than symmetric ciphers. In fact, in general, asymmetric ciphers are slower than symmetric ciphers.
    - The steps to create the key are as follow:
        - Generate two large random primes, p and q, of approximately equal size.
        - Pick two numbers so that when they are multiplied together the product will be the size you want (that is, 2048 bits, 4096 bits, etc.).
        - Now multiply p and q to get n.
        - Let n = pq.
        - Multiply Euler’s totient for each of these primes. If you are not familiar with this concept, the Euler’s Totient is the total number of co-prime numbers. Two numbers are considered co-prime if they have no common factors.
    - For example, if the original number is 7, then 5 and 7 would be co-prime. It just so happens that for prime numbers, this is always the number minus 1. For example, 7 has 6 numbers that are co-prime to it (if you think about this a bit you will see that 1, 2, 3, 4, 5, 6 are all co-prime with 7).
        - Let m = (p – 1)(q – 1).
        - Select another number; call this number e. You want to pick e so that it is co-prime to m.
        - Find a number d that when multiplied by e and modulo m would yield 1. (Note: Modulo means to divide two numbers and return the remainder. For example, 8 modulo 3 would be 2.)
        - Find d, such that de mod m ≡ 1.
    - Now you publish e and n as the public key and keep d and n as the secret key. To encrypt you simply take your message raised to the e power and modulo n = Me % n
    - To decrypt you take the ciphertext, and raise it to the **d** power modulo **n**:
    - **P = Cd % n**
    - RSA has become a popular encryption method. It is considered quite secure and is often used in situations where a high level of security is needed.
    - ### 5.2.2.2 Elliptic Curve
    - The Elliptic Curve algorithm was first described in 1985 by Victor Miller (IBM) and Neil Koblitz (University of Washington).
    - The security of Elliptic Curve cryptography is based on the fact that finding the discrete logarithm of a random elliptic curve element with respect to a publicly known base point is difficult to the point of being impractical to do.
    - The size of the elliptic curve determines the difficulty of finding the algorithm, and thus the security of the implementation. The level of security afforded by an RSA-based system with a large modulus can be achieved with a much smaller elliptic curve group. There are actually several ECC algorithms. There is an ECC version of Diffie-Hellman, an ECC version of DSA, and many others.
    - The U.S. National Security Agency has endorsed ECC (Elliptic Curve Cryptography) by including schemes based on it in its Suite B set of recommended algorithms and allows their use for protecting information classified up to top secret with 384-bit keys.
    - ### 5.2.3 Digital Signatures and Certificates
    - A digital signature is not used to ensure the confidentiality of a message, but rather to guarantee who sent the message. This is referred to as non-repudiation. Essentially, a digital signature proves who the sender is. Digital signatures are actually rather simple, but clever. They simply reverse the asymmetric encryption process.
    - Recall that in asymmetric encryption, the public key (which anyone can have access to) is used to encrypt a message to the recipient, and the private key (which is kept secure, and private) can decrypt it. With a digital signature, the sender encrypts something with his or her private key. If the recipient is able to decrypt that with the sender’s public key, then it must have been sent by the person purported to have sent the message.
    - ### 5.2.3.1 Digital Certificates
    - Public keys are widely distributed and that getting someone’s public key is fairly easy to do and are also needed to verify a digital signature. As to how public keys are distributed, probably the most common way is through digital certificates. The digital certificate contains a public key and some means to verify whose public key it is.
    - X.509 is an international standard for the format and information contained in a digital certificate. X.509 is the most used type of digital certificate in the world. It is a digital document that contains a public key signed by a trusted third party, which is known as a certificate authority (CA). The contents of an X.509 certificate are:
        - Version
        - Certificate holder’s public key
        - Serial number
        - Certificate holder’s distinguished name
        - Certificate’s validity period
        - Unique name of certificate issuer
        - Digital signature of issuer
        - Signature algorithm identifier
    - A certificate authority issues digital certificates. The primary role of the CA is to digitally sign and publish the public key bound to a given user. It is an entity trusted by one or more users to manage certificates.
    - A registration authority (RA) is used to take the burden off, of a CA by handling verification prior to certificates being issued. RAs act as a proxy between users and CAs. RAs receive a request, authenticate it, and forward it to the CA.
    - A public key infrastructure (PKI) distributes digital certificates. This network of trusted CA servers serves as the infrastructure for distributing digital certificates that contain public keys. A PKI is an arrangement that binds public keys with respective user identities by means of a CA.
    - What if a certificate is expired, or revoked? A certificate revocation list (CRL) is a list of certificates that have been revoked for one reason or another. Certificate authorities publish their own certificate revocation lists. A newer method for verifying certificates is Online Certificate Status Protocol (OCSP), a real-time protocol for verifying certificates.
    - There are several different types of X.509 certificates. They each have at least the elements listed at the beginning of this section, but are for different purposes. The most common certificate types are listed below:
        - Domain validation certificates are among the most common. These are used to secure communication with a specific domain. This is a low-cost certificate that website administrators use to provide TLS for a given domain.
        - Wildcard certificates, as the name suggests, can be used more widely, usually with multiple sub-domains of a given domain. So rather than have a different X.509 certificate for each sub-domain, you would use a wildcard certificate for all sub-domains.
        - Code-signing certificates are X.509 certificates used to digitally sign some type of computer code. These usually require more validation of the person requesting the certificate, before they can be issued.
        - Machine/computer certificates are X.509 certificates assigned to a specific machine. These are often used in authentication protocols. For example, in order for the machine to sign into the network, it must authenticate using its machine certificate.
        - User certificates are used for individual users. Like machine/computer certificates, these are often used for authentication. The user must present his or her certificate to authenticate prior to accessing some resource.
        - E-mail certificates are used for securing e-mail. Secure Multipurpose Internet Mail Extensions (S/MIME) uses X.509 certificates to secure e-mail communications.
        - A Subject Alternative Name (SAN) is not so much a type of certificate as a special field in X.509. It allows you to specify additional items to be protected by this single certificate. These could be additional domains or IP addresses.
        - Root certificates are used for root authorities. These are usually self-signed by that authority.
    - ### 5.2.3.2 PGP Certificates
    - Pretty Good Privacy (PGP) is not a specific encryption algorithm, but rather a system. It offers digital signatures, asymmetric encryption, and symmetric encryption. It is often found in e-mail clients. PGP was introduced in the early 1990s, and it’s considered to be a very good system.
    - PGP uses its own certificate format. The main difference, however, is that PGP certificates are self-generated. They are not generated by any certificate authority.
    - ## 5.3 Windows and Linux Encryption
    - Microsoft Windows provides encryption tools to prevent loss of confidential data.
        - Encrypting File System (EFS) encodes files in order anyone who is able to get the files not to be able to read them. The files are only readable when you sign in to the computer using your user account. You can use EFS to encrypt individual files and entire drives. It is recommended to encrypt folders or drives instead of individua files. When you encrypt a folder or a drive the files contained are also encrypted. Even new files created in the encrypted folder are automatically encrypted.
        - BitLocker Drive Encryption provides another layer of protection by encrypting the entire hard drive. By linking this encryption to a key stored in a Trusted Platform Module (TPM), bitLocker reduces the risk of data being lost when a computer is stolen or when a hard disk is stolen and placed in another computer. In such scenario the thief will boot into an alternate operating system and try to retrieve data from the stolen drive or computer. With BitLocker that type of offline attack in neutered.
        - BitLocker To Go extends BitLocker encryption to removable media such as USB flash drives.
    - Linux provides a number of cryptographic techniques to protect data on physical devices such as hard disks or removable media. Such technique is Linux Unified Key Setup (LUKS). This technique allows the encryption of Linux partitions.
    - Using LUKS you can encrypt the entire blcok device which is well suited to protect data on removable storage or the laptops disk drive. LUKS uses the existing device mapper kernel subsystem and also provides passprhase strengthening for protection against dictionary attacks.
    - ## 5.4 Guided Exercise: Enabling BitLocker
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fb16472a-722b-4bdc-8ec7-ea4b0ffc3bab/Annotation_2020-05-26_110539.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fb16472a-722b-4bdc-8ec7-ea4b0ffc3bab/Annotation_2020-05-26_110539.png)
    - In this exercise you will enable Bitlocker to encrypt the hard drive.
    - Login to Windows 10 and once logged in click on the Start button and in the search box write gpedit.msc and press enter.
    - On the Local Group Policy Editor window expand from Computer Configuration -> Administrative Templates -> Windows Components -> BitLocker Drive Encryption -> Operating System Drives.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1d6d5b2b-2c79-4784-8a24-e0eaec8f03f0/Annotation_2020-05-26_110641.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1d6d5b2b-2c79-4784-8a24-e0eaec8f03f0/Annotation_2020-05-26_110641.png)
    - Double click the option Require additional authentcation at startup and on the new window that will open click Enabled (Make sure the box Allow BitLocker without a compatible TPM is ticket)and then Apply -> OK. After that close the Local Group Policy Editor window.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/06ca31fd-d726-4f52-a3e9-8bf11707925f/Annotation_2020-05-26_110707.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/06ca31fd-d726-4f52-a3e9-8bf11707925f/Annotation_2020-05-26_110707.png)
    - Open file explorer and click on This PC. Right click on the Local Disk (C:) and click on the option Turn on BitLocker.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a8ed427b-32fc-4690-bfd8-6a576d5f0b55/Annotation_2020-05-26_110741.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a8ed427b-32fc-4690-bfd8-6a576d5f0b55/Annotation_2020-05-26_110741.png)
    - BitLocker will verify that the computer meets the requirements and will ask how to unlock the drive at startup. Choose the option Enter a password.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/58b11711-cac4-4d8c-9d9d-b10497af2385/Annotation_2020-05-26_110815.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/58b11711-cac4-4d8c-9d9d-b10497af2385/Annotation_2020-05-26_110815.png)
    - Enter a password which is at least 8 characters long with uppercase and lowercase letters, symbols and spaces.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d90125fb-6ea7-46f1-a65e-aca04e134b89/Annotation_2020-05-26_110853.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d90125fb-6ea7-46f1-a65e-aca04e134b89/Annotation_2020-05-26_110853.png)
    - Then you should save (backup) the recovery key. You can save the recovery key to a USB flash drive, print it, save it to a file or to your Microsoft account. For this exercise choose the option to print the recovery key.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/33f7da22-27ed-4070-affc-d2c8ea64dc7a/Annotation_2020-05-26_110921.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/33f7da22-27ed-4070-affc-d2c8ea64dc7a/Annotation_2020-05-26_110921.png)
    - On the Print window select the option Microsoft Print to PDF and click Print.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5164e6d6-2bf1-4ab2-a55f-a303760a47e9/Annotation_2020-05-26_110950.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5164e6d6-2bf1-4ab2-a55f-a303760a47e9/Annotation_2020-05-26_110950.png)
    - Provide a file name for the recovery key (BitLocker Key for example) and save it to the Backup (E:) drive. Click Save and then OK. Then it will ask you to Run BitLocker system check. Uncheck the box (although you can leave it to run a check) and click Start encrypting.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9a31ca15-c984-4db3-b7ba-f0fa99ba4978/Annotation_2020-05-26_111017.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9a31ca15-c984-4db3-b7ba-f0fa99ba4978/Annotation_2020-05-26_111017.png)
    - The encryption process will take some time to finish although if you have a large SATA disk such as 1TB will take a long time to finish where SSDs take less time.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e1607c60-4a97-424f-a57b-c853881fdaeb/Annotation_2020-05-26_111043.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e1607c60-4a97-424f-a57b-c853881fdaeb/Annotation_2020-05-26_111043.png)
    - Click Close once the encryption process has finished.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4136a3b2-e17d-421d-82cc-b49eb9d64335/Annotation_2020-05-26_111112.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4136a3b2-e17d-421d-82cc-b49eb9d64335/Annotation_2020-05-26_111112.png)
    - Restart the computer to confirm that once it starts asks for the BitLocker password. Enter the password and then press enter.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1a7f9708-4343-451c-8578-f25b84230294/Annotation_2020-05-26_111143.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1a7f9708-4343-451c-8578-f25b84230294/Annotation_2020-05-26_111143.png)
    - Then the computer will ask for the password to login.
    - ## 5.5 Guided Exercise: Encrypting a Folder Using EFS
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be8bd9d0-e84d-4a2d-b7e6-5af1f834ea8c/Annotation_2020-05-26_111245.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be8bd9d0-e84d-4a2d-b7e6-5af1f834ea8c/Annotation_2020-05-26_111245.png)
    - In this exercise you will encrypt a folder along with its contents.
    - Login to Windows 10 and open File Explorer. Once File Explorer opens click on the Documents folder from the Quick Access menu on the left.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ec7a1a41-b318-49ba-ac31-6fbfab71c81b/Annotation_2020-05-26_111327.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ec7a1a41-b318-49ba-ac31-6fbfab71c81b/Annotation_2020-05-26_111327.png)
    - Within the Documents folder a subfolder exist with the name Accounting. Within the Accounting folder there are 3 files which are considered sensitive.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1af40463-0a8f-4307-9c6c-3bd7a4f04824/Annotation_2020-05-26_111350.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1af40463-0a8f-4307-9c6c-3bd7a4f04824/Annotation_2020-05-26_111350.png)
    - Right click on the Accounting folder and select Properties. On the Accounting Properties window, in the General tab click on Advanced.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/66be9f84-f47c-4d99-91a6-fae3795f64a5/Annotation_2020-05-26_111434.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/66be9f84-f47c-4d99-91a6-fae3795f64a5/Annotation_2020-05-26_111434.png)
    - On the Advanced Attributes window click the option “Encrypt contents to secure data”. Then click OK and then Apply.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/13fc0ea2-c28e-42ff-b9b5-af45825b2c1d/Annotation_2020-05-26_111529.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/13fc0ea2-c28e-42ff-b9b5-af45825b2c1d/Annotation_2020-05-26_111529.png)
    - Once you click Apply a new window will open asking you to confirm the attribute changes. Select the option “Apply changes to this folder, subfolders and files” and click OK. Click again OK to close the folder properties.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e06131ea-d78f-4b00-a92e-9cbae50abc49/Annotation_2020-05-26_111620.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e06131ea-d78f-4b00-a92e-9cbae50abc49/Annotation_2020-05-26_111620.png)
    - You will notice then that the Accounting folder has now the green color.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bef9c294-b2fe-4239-8406-ac6b246791bf/Annotation_2020-05-26_111649.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bef9c294-b2fe-4239-8406-ac6b246791bf/Annotation_2020-05-26_111649.png)
    - Now that EFS is enabled a small icon exists in the taskbar which is the EFS key backup notice. Always a good idea to backup the file encryption certificate and key. Click on the EFS icon in the taskbar and on the Window Encrypting File System select Back up now.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5ef3d90e-dd35-45d0-a47c-ee69383c6d06/Annotation_2020-05-26_111718.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5ef3d90e-dd35-45d0-a47c-ee69383c6d06/Annotation_2020-05-26_111718.png)
    - On the Certificate Export Wizard window click Next
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f2bd5860-1fbd-4435-898b-12f3266bab93/Annotation_2020-05-26_111751.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f2bd5860-1fbd-4435-898b-12f3266bab93/Annotation_2020-05-26_111751.png)
    - Ensure that the options Personal Information Exchange – PKCS, Include all certificates in the certification path if possible and Enable certificate privacy are checked. Then click Next.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9d311778-17f6-4c89-88ef-2e5fd83b0ef8/Annotation_2020-05-26_111829.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9d311778-17f6-4c89-88ef-2e5fd83b0ef8/Annotation_2020-05-26_111829.png)
    - Check the box next to password and enter a password. For password use P@ssw0rd123! and click Next.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8395cb6d-5753-412b-9c7d-c23b0e20ba01/Annotation_2020-05-26_111857.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8395cb6d-5753-412b-9c7d-c23b0e20ba01/Annotation_2020-05-26_111857.png)
    - Then click browse to select a location and a filename where the key should be saved. Select the Backup drive and for filename use exportedkey.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/21d97b27-b3e1-4f2a-8055-4666594c1c18/Annotation_2020-05-26_111922.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/21d97b27-b3e1-4f2a-8055-4666594c1c18/Annotation_2020-05-26_111922.png)
    - Click Save and then Next. On the next window simply review the File Name, File Format and other information of the certificate export. Then click Finish.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/292f7b9a-af88-45ed-bb9a-9c8b945a5c91/Annotation_2020-05-26_112004.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/292f7b9a-af88-45ed-bb9a-9c8b945a5c91/Annotation_2020-05-26_112004.png)
    - ## 5.5 Hashing
    - A hash function, “H” for example, is a function that takes a variable-size input “m” and returns a fixed-size string. The value that is returned is called the hash value “h” or the digest. This can be expressed mathematically as “h = H(m)”. There are three properties a hash function should have:
        - Variable length input with fixed length output. In other words, no matter what you put into the hashing algorithm, the same sized output is produced.
        - H(x) is one-way; you cannot “un-hash” something.
        - H(x) is collision-free. Two different input values do not produce the same output. A collision refers to a situation where two different inputs yield the same output. A hash function should not have collisions.
    - Hashing is how Windows stores passwords. For example, if your password is “password”, then Windows will first hash it, producing something like:
    - “0BD181063899C9239016320B50D3E896693A96DF”.
    - It then stores that hash in the SAM (Security Accounts Manager) file in the Windows System directory. When you log on, Windows cannot “un-hash” your password, so what Windows does is take whatever password you type in, hash it, and then compare the result with what is in the SAM file. If they match (exactly) then you can log in.
    - Storing Windows passwords is just one application of hashing. There are others. For example, in computer forensics, hashing a drive before starting a forensic examination is common practice. Then later you can always hash it again to see whether anything was changed (accidently or intentionally). If the second hash matches the first, then nothing has been changed.
    - In relationship to hashing, the term “salt” refers to random bits that are used as one of the inputs to the hash. Essentially, the salt is intermixed with the message that will be hashed. Salt data complicates dictionary attacks that use pre-encryption of dictionary entries. Is also effective against rainbow table attacks. For best security, the salt value is kept secret, separate from the password database/file.
    - ### 5.5.1 MD5
    - MD5 is a 128-bit hash that is specified by RFC 1321. It was designed by Ron Rivest in 1991 to replace an earlier hash function, MD4. In 1996, a flaw was found with the design of MD5. Although it was not a clearly fatal weakness, cryptographers began recommending the use of other algorithms, such as SHA-1. The biggest problem with MD5 is that it is not collision resistant.
    - ### 5.5.2 SHA
    - The Secure Hash Algorithm is perhaps the most widely used hash algorithm today. Several versions of SHA now exist. SHA (all versions) is considered secure and collision free. The versions include:
        - SHA-1: This 160-bit hash function resembles the MD5 algorithm. This was designed by the National Security Agency (NSA) to be part of the Digital Signature Algorithm.
        - SHA-2: This is actually two similar hash functions, with different block sizes, known as SHA-256 and SHA-512. They differ in the word size; SHA-256 uses 32-byte (256 bits) words whereas SHA-512 uses 64-byte (512 bits) words. There are also truncated versions of each standard, known as SHA-224 and SHA-384. These were also designed by the NSA.
        - SHA-3: This is the latest version of SHA. It was adopted in October of 2012.
    - ## 5.6 Guided Exercise: Hashing
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/43464918-9819-4bb1-9b84-0d313ce39468/Annotation_2020-05-26_112601.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/43464918-9819-4bb1-9b84-0d313ce39468/Annotation_2020-05-26_112601.png)
    - In this exercise we will use a tool called HashGenerator to generate hashes.
    - In the Windows 10 machine open the desktop folder called Exercises and then the folder HashGenerator. Double click the file Setup_HashGenerator to install it.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dd4421e8-4dd9-4ed2-963e-d840b654711e/Annotation_2020-05-26_112651.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dd4421e8-4dd9-4ed2-963e-d840b654711e/Annotation_2020-05-26_112651.png)
    - On the Hash Generator Setup window click on Next.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3161f66f-110b-4ff4-aacb-6e0300aeeb75/Annotation_2020-05-26_112719.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3161f66f-110b-4ff4-aacb-6e0300aeeb75/Annotation_2020-05-26_112719.png)
    - Click again Next on the window Choose a file location.
    - Click Install on the Begin Installation of Hash generator window.
    - Click Yes on the User Account Control window.
    - Click Close on the Hash Generator Setup window.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9a1b02a7-024f-4da2-ac5b-140b823af0b5/Annotation_2020-05-26_112810.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9a1b02a7-024f-4da2-ac5b-140b823af0b5/Annotation_2020-05-26_112810.png)
    - On the Hash Generator tool Select Text as the Hash Input Type and the enter the word password on the “Enter or Paste any Text” text box and click on Generate Hash.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/00deee39-ee16-4f7d-8a9f-f76db6a6754c/Annotation_2020-05-26_112834.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/00deee39-ee16-4f7d-8a9f-f76db6a6754c/Annotation_2020-05-26_112834.png)
    - Observe the different types of hashes and the actual hash values.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fbe78363-b32f-444f-ae61-422643ba01aa/Annotation_2020-05-26_112859.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fbe78363-b32f-444f-ae61-422643ba01aa/Annotation_2020-05-26_112859.png)
    - ## 5.7 Cracking Passwords
    - Cracking passwords is not the same as breaking encrypted transmissions. If anyone has successfully cracked a password and particularly the administrator/root password then other security measures are rendered irrelevant.
    - ### 5.7.1 John the Ripper
    - John the Ripper is a password cracker popular with both network administrators and hackers.
    - This product is completely command line–based and has no Windows interface. It enables the user to select text files for word lists to attempt cracking a password. Although John the Ripper is less convenient to use because of its command-line interface, it has been around for a long time and is well regarded by both the security and hacking communities.
    - John the Ripper works with password files rather than attempting to crack live passwords on a given system. Passwords are usually encrypted and in a file on the operating system. Hackers frequently try to get that file off the machine and download it to their own system so they can crack it at will. They might also look for discarded media in your dumpster in order to find old backup tapes that might contain password files. Each operating system stores that file in a different place:
        - In Linux, it is /etc/passwd and /etc/shadow.
        - In Windows 2000 and beyond, it is in a hidden .sam file.
    - After you have downloaded John the Ripper, you can run it by typing in (at a command line) the word john followed by the file you want it to try to crack:
        - john passwd
        - john –wordfile:/usr/share/wordlists/rockyou.txt –rules passwdCracked passwords will be printed to the terminal and saved in a file called john.pot, found in the directory into which you installed John the Ripper.
    - ### 5.7.2 Rainbow Tables
    - In 1980 Martin Hellman described a cryptanalytic time-memory trade-off that reduces the time of cryptanalysis by using pre-calculated data stored in memory. Essentially, these types of password crackers are working with pre-calculated hashes of all passwords available within a certain character space, be that “a-z” or “a-zA-z” or “a-zA-Z0-9” etc. These files are called rainbow tables. They are particularly useful when trying to crack hashes. Because a hash is a one-way function, the way to break it is to attempt to find a match. The attacker takes the hashed value and searches the rainbow tables seeking a match to the hash. If one is found, then the original text for the hash is found. Popular hacking tools such as Ophcrack depend on rainbow tables
    - ### 5.7.3 Brute Force
    - This method simply involves trying every possible key. It is guaranteed to work, but is likely to take so long that it is simply not useable. For example, to break a Caesar cipher there are only 26 possible keys, which you can try in a very short time. But consider AES, with the smallest key size of 128 bits. If you tried 1 trillion keys a second, it could take 112,527,237,738,405,576,542 years to try them all.
    - ## 5.8 Guided Exercise: Cracking Passwords
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bec5e4e1-2ee2-405f-a37f-b6bf887435dd/Annotation_2020-05-26_113427.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bec5e4e1-2ee2-405f-a37f-b6bf887435dd/Annotation_2020-05-26_113427.png)
    - In this exercise you will use the tool called Ophcrack to crack password hashes.
    - Open the desktop folder called Exercises and then the folder Ophcarck.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/63ea07ba-a83c-46bb-b1ad-bda10c2f11d2/Annotation_2020-05-26_113503.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/63ea07ba-a83c-46bb-b1ad-bda10c2f11d2/Annotation_2020-05-26_113503.png)
    - Double click the file ophcrack to start it. Some rainbow tables are already installed within Ophcrack.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f7e1a99e-25e9-4af9-9a30-cc7f367b70fb/Annotation_2020-05-26_113525.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f7e1a99e-25e9-4af9-9a30-cc7f367b70fb/Annotation_2020-05-26_113525.png)
    - From the Ophcrack folder double click the file hashes to open it.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5f4b2391-49c0-4667-9a55-6fe696d4e3a4/Annotation_2020-05-26_113555.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5f4b2391-49c0-4667-9a55-6fe696d4e3a4/Annotation_2020-05-26_113555.png)
    - Once you open the file copy the line that refers to jim.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ba094356-0020-4d85-abe7-374bf3830edd/Annotation_2020-05-26_113617.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ba094356-0020-4d85-abe7-374bf3830edd/Annotation_2020-05-26_113617.png)
    - In Ophcrack click Load and then Single hash, paste the hash on Load Single Hash window and then click OK.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/60655a4c-e557-4709-9cc2-38e3417acc68/Annotation_2020-05-26_113642.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/60655a4c-e557-4709-9cc2-38e3417acc68/Annotation_2020-05-26_113642.png)
    - Click Crack to start cracking the password hash. Then you will see the actual password of the user jim.
- **Module 6 : Virtual Private Networks (VPN)**
    - ## 6.1 Introduction to VPN
    - Virtual Private Networks (VPNs) are a common way to connect remotely to a network in a secure fashion. A VPN creates a private network connection over the Internet to connect remote sites or users together. Instead of using a dedicated connection, a VPN uses virtual connections routed through the Internet from the remote site or user to the private network. Security is accomplished by encrypting all the transmissions.
    - A VPN allows a remote user to have network access just as if were local to the private network. This means not only connecting the user to the network as if the user were local but also making the connection secure. Because most organisations have many employees traveling and working from home, remote network access has become an important security concern. Users want access, and administrators want security. The VPN is the current standard for providing both.
    - To accomplish its purpose, the VPN must emulate a direct network connection. This means it must provide both the same level of access and the same level of security as a direct connection. To emulate a dedicated point-to-point link, data is encapsulated, or wrapped, with a header that provides routing information allowing it to transmit across the Internet to reach its destination. This creates a virtual network connection between the two points. The data being sent is also encrypted, thus making that virtual network private.
    - A VPN does not require separate technology or direct cabling. It is a virtual private network, which means it can use existing connections to provide a secure connection. In most cases it is used over normal Internet connections.
    - A variety of methods are available for connecting one computer to another. At one time dialling up to an ISP via a phone modem was common. Now cable modems, cellular devices, and other mechanisms are more common. All of these methods have something in common: they are not inherently secure. All data being sent back and forth is unencrypted, and anyone can use a packet sniffer to intercept and view the data. Furthermore, neither end is authenticated. This means you cannot be completely certain who you are really sending data to or receiving data from. The VPN provides an answer to these issues.
    - This sort of arrangement is generally acceptable for an ISP. The customers connecting simply want a channel to the Internet and do not need to connect directly or securely to a specific network. However, this setup is inadequate for remote users attempting to connect to an organisation’s network. In such cases the private and secure connection a VPN provides is critical.
    - Individual remote users are not the only users of VPN technology. Many larger organisations have offices in various locations. Achieving reliable and secure site-to-site connectivity for such organisations is an important issue. The various branch offices must be connected to the central corporate network through tunnels that transport traffic over the Internet.
    - Using VPN technology for site-to-site connectivity enables a branch office with multiple links to move away from an expensive, dedicated data line and to simply utilize existing Internet connections.
    - ## 6.2 VPN Protocols
    - Multiple ways exist to achieve the encryption needs of a VPN. Certain network protocols are frequently used for VPNs. The two most commonly used protocols for this purpose are Point-to-Point Tunnelling Protocol (PPTP) and Layer 2 Tunnelling Protocol (L2TP). The part of the connection in which the data is encapsulated is referred to as the tunnel. L2TP is often combined with IPSec to achieve a high level of security.
    - ### 6.2.1 PPTP
    - PPTP is a tunnelling protocol that enables an older connection protocol, PPP (Point-to-Point Protocol), to have its packets encapsulated within Internet Protocol (IP) packets and forwarded over any IP network, including the Internet itself. PPTP is often used to create VPNs. PPTP is an older protocol than L2TP or IPSec. Some experts consider PPTP to be less secure than L2TP or IPSec, but it consumes fewer resources and is supported by almost every VPN implementation. It is basically a secure extension to PPP.
    - PPTP was originally proposed as a standard in 1996 by the PPTP Forum—a group of companies that included Ascend Communications, ECI Telematics, Microsoft, 3Com, and U.S. Robotics. This group’s purpose was to design a protocol that would allow remote users to communicate securely over the Internet.
    - Although newer VPN protocols are available, PPTP is still widely used, because almost all VPN equipment vendors support PPTP. Another important benefit of PPTP is that it operates at layer 2 of the OSI model (the data link layer), allowing different networking protocols to run over a PPTP tunnel.
    - When connecting users to a remote system, encrypting the data transmissions is not the only facet of security. You must also authenticate the user. PPTP supports two separate technologies for accomplishing this: Extensible Authentication Protocol (EAP) and Challenge Handshake Authentication Protocol (CHAP).
    - ### 6.2.1.1 Extensible Authentication Protocol (EAP)
    - EAP was designed specifically with PPTP and is meant to work as part of PPP. EAP works from within PPP’s authentication protocol. It provides a framework for several different authentication methods. EAP is meant to supplant proprietary authentication systems and includes a variety of authentication methods to be used, including passwords, challenge-response tokens, and public key infrastructure certificates.
    - ### 6.2.1.2 Challenge Handshake Authentication Protocol (CHAP)
    - CHAP is actually a three-part handshaking (a term used to denote authentication processes) procedure. After the link is established, the server sends a challenge message to the client machine originating the link. The originator responds by sending back a value calculated using a one-way hash function. The server checks the response against its own calculation of the expected hash value. If the values match, the authentication is acknowledged; otherwise, the connection is usually terminated. This means that the authorization of a client connection has three stages.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c8026ae3-dd6d-4896-973c-c8a99172114b/Annotation_2020-05-26_121203.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c8026ae3-dd6d-4896-973c-c8a99172114b/Annotation_2020-05-26_121203.png)
    - What makes CHAP particularly interesting is that it periodically repeats the process. This means that even after a client connection is authenticated, CHAP repeatedly seeks to re-authenticate that client, providing a robust level of security.
    - ### 6.2.2 L2TP
    - Layer 2 Tunnelling Protocol is an extension or enhancement of the Point-to-Point Tunnelling Protocol that is often used to operate virtual private networks over the Internet. Essentially, it is a new and improved version of PPTP. As its name suggests, it operates at the data link layer of the OSI model (like PPTP). Both PPTP and L2TP are considered by many experts to be less secure than IPSec. However, seeing IPSec used together with L2TP to create a secure VPN connection is not uncommon.
    - Like PPTP, L2TP supports EAP and CHAP. However, it also offers support for other authentication methods, for a total of six:
        - EAP
        - CHAP
        - MS-CHAP
        - PAP
        - SPAP
        - Kerberos
    - ### 6.2.2.1 MS-CHAP
    - As the name suggests, MS-CHAP is a Microsoft-specific extension to CHAP. Microsoft created MS-CHAP to authenticate remote Windows workstations. The goal is to provide the functionality available on the LAN to remote users while integrating the encryption and hashing algorithms used on Windows networks.
    - Wherever possible, MS-CHAP is consistent with standard CHAP. However, some basic differences between MS-CHAP and standard CHAP include the following:
        - The MS-CHAP response packet is in a format designed for compatibility with Microsoft’s Windows networking products.
        - The MS-CHAP format does not require the authenticator to store a clear-text or reversibly encrypted password.
        - MS-CHAP provides authenticator-controlled authentication retry and password-changing mechanisms. These retry and password-changing mechanisms are compatible with the mechanisms used in Windows networks.
        - MS-CHAP defines a set of reason-for-failure codes that are returned in the failure packet’s message field if the authentication fails. These are codes that Windows software is able to read and interpret, thus providing the user with the reason for the failed authentication.
    - ### 6.2.2.2 PAP
    - Password Authentication Protocol (PAP) is the most basic form of authentication. With PAP, a user’s name and password are transmitted over a network and compared to a table of name-password pairs. Typically, the passwords stored in the table are encrypted. However, the transmissions of the passwords are in clear text, unencrypted, the main weakness with PAP. The basic authentication feature built into the HTTP protocol uses PAP. This method is no longer used and is only presented for historical purposes.
    - ### 6.2.2.3 SPAP
    - Shiva Password Authentication Protocol (SPAP) is a proprietary version of PAP. Most experts consider SPAP somewhat more secure than PAP because the username and password are both encrypted when they are sent, unlike with PAP.
    - Because SPAP encrypts passwords, someone capturing authentication packets will not be able to read the SPAP password. However, SPAP is still susceptible to playback attacks (that is, a person records the exchange and plays the message back to gain fraudulent access). Playback attacks are possible because SPAP always uses the same reversible encryption method to send the passwords over the wire.
    - ### 6.2.2.4 Kerberos
    - Kerberos is one of the most well-known network authentication protocols. It was developed at MIT and it’s named from the mythical three-headed dog that guarded the gates to Hades.
    - Kerberos works by sending messages back and forth between the client and the server. The actual password (or even a hash of the password) is never sent. That makes it impossible for someone to intercept it. What happens instead is that the username is sent. The server then looks up the stored hash of that password, and uses that as an encryption key to encrypt data and send it back to the client. The client then takes the password the user entered, and uses that as a key to decrypt the data. If the user entered the wrong password, then it will never get decrypted. This is a clever way to verify the password without ever being transmitted. Authentication happens with UDP (User Datagram Protocol) on port 88.
    - After the user’s username is sent to the authentication service (AS), that AS will use the hash of the user password that is stored as a secret key to encrypt the following two messages that get sent to the client:
        - Message A: Contains Client/TGS (Ticket Granting Service) session key encrypted with secret key of client
        - Message B: Contains TGT (Ticket Granting Ticket) that includes client ID, client network address, and validity period
    - Remember, both of these messages are encrypted using the key the AS generated.
    - Then the user attempts to decrypt message A with the secret key generated by the client hashing the user’s entered password. If that entered password does not match the password the AS found in the database, then the hashes won’t match, and the decryption won’t work. If it does work, then message A contains the Client/TGS session key that can be used for communication with the TGS. Message B is encrypted with the TGS secret key and cannot be decrypted by the client.
    - Now the user is authenticated into the system. However, when the user actually requests a service, some more message communication is required. When requesting services, the client sends the following messages to the TGS:
        - Message C: Composed of the TGT from message B and the ID of the requested service
        - Message D: Authenticator (which is composed of the client ID and the timestamp), encrypted using the Client/TGS session key
    - Upon receiving messages C and D, the TGS retrieves message B out of message C. It decrypts message B using the TGS secret key. This gives it the “Client/TGS session key”. Using this key, the TGS decrypts message D (Authenticator) and sends the following two messages to the client:
        - Message E: Client-to-server ticket (which includes the client ID, client network address, validity period, and client/server session key) encrypted using the service’s secret key
        - Message F: Client/server session key encrypted with the Client/TGS session key
    - Upon receiving messages E and F from TGS, the client has enough information to authenticate itself to the Service Server (SS). The client connects to the SS and sends the following two messages:
        - Message E: From the previous step (the client-to-server ticket, encrypted using service’s secret key)
        - Message G: A new Authenticator, which includes the client ID and timestamp and is encrypted using the client/server session key
    - The SS decrypts the ticket (message E) using its own secret key to retrieve the client/server session key. Using the session key, the SS decrypts the Authenticator and sends the following message to the client to confirm its identity and willingness to serve the client:
        - Message H: The timestamp found in client’s Authenticator
    - The client decrypts the confirmation (message H) using the client/server session key and checks whether the timestamp is correct. If so, then the client can trust the server and can start issuing service requests to the server. The server provides the requested services to the client.
    - Below are some Kerberos terms to know:
        - Principal: A server or client that Kerberos can assign tickets to.
        - Authentication Service (AS): Service that authorizes the principal and connects them to the Ticket Granting Server. Note some books/sources say server rather than service.
        - Ticket Granting Service (TGS): Provides tickets.
        - Key Distribution Centre (KDC): A server that provides the initial ticket and handles TGS requests. Often it runs both AS and TGS services.
    - Realm: A boundary within an organisation. Each realm has its own AS and TGS.
        - Remote Ticket Granting Server (RTGS): A TGS in a remote realm.
        - Ticket Granting Ticket (TGT): The ticket that is granted during the authentication process.
        - Ticket: Used to authenticate to the server. Contains identity of client, session key, timestamp, and checksum. Encrypted with server’s key.
        - Session key: Temporary encryption key.
        - Authenticator: Proves session key was recently created. Often expires within 5 minutes.
    - ## 6.3 IPSec
    - Internet Protocol Security (IPSec) is a technology used to create virtual private networks. IPSec is used in addition to the IP protocol that adds security and privacy to TCP/IP communication. IPSec is incorporated with Microsoft operating systems as well as many other operating systems.
    - For example, the security settings in the Internet Connection Firewall that ships with Windows XP and later versions enables users to turn on IPSec for transmissions. IPSec is a set of protocols developed by the IETF (Internet Engineering Task Force; [www.ietf.org](http://www.ietf.org/)) to support secure exchange of packets. IPSec has been deployed widely to implement VPNs.
    - IPSec has two encryption modes: transport and tunnel. The transport mode works by encrypting the data in each packet but leaves the header unencrypted. This means that the source and destination addresses, as well as other header information, are not encrypted. The tunnel mode encrypts both the header and the data.
    - This is more secure than transport mode but can work more slowly. At the receiving end, an IPSec-compliant device decrypts each packet. For IPSec to work, the sending and receiving devices must share a key, an indication that IPSec is a single-key encryption technology. IPSec also offers two other protocols beyond the two modes already described:
        - Authentication Header (AH): The AH protocol provides a mechanism for authentication only. AH provides data integrity, data origin authentication, and an optional replay protection service. Data integrity is ensured by using a message digest that is generated by an algorithm such as HMAC-MD5 or HMAC-SHA. Data origin authentication is ensured by using a shared secret key to create the message digest.
        - Encapsulating Security Payload (ESP): The ESP protocol provides data confidentiality (encryption) and authentication (data integrity, data origin authentication, and replay protection). ESP can be used with confidentiality only, authentication only, or both confidentiality and authentication.
    - Either protocol can be used alone to protect an IP packet, or both protocols can be applied together to the same IP packet.
    - IPSec can also work in two modes. Those modes are transport mode and tunnel mode. Transport mode is the mode where IPSec encrypts the data, but not the packet header. Tunnelling mode does encrypt the header as well as the packet data.
    - There are other protocols involved in making IPSec work. IKE, or Internet Key Exchange, is used in setting up security associations in IPSec. A security association is formed by the two endpoints of the VPN tunnel, once they decide how they are going to encrypt and authenticate. For example, will they use AES for encrypting packets, what protocol will be used for key exchange, and what protocol will be used for authentication?
    - All of these issues are negotiated between the two endpoints, and the decisions are stored in a security association (SA). This is accomplished via the IKE protocol. Internet Key Exchange (IKE and IKEv2) is used to set up an SA by handling negotiation of protocols and algorithms and to generate the encryption and authentication keys to be used.
    - The Internet Security Association and Key Management Protocol (ISAKMP) provides a framework for authentication and key exchange. Once the IKE protocol sets up the SA, then it is time to actually perform the authentication and key exchange.
    - The first exchange between VPN endpoints establishes the basic security policy; the initiator proposes the encryption and authentication algorithms it is willing to use. The responder chooses the appropriate proposal and sends it to the initiator. The next exchange passes Diffie-Hellman public keys and other data.
    - Those Diffie-Hellman public keys will be used to encrypt the data being sent between the two endpoints. The third exchange authenticates the ISAKMP session. This process is called main mode. Once the IKE SA is established, IPSec negotiation (Quick Mode) begins.
    - Quick Mode IPSec negotiation, or Quick Mode, is similar to an Aggressive Mode IKE negotiation, except negotiation must be protected within an IKE SA. Quick Mode negotiates the SA for the data encryption and manages the key exchange for that IPSec SA.
    - In other words, Quick Mode uses the Diffie-Hellman keys exchanged in main mode, to continue exchanging symmetric keys that will be used for actual encryption in the VPN.
    - Aggressive Mode squeezes the IKE SA negotiation into three packets, with all data required for the SA passed by the initiator. The responder sends the proposal, key material, and ID, and authenticates the session in the next packet. The initiator replies by authenticating the session. Negotiation is quicker, and the initiator and responder ID pass in the clear.
    - ## 6.4 SSL/TLS
    - A new type of firewall uses SSL (Secure Sockets Layer) or TLS (Transport Layer Security) to provide VPN access through a web portal. Essentially, TLS and SSL are the protocols used to secure websites. If you see a website beginning with HTTPS, then traffic to and from that website is encrypted using SSL or TLS. Today, we almost always mean TLS when we say SSL. It is just that many people became comfortable to saying SSL, and the phrase stuck. This should be obvious from the brief history of SSL/TLS presented here:
        - Unreleased SSL v1 (Netscape).
        - Version 2 released in 1995 but had many flaws.
        - Version 3 released in 1996 (RFC 6101).
        - Standard TLS 1.0, RFC 2246, released in 1999.
        - TLS 1.1 defined in RFC 4346 in April 2006.
        - TLS 1.2 defined in RFC 5246 in August 2008. It is based on the earlier TLS 1.1 spec.
        - As of July 2017, TLS 1.3 is a draft and details have not been fixed yet.
    - In some VPN solutions the user logs in to a website, one that is secured with SSL or TLS, and is then given access to a virtual private network. However, visiting a website that uses SSL or TLS does not mean you are on a VPN. As a general rule most websites, such as banking websites, give you access only to a very limited set of data, such as your account balances. A VPN gives you access to the network, the same or similar access to what you would have if you were physically on that network.
    - Whether you are using SSL to connect to an e-commerce website or to establish a VPN, the SSL handshake process is needed to establish the secure/encrypted connection:
        - The client sends the server the client’s SSL version number, cipher settings, session-specific data, and other information that the server needs to communicate with the client using SSL.
        - The server sends the client the server’s SSL version number, cipher settings, session-specific data, and other information that the client needs to communicate with the server over SSL. The server also sends its own certificate, and if the client is requesting a server resource that requires client authentication, the server requests the client’s certificate.
        - The client uses the information sent by the server to authenticate the server—e.g., in the case of a web browser connecting to a web server, the browser checks whether the received certificate’s subject name actually matches the name of the server being contacted, whether the issuer of the certificate is a trusted certificate authority, whether the certificate has expired, and, ideally, whether the certificate has been revoked. If the server cannot be authenticated, the user is warned of the problem and informed that an encrypted and authenticated connection cannot be established. If the server can be successfully authenticated, the client proceeds to the next step.
        - Using all data generated in the handshake thus far, the client (with the cooperation of the server, depending on the cipher in use) creates the pre-master secret for the session, encrypts it with the server’s public key (obtained from the server’s certificate, sent in step 2), and then sends the encrypted pre-master secret to the server.
        - If the server has requested client authentication (an optional step in the handshake), the client also signs another piece of data that is unique to this handshake and known by both the client and server. In this case, the client sends both the signed data and the client’s own certificate to the server along with the encrypted pre-master secret.
        - If the server has requested client authentication, the server attempts to authenticate the client. If the client cannot be authenticated, the session ends. If the client can be successfully authenticated, the server uses its private key to decrypt the pre-master secret, and then performs a series of steps (which the client also performs, starting from the same pre-master secret) to generate the master secret.
        - Both the client and the server use the master secret to generate the session keys, which are symmetric keys used to encrypt and decrypt information exchanged during the SSL session and to verify its integrity (that is, to detect any changes in the data between the time it was sent and the time it is received over the SSL connection).
        - The client sends a message to the server informing it that future messages from the client will be encrypted with the session key. It then sends a separate (encrypted) message indicating that the client portion of the handshake is finished.
        - The server sends a message to the client informing it that future messages from the server will be encrypted with the session key. It then sends a separate (encrypted) message indicating that the server portion of the handshake is finished.
    - ## 6.5 VPN Solutions
    - Regardless of which protocols you use for VPN, you must implement your choice in some software/hardware configuration. Many operating systems have built-in VPN server and client connections. These are generally fine for small office or home situations. However, they might not be adequate for larger scale operations in which multiple users connect via VPN. For those situations, a dedicated VPN solution might be necessary.
    - ### 6.5.1 Cisco Solutions
    - Cisco offers VPN solutions, including a module that can be added to many of their switches and routers to implement VPN services. It also offers client-side hardware that is designed to provide an easy-to-implement yet secure client side for the VPN.
    - The main advantage of this solution is that it incorporates seamlessly with other Cisco products. Administrators using a Cisco firewall or Cisco router might find this solution to be preferable. However, this solution might not be right for those not using other Cisco products and those who do not have knowledge of Cisco systems. However, many attractive specifications for this product include the following:
        - It can use 3DES encryption (an improved version of DES). But AES is preferred and strongly recommended.
        - It can handle packets larger than 500 bytes.
        - It can create up to 60 new virtual tunnels per second, a good feature if a lot of users might be logging on or off.
    - ### 6.5.2 Openswan
    - The Openswan product ([www.openswan.org/](http://www.openswan.org/)) is an open source VPN solution available for Linux operating systems. As an open source product, one of its biggest advantages is that it is free. Openswan uses IPSec, making it a highly secure VPN solution.
    - Openswan supports either remote users logging on via VPN, or site-to-site connections. It also supports wireless connections. However, it does not support NAT (network address translation, the new alternative to proxy servers).
- **Module 7 : Operating System Hardening**
    - ## 7.1 Configuring Windows
    - Properly configuring Windows (Windows 7, 8, 10 and Server Editions) consists of many facets. You must disable unnecessary services, properly configure the registry, enable the firewall, properly configure the browser, and more.
    - Previously we have discussed the firewall concepts and the processes of both stateful packet inspection and stateless packet inspection, and a later section of this chapter discusses browser security. For now, let’s go over the other important factors in Windows security configuration.
    - ### 7.1.1 Accounts, Users, Groups and Passwords
    - Any Windows system comes with certain default user accounts and groups. These can frequently be a starting point for intruders who want to crack passwords for those accounts and gain entrance onto a server or network. Simply renaming or disabling some of these default accounts can improve your security.
    - Note: Windows has an affinity to move things in the control panel with each version. Your version (7, 8, 8.1, 10, etc.) might have things in a different location. If you have not already done so, take some time to familiarize yourself with the location of utilities in your version of Windows.
    - In Windows 7 or Windows 8, you find user accounts by going to Start, Settings, Control Panel, Users and Groups. In Windows 10 go to Start, Settings, and Accounts.
    - ### 7.1.1.1 Administrator Accounts
    - The default administrator account has administrative privileges, and hackers frequently seek to obtain logon information for an administrator account. Guessing a logon is a two-step process of first identifying the username, and then the password. Default accounts allow the hacker to bypass the first half of this process. Administrators should disable this account.
    - Having an account with administrative privileges is necessary for maintaining your server. The next step is adding a new account, one with an innocuous name and giving that account administrative privileges. Doing so makes a hacker’s task more difficult, as he must first discover what account actually has administrative privileges before he can even attempt to compromise that account.
    - Some experts suggest simply renaming the administrator account, or using an administrator account that has a username that indicates its purpose. That is not a recommendation for the following reasons:
        - The whole point is that a hacker should not be able to identify which username has administrative privileges.
        - Simply renaming the administrator account to a different name, but one that still indicates its administrative rights will not help this situation.
    - ### 7.1.1.2 Other Accounts
    - The administrator account is the one most often targeted by hackers, but Windows also includes other default user accounts. Applying an equally demanding behaviour to all default accounts is a good idea. Any default account can be a gateway for a hacker to compromise a system. A few accounts that you should pay particular attention are:
        - IUSR_Machine name: When you are running IIS, a default user account is created for IIS. Its name is IUSR_ and the name of your machine. This is a common account for a hacker to attempt to compromise. Altering this one in the manner suggested for the administrator account is advisable.
        - [ASP.NET](http://asp.net/): If your machine is running [ASP.NET](http://asp.net/), a default account is created for web applications. A hacker that is familiar with .NET could target this account.
        - Database accounts: Many relational database management systems, such as SQL Server, create default user accounts. An intruder, particularly one who wants to get at your data, could target these accounts.
    - When adding any new account, always give the new account’s user or group the least number and type of privileges needed to perform their job, even accounts for IT staff members. Below are some examples:
        - A PC technician does not need administrative rights on the database server. Even though belongs to the IT department, does not need access to everything in that department.
        - Managers may use applications that reside on a web server, but they certainly should not have rights on that server.
        - Just because a programmer develops applications that run on a server does not mean that should have full rights on that server.
    - These are just a few examples of things to consider when setting up user rights.
    - Remember: Always give the least access necessary for that person to do her job. This concept is often called least privileges, and is a cornerstone of security.
    - ### 7.1.2 Setting Security Policies
    - Setting appropriate security policies is the next step in hardening a Windows server. This does not refer to written policies an organisation might have regarding security standards and procedures. In this case, the term security policies refers to the individual machines’ policies.
    - The first matter of concern is setting secure password policies. The default settings for Windows passwords are not secure. The table below shows the default password policies. Maximum password age refers to how long a password is effective before the user is forced to change that password.
    - Enforce password history refers to how many previous passwords the system remembers, thus preventing the user from reusing passwords. Minimum password length defines the minimum number of characters allowed in a password.
    - Password complexity means that the user must use a password that combines numbers, letters, and other characters. These are the default security settings for all Windows versions from Windows NT 4.0 forward. If your system is protected within a business environment, the settings at Local Security will be greyed out, indicating you do not have permissions to make changes.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/eef98fb4-f2dd-4cec-a017-253a15f8e84c/Annotation_2020-05-27_093003.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/eef98fb4-f2dd-4cec-a017-253a15f8e84c/Annotation_2020-05-27_093003.png)
    - The default password policies are not secure enough, but what policies should you use instead? Different experts answer that question differently. The table below shows the recommendations of Microsoft and the National Security Agency.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3d0a8589-6e08-441f-a7ff-d5c90125194b/Annotation_2020-05-27_093053.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3d0a8589-6e08-441f-a7ff-d5c90125194b/Annotation_2020-05-27_093053.png)
    - Developing appropriate password policies depends largely on the requirements of your network environment. If your network stores and processes highly sensitive data and is an attractive target to hackers, you must always skew your policies and settings toward greater security. However, bear in mind that if security measures are too complex, your users will find complying difficult. For example, very long, complex passwords (such as $%Tbx38T@_FgR$$) make your network quite secure, but such passwords are virtually impossible for users to remember.
    - ### 7.1.3 Account Lockout Policies
    - When you open the Local Security Settings dialog, your options are not limited to setting password policies. You can also set account lockout policies. These policies determine how many times a user can attempt to log in before being locked out, and for how long to lock them out. The default Windows settings are shown in the table below.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/73d3d7de-be77-47f6-bd3a-9b6b79f64c1b/Annotation_2020-05-27_093218.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/73d3d7de-be77-47f6-bd3a-9b6b79f64c1b/Annotation_2020-05-27_093218.png)
    - These default policies are not secure. Essentially, they allow for an infinite number of log-in attempts, making the use of password crackers very easy and virtually guaranteeing that someone will eventually crack one or more passwords and gain access to your system. The table below provides the recommendations from Microsoft and National Security Agency.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/23e15060-15d5-4464-81cb-6143f97f248a/Annotation_2020-05-27_093259.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/23e15060-15d5-4464-81cb-6143f97f248a/Annotation_2020-05-27_093259.png)
    - ### 7.1.4 Registry Settings
    - The Windows Registry is a database used to store settings and options for Microsoft Windows operating systems. This database contains critical information and settings for all the hardware, software, users, and preferences on a particular computer. Whenever users are added, software is installed or any other change is made to the system (including security policies), that information is stored in the registry.
    - Secure registry settings are critical to securing a network. Unfortunately, that area is often overlooked. One thing to keep in mind is that if you do not know what you are doing in the registry, you can cause serious problems. So, if you are not very comfortable with the registry, do not touch it. Even if you are comfortable making registry changes, always back up the registry before any change.
    - ### 7.1.5 Registry Basics
    - The physical files that make up the registry are stored differently depending on which version of Windows you are using. Older versions of Windows (that is, Windows 95 and 98) kept the registry in two hidden files in your Windows directory, called USER.DAT and SYSTEM.DAT. In all versions of Windows since XP, the physical files that make up the registry are stored in %SystemRoot%\System32\Config. Since Windows 8, the file has been named ntuser.dat.
    - Regardless of the version of Windows you are using, you cannot edit the registry directly by opening and editing these files. Instead you must use a tool, regedit.exe, to make any changes. There are newer tools like regedit32. However, many users find that the older regedit has a more user friendly “find” option for searching the registry. Either one will work.
    - Although the registry is referred to as a “database,” it does not actually have a relational database structure (like a table in MS SQL Server or Oracle). The registry has a hierarchical structure similar to the directory structure on the hard disk. In fact, when you use regedit, you will note it is organized like Windows Explorer. To view the registry, go to Start, Run, and type regedit. You should see the Registry Editor dialog box as shown below. Some of the folders in your dialog box might be expanded.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f6ca6efb-ac52-4bb7-b2fe-8bbf98dc8f28/Annotation_2020-05-27_093555.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f6ca6efb-ac52-4bb7-b2fe-8bbf98dc8f28/Annotation_2020-05-27_093555.png)
    - Your Registry Editor dialog box will likely have the same five main folders as the one shown above in the screenshot. Each of these main branches of the registry is briefly described in the following list. These five main folders are the core registry folders. A system might have additions, but these are the primary folders containing information necessary for your system to run.
        - **HKEY_CLASSES_ROOT:** This branch contains all of your file association types, OLE information, and shortcut data.
        - **HKEY_CURRENT_USER:** This branch links to the section of HKEY_USERS appropriate for the user currently logged on to the PC.
        - **HKEY_LOCAL_MACHINE:** This branch contains computer-specific information about the type of hardware, software, and other preferences on a given PC.
        - **HKEY_USERS:** This branch contains individual preferences for each user of the computer.
        - **HKEY_CURRENT_CONFIG:** This branch links to the section of HKEY_LOCAL_MACHINE appropriate for the current hardware configuration.
    - If you expand a branch, you will see its subfolders. Many of these have, in turn, more subfolders, possibly as many as four or more before you get to a specific entry. A specific entry in the Windows Registry is referred to as a key. A key is an entry that contains settings for some particular aspect of your system. If you alter the registry, you are actually changing the settings of particular keys.
    - ### 7.1.6 Restrict Null Session Access
    - Null sessions are a significant weakness that can be exploited through the various shares that are on the computer. A null session is Windows’ way of designating anonymous connections. Any time you allow anonymous connections to any server, you are inviting significant security risks. Modify null session access to shares on the computer by adding **RestrictNullSessAccess**, a registry value that toggles null session shares on or off to determine whether the Server service restricts access to clients logged on to the system account without username and password authentication. Setting the value to **“1”** restricts null session access for unauthenticated users to all server pipes and shares except those listed in the **NullSessionPipes** and **NullSessionShares** entries.
    - **Key Path:** HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer
    - **Action:** Ensure that it is set to: Value = 1
    - ### 7.1.7 Restrict Null Session Access Over Named Pipes
    - The null session access over named pipes registry setting should be changed for much the same reason as the preceding null session registry setting. Restricting such access helps to prevent unauthorised access over the network. To restrict null session access over named pipes and shared directories, edit the registry and delete the values, as shown below.
    - **Key Path:** HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer
    - **Action:** Delete all values
    - ### 7.1.8 Restrict Anonymous Access
    - The anonymous access registry setting allows anonymous users to list domain user names and enumerate share names. It should be shut off. The possible settings for this key are:
        - 0—Allow anonymous users
        - 1—Restrict anonymous users
        - 2—Allow users with explicit anonymous permissions
    - **Key Path:** HKLM\SYSTEM\CurrentControlSet\Control\Lsa
    - **Action:** Set Value = 2
    - ### 7.1.9 Remote Access to the Registry
    - Remote access to the registry is another potential opening for hackers. The Windows XP registry editing tools support remote access by default, but only administrators should have remote access to the registry. Fortunately, later versions of Windows turned this off by default. In fact, some experts advise that there should be no remote access to the registry for any person. This point is certainly debatable. If your administrators frequently need to remotely alter registry settings, then completely blocking remote access to them will cause a reduction in productivity of those administrators. However, completely blocking remote access to the registry is certainly more secure. To restrict network access to the registry:
    - **1**. Add the following key to the registry: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg.
    - **2.** Select winreg, click the Security menu, and then click Permissions.
    - **3.** Set the Administrator’s permission to Full Control, make sure no other users or groups are listed, and then click OK.
    - Recommended Value = 0
    - ### 7.1.10 Services
    - A service is a program that runs without direct intervention by the computer user. In Unix/Linux environments, these are referred to as daemons. Many items on your computer are run as services. Internet Information Services, FTP Service, and many system services are good examples. Any running service is a potential starting point for a hacker. Obviously, you must have some services running for your computer to perform its required functions. However, there are services your machine does not use. If you are not using a service, it should be shut down.
    - ### 7.1.11 Encrypting File System
    - Beginning with Windows 2000, the Windows operating system has offered the Encrypting File System (EFS), which is based on public key encryption and takes advantage of the CryptoAPI architecture in Windows 2000.
    - This still exists in Windows 7, 8, and 10; however, with the later versions of Windows, EFS is only available in the upper-end editions of Windows such as Windows Professional. With this system, each file is encrypted using a randomly generated file encryption key, which is independent of a user’s public/private key pair; this method makes the encryption resistant to many forms of cryptoanalysis-based attacks. For our purposes the exact details of how EFS encryption works are not as important as the practical aspects of using it.
    - ### 7.1.12 Security Templates
    - We have been discussing a number of ways for making a Windows system more secure, but exploring services, password settings, registry keys, and other tools can be a daunting task for the administrator who is new to security. Applying such settings to a host of machines can be a tedious task for even the most experienced administrator.
    - The best way to simplify this aspect of operating system hardening is to use security templates. A security template contains hundreds of possible settings that can control a single or multiple computers. Security templates can control areas such as user rights, permissions, and password policies, and they enable administrators to deploy these settings centrally by means of Group Policy Objects (GPOs).
    - Security templates can be customized to include almost any security setting on a target computer. A number of security templates are built into Windows. These templates are categorized for domain controllers, servers, and workstations. These security templates have default settings designed by Microsoft. All of these templates are located in the C:\Windows\Security\Templates folder. The following is a partial list of the security templates that you will find in this folder:
        - **Hisecdc.inf:** This template is designed to increase the security and communications with domain controllers.
        - **Hisecws.inf:** This template is designed to increase security and communications for client computers and member servers.
        - **Securedc.inf:** This template is designed to increase the security and communications with domain controllers, but not to the level of the High Security DC security template.
        - **Securews.inf:** This template is designed to increase security and communications for client computers and member servers.
        - **Setup security.inf:** This template is designed to reapply the default security settings of a freshly installed computer. It can also be used to return a system that has been misconfigured to the default configuration.
    - ## 7.2 Guided Exercise: Password Policies
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bb853b8b-9dc9-4594-8b61-8d7206fee37f/Annotation_2020-05-27_102517.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bb853b8b-9dc9-4594-8b61-8d7206fee37f/Annotation_2020-05-27_102517.png)
    - In this exercise you will create a new user account and set its password policies.
    - Login to Windows Server, click the Start button, write gpedit.msc and press Enter.
    - The Local Group Policy Editor window will open. Below Computer Configuration exand the folders Windows Setiings -> Account Policies.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d2b833ee-9e0c-422f-8c88-9dd7534aac3c/Annotation_2020-05-27_102613.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d2b833ee-9e0c-422f-8c88-9dd7534aac3c/Annotation_2020-05-27_102613.png)
    - Click on the Password Policy and then right click on the Minimu password length and select properties.
    - On the Minimum password length Properties window change the value 0 to 8, click Apply and then OK. Then close the Local Group Policy Editor.
    - ## 7.3 Configuring Linux
    - An in-depth review of Linux security would be a lengthy task indeed. One reason is the diversity of Linux setups. Users could be using Debian, Red Hat, Ubuntu, or other Linux distributions. Some might be working from the shell, while others work from some graphical user interfaces such as KDE or GNOME. Fortunately, many of the same security concepts that apply to Windows can be applied to Linux. The only differences lie in the implementation, as explained in the following list:
        - User and account policies should be set up the same in Linux as they are in Windows, with only a few minor differences. These differences are more a matter of using different names in Linux than in Windows. For example, Linux does not have an administrator account; it has a root account.
        - All services (called daemons in Linux) not in use should be shut down.
        - The browser must be configured securely.
        - You must routinely patch the operating system.
    - In addition to some tactics that are common to Windows and Linux, a few approaches are different for the two operating systems:
        - No application should run as the root user unless absolutely necessary. Remember that the root user is equivalent to the administrator account in Windows. Also, remember that all applications in Linux run as if started by a particular user, and therefore having an application run as root user would give it all administrative privileges.
        - The root password must be complex and must be changed frequently. This is the same as with Windows administrator passwords.
        - Disable all console-equivalent access for regular users. This means blocking access to programs such as shutdown, reboot, and halt for regular users on your server.
        - Hide your system information. When you log in to a Linux box, it displays by default the Linux distribution name, version, kernel version, and the name of the server. This information can be a starting point for intruders. You should just prompt users with a “Login:” prompt.
    - ### 7.3.1 Disable Services
    - Every service (daemon) that runs is executing code on the server. If there is a vulnerability within that code, it is a potential weakness that can be leveraged by an attacker; it is also consuming resources in the form of RAM and CPU cycles.
    - Many operating systems ship with a number of services enabled by default, many of which you may not use. These services should be disabled to reduce the attack surface on your servers. Of course you should not just start disabling services with reckless abandon—before disabling a service, it is prudent to ascertain exactly what it does and determine if you require it.
    - There are a number of ways to ascertain which services are running on a UNIX system, the easiest of which is to use the “ps” command to list running services. Exact argument syntax can vary between versions, but the “ps ax” syntax works on most systems and will list all currently running processes. For minor variations in syntax on your operating system, check the manual page for “ps” using the command “man ps”.
    - Services should be disabled in start-up scripts (“rc” or “init”, depending on operating system) unless your system uses “systemd”, in which case you can refer to the following discussion on “systemd”. Using the “kill” command will merely stop the currently running service, which will start once more during a reboot. On Linux the commands are typically one of: “rc-update”, “update-rc.d”, or “service”. On BSD-based systems, you typically edit the file /etc/rc.conf.
    - For example, on several flavours of Linux the service command can be used to stop the sshd service: service sshd stop
    - To start sshd (one time): service start sshd
    - And to disable it from starting after a reboot:update-rc.d -f sshd remove
    - Some Linux distributions have moved toward using “systemd” as opposed to SysV startup scripts to manage services. “systemd” can be used to perform other administrative functions with regards to services, such as reloading configuration and displaying dependency information.
    - To stop sshd (one time): **systemctl stop sshd**
    - To enable sshd upon every reboot: **systemctl enable sshd**
    - Older Unix/Linux operating systems may use inetd or xinetd to manage services rather than rc or init scripts. (x)inetd is used to preserve system resources by being almost the only service running and starting other services on demand, rather than leaving them all running all of the time. If this is the case, services can be disabled by editing the inetd.conf or xinetd.conf files, typically located in the /etc/ directory.
    - ### 7.3.2 File Permissions
    - Most Unix/Linux file systems have a concept of permissions—that is, files which users and groups can read, write, or execute. Most also have the SETUID (set user ID upon execution) permission, which allows a nonroot user to execute a file with the permission of the owning user, typically root. This is because the normal operation of that command, even to a nonroot user, requires root privileges, such as su or sudo.
    - Typically, an operating system will set adequate file permissions on the system files during installation. However, as you create files and directories, permissions will be created according to your umask settings. As a general rule, the umask on a system should only be made more restrictive than the default. Cases where a less restrictive umask is required should be infrequent enough that chmod can be used to resolve the issue. Your umask settings can be viewed and edited using the umask command. See man umask1 for further detail on this topic.
    - Incorrect file permissions can leave files readable by users other than whom it is intended for. Many people wrongly believe that because a user has to be authenticated to log in to a host, leaving world or group readable files on disk is not a problem. However, they do not consider that services also run using their own user accounts.
    - Take, for example, a system running a web server such as Apache, nginx, or lighttpd; these web servers typically run under a user ID of their own such as “www-data.” If files you create are readable by “www-data”, then, if configured to do so, accidentally or otherwise, the web server has permission to read that file and to potentially serve it to a browser. By restricting file system-level access, we can prevent this from happening—even if the web server is configured to do so, as it will no longer have permission to open the file.
    - As an example, the file test can be read and written to by the owner _www, it can be read and executed by the group staff, and can be read by anybody. This is denoted by the rw-, r-x, and r-- permissions in the directory listing:
    - $ ls -al test
    - -rw-r-xr-- 1 _wwwstaff 1228 16 Apr 05:22 test
    - In the Unix/Linux file system listing, there are 10 hyphens (-), the last 9 of which correspond to read, write, and execute permissions for owner, group and other (everyone). A hyphen indicates the permission is not set; a letter indicates that it is set. Other special characters appear less often; for example, an S signifies that the SETUID flag has been set.
    - If we wish to ensure that others can no longer see this file, then we can modify the permissions. We can alter them using the chmod command (o= sets the other permissions to nothing):
    - $ sudo chmod o= test
    - $ ls -la test
    - -rw-r-x--- 1 _wwwstaff 1228 16 Apr 05:22 test
    - ### 7.3.3 File Integrity
    - File Integrity Management tools monitor key files on the file system and alert the administrator in the event that they change.These tools can be used to ensure that key system files are not tampered with, as in the case with a rootkit, and that files are not added to directories without the administrator’s permission, or configuration files modified, as can be the case with backdoors in web applications, for example.
    - There are both commercial tools and free/open source tools available through your preferred package management tool. Examples of open source tools that perform file integrity monitoring include Samhain and OSSEC. If you are looking to spend money to obtain extra features like providing integration with your existing management systems, there are also a number of commercial tools available.
    - Alternatively, if you cannot for whatever reason install file integrity monitoring tools, many configuration management tools can be configured to report on modified configuration files on the file system as part of their normal operation. This is not their primary function and does not offer the same level of coverage, and so is not as robust as a dedicated tool. However, if you are in a situation where you cannot deploy security tools but do have configuration management in place, this may be of some use.
    - ### 7.3.4 Separate Disk Partitions
    - Disk partitions within Unix/Linux can be used not only to distribute the file system across several physical or logical partitions, but also to restrict certain types of action depending on which partition they are taking place on. Options can be placed on each mount point in /etc/fstab.
    - There are some minor differences between different flavours of Unix/Linux with regards to the options, and so consulting the system manual page—using man mount—before using options is recommended.
    - Some of the most useful and common mount point options, from a security perspective, are:
    - **nodev**
    - Do not interpret any special dev devices. If no special dev devices are expected, this option should be used. Typically only the /dev/ mount point would contain special dev devices.
    - **nosuid**
    - Do not allow setuid execution. Certain core system functions, such as su and sudo will require setuid execution, thus this option should be used carefully. Attackers can use setuid binaries as a method of backdooring a system to quickly obtain root privileges from a standard user account. Setuid execution is probably not required outside of the system-installed bin and sbin directories. You can check for the location of setuid binaries using the following command:
    - $ sudo find / -perm -4000
    - Binaries that are specifically setuid root, as opposed to any setuid binary, can be located using the following variant:
    - $ sudo find / -user root -perm -4000
    - **ro**
    - Mount the file system read-only. If data does not need to be written or updated, this option may be used to prevent modification. This removes the ability for an attacker to modify files stored in this location such as config files and static website content.
    - **noexec**
    - Prevents execution, of any type, from that particular mount point. This can be set on mount points used exclusively for data and document storage. It prevents an attacker from using this as a location to execute tools he may load onto a system and it can defeat certain classes of exploit.
    - ### 7.3.5 Chroot
    - chroot alters the apparent root directory of a running process and any children processes. The most important aspect of this is that the process inside the chroot jail cannot access files outside of its new apparent root directory, which is particularly useful in the case of ensuring that a poorly configured or exploited service cannot access anything more than it needs to.
    - There are two ways in which chroot can be initiated:
    - The process in question can use the chroot system call and chroot itself voluntarily. Typically, these processes will contain chroot options within their configuration files, most notably allowing the user to set the new apparent root directory.
    - The chroot wrapper can be used on the command line when executing the command. Typically this would look something like:
    - sudo chroot /chroot/dir/ /chroot/dir/bin/binary -args
    - For details of specific chroot syntax for your flavor of Unix, consult man chroot.3
    - It should be noted, however, that there is a common misconception that chroot offers some security features that it simply does not. Chroot jails are not impossible to break out of, especially if the process within the chroot jail is running with root privileges. Typically processes that are specifically designed to use chroot will drop their root privileges as soon as possible so as to mitigate this risk. Additionally, chroot does not offer the process any protection from privileged users outside of the chroot on the same system.
    - Neither of these are reasons to abandon chroot, but should be considered when designing use cases as it is not an impenetrable fortress, but more a method of further restricting file system access.
    - ## 7.4 Guided Exercise: Linux File Permissions
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/29fdc814-1e2f-4044-83c4-c52d66040f37/Annotation_2020-05-27_104147.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/29fdc814-1e2f-4044-83c4-c52d66040f37/Annotation_2020-05-27_104147.png)
    - Login to Ubuntu Server with the following credentials:
    - Username: user
    - Password: Pa$$w0rd
    - Once logged in click on the terminal icon (last icon) on the left side menu.Create a directory in /home called ateam with the command sudo mkdir /home/ateam. When prompted enter the user password and the press the enter button
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9d1907d-fc41-4aaa-b243-530b2f59ab84/Annotation_2020-05-27_104231.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9d1907d-fc41-4aaa-b243-530b2f59ab84/Annotation_2020-05-27_104231.png)
    - Create a user called ateam with the command sudo useradd ateam.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9b5b858f-79f4-4b40-9f2d-c6a9c9143116/Annotation_2020-05-27_104259.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9b5b858f-79f4-4b40-9f2d-c6a9c9143116/Annotation_2020-05-27_104259.png)
    - Change the user ownership of the ateam directory to the user ateam with the command sudo chown ateam /home/ateam
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f7ca6ef2-5d3e-4677-92f5-274330559146/Annotation_2020-05-31_080631.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f7ca6ef2-5d3e-4677-92f5-274330559146/Annotation_2020-05-31_080631.png)
    - Create a group called admins with the command sudo groupadd admins
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c626f430-3ab4-4fc7-afa5-6ffa7b82ed68/Annotation_2020-05-31_080707.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c626f430-3ab4-4fc7-afa5-6ffa7b82ed68/Annotation_2020-05-31_080707.png)
    - Ensure on the ateam directory the user ateam and group admins to have full permissions. All other users of the system should not have permissions. Use the command sudo chmod 770 /home/ateam.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f55bbeb8-5e66-4027-b412-be275a480082/Annotation_2020-05-31_080733.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f55bbeb8-5e66-4027-b412-be275a480082/Annotation_2020-05-31_080733.png)
    - Confirm that you have set the correct permissions using the command sudo ls –ld /home/ateam
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d84091a3-1d81-4933-8446-c01a9535eb80/Annotation_2020-05-31_080757.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d84091a3-1d81-4933-8446-c01a9535eb80/Annotation_2020-05-31_080757.png)
    - In your home directory create a file named file1.txt using the command touch file1.txt
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4357f03b-ff27-4906-a529-203f3406df77/Annotation_2020-05-31_080828.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4357f03b-ff27-4906-a529-203f3406df77/Annotation_2020-05-31_080828.png)
    - View the permissions of the file using the command ls –l file1.txt
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1bbbc448-d7d0-4ab8-a43f-3883219814c6/Annotation_2020-05-31_080849.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1bbbc448-d7d0-4ab8-a43f-3883219814c6/Annotation_2020-05-31_080849.png)
    - Give to the group the write permission using the command chmod g+w file1.txt. Then confirm it using the command ls –l file1.txt
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f5722d11-890b-48e4-a851-2096cd4a9d3c/Annotation_2020-05-31_080933.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f5722d11-890b-48e4-a851-2096cd4a9d3c/Annotation_2020-05-31_080933.png)
    - ## 7.5 Guided Exercise: Disabling Linux Services
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c0cb4e33-b6f6-4658-b946-de55441f43d6/Annotation_2020-05-31_081057.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c0cb4e33-b6f6-4658-b946-de55441f43d6/Annotation_2020-05-31_081057.png)
    - In this exercise, you are required to disable the apache web server service.
    - On the Ubuntu Server run the command netstat –tulpn to confirm that the webserver is listening on port 80.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2c0b3b12-5177-47e1-9c90-b10203b825a0/Annotation_2020-05-31_081136.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2c0b3b12-5177-47e1-9c90-b10203b825a0/Annotation_2020-05-31_081136.png)
    - Then run the command systemctl status apache2. Press the q button after the command shows the result.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bab6ba4f-747c-4515-ade0-c00b450f6a31/Annotation_2020-05-31_081204.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bab6ba4f-747c-4515-ade0-c00b450f6a31/Annotation_2020-05-31_081204.png)
    - Then run the command systemctl stop apache2 to stop the service. Authentication is required so you need to enter the user password.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c76c5d33-53cb-4bfa-817d-b6db83e4f52b/Annotation_2020-05-31_081235.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c76c5d33-53cb-4bfa-817d-b6db83e4f52b/Annotation_2020-05-31_081235.png)
    - Run one more time systemctl status apache2 to confirm that the apache2 service has been stopped.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e2265988-8efc-4bac-8670-ac4d97ffbab8/Annotation_2020-05-31_081301.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e2265988-8efc-4bac-8670-ac4d97ffbab8/Annotation_2020-05-31_081301.png)
    - Run the command sudo systemctl disable apache2 to disable the webserver. The command requires the user password and enter Pa$$w0rd. That command will prevent the webserver from starting during boot time.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/aee3c954-a464-40ad-a1c9-93134985cd20/Annotation_2020-05-31_081334.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/aee3c954-a464-40ad-a1c9-93134985cd20/Annotation_2020-05-31_081334.png)
    - Run the command netstat –tulpn to confirm that port 80 is not listening for connections.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cb755333-b17e-4ff1-a7bd-67cb8fb60011/Annotation_2020-05-31_081355.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cb755333-b17e-4ff1-a7bd-67cb8fb60011/Annotation_2020-05-31_081355.png)
    - ## 7.6 Operating System Patches
    - From time to time, security flaws are found in operating systems. As software vendors become aware of flaws, they usually write corrections to their code, known as patches or updates. Whatever operating system you use, you must apply these patches as a matter of routine.
    - Windows patches are probably the most well-known, but patches can be released for any operating system. You should patch your system any time a critical patch is released. You might consider scheduling a specific time simply to update patches. Some organisations find that updating once per quarter or even once per month is necessary.
    - ### 7.6.1 Applying Patches
    - Applying patches means that the operating system, database management systems, development tools, Internet browsers, and so on are all checked for patches. In a Microsoft environment this should be easy because the Microsoft website has a utility that scans your system for any required patches to the browser, operating system, or office products. It is a very basic tenet of security to ensure that all patches are up-to-date.
    - This should be one of your first tasks when assessing a system. Regardless of the operating system or application vendor, you should be able to go to its website and find information regarding how to download and install the latest patches. But remember that everything must be patched—the operating system, applications, drivers, network equipment (switches, routers, etc.), literally everything.
    - Once you have ensured that all patches are up to date, the next step is to set up a system to ensure that they are kept up to date. One simple method is to initiate a periodic patch review where, at a scheduled time, all machines are checked for patches. There are also automated solutions that will patch all systems in your organisation. It is imperative that all machines be patched, not just the servers.
    - ### 7.6.2 Automated Patch Systems
    - Manually patching machines can be quite cumbersome, and in larger networks, simply impractical. However, there are automated solutions that will patch all systems on your network. These solutions scan your systems at pre-set times and update any required patches.
    - ### 7.6.3 Windows Update
    - For systems running Microsoft Windows, you can set up Windows to automatically patch your system. Recent versions of Windows have this turned on automatically. If your system is older, simply go to [](https://support.microsoft.com/en-us/help/12373/windows-update-faq)https://support.microsoft.com/en-us/help/12373/windows-update-faq and follow the instructions to keep your system updated. This will give that individual machine routing updates for the Windows operating system.
    - This approach does have a few shortcomings, the first being that it will only update Windows and not any other applications on your machine. The second drawback is that it does not provide any way to check patches on a test machine before deploying them to the entire network. Its main advantages are that it is free, and integrated with the Windows operating system.
    - Surprisingly, another commonly overlooked protection is some type of software update platform. Windows Server Update Services (WSUS), System Centre Configuration Manager (SCCM), and other third-party applications can keep the endpoints up-to-date with the latest security patches. Not only should you worry about regular Windows system patches, but there should also be a focus on outdated versions of commonly exploited software such as Java, Adobe Reader, Firefox, and others that are currently in use.
    - ### 7.6.4 Unix/Linux Software Updates
    - Unlike Microsoft environments, Unix-based environments typically use a system of package management to install the majority of third-party applications.
    - Package management and update tools vary depending not only on which flavor of Unix you are running, but also differ depending on distribution you use. For example, Debian Linux and SUSE Linux use two different package management systems, and FreeBSD uses another.
    - Despite the differences, there are common themes surrounding the package management systems. Typically, each host will hold a repository of packages that are available to install on the system via local tools. The system administrator issues commands to the package management system to indicate that she wishes to install, update, or remove packages. The package management system will, depending on configuration, either download and compile, or download a binary of the desired package and its dependencies (libraries and other applications required to run the desired application), and install them on the system.
    - The various package management systems are so comprehensive in a modern distribution that for many environments it would be unusual to require anything further. Deploying software via package management, as opposed to downloading from elsewhere, is the preference unless there is a compelling reason to do otherwise. This greatly simplifies the issue of staying up-to-date and tracking dependencies.
    - The same package management system can be used to perform upgrades. As the repository of available packages is updated, new versions of already installed packages appear in the package database. These new version numbers can be compared against the installed version numbers and a list of applications due for an upgrade to a new version can determined automatically, typically via a single command line.
    - This ease of upgrade using package management means that unless a robust system of checking for and applying changes is in place for installed applications, the package management system should be used to provide an easy, automated method of updating all packages on UNIX application servers.
    - Not only does this remove the need to manually track each application installed on the application servers, along with all their associated dependencies, but it (typically) means that it has already been tested and confirmed to work on that distribution. Of course, individual quirks between systems mean that you cannot be sure that everything will always work smoothly, and so the testing process should remain. However, the testing process may be entered with a good degree of confidence.
    - ### 7.6.4.1 Core Operating System Updates
    - Many, but not all, UNIX systems have a delineation between the operating system and applications that are installed on it. As such, the method of keeping the operating system itself up-to-date will often differ from that of the applications. The method of upgrading will vary from operating system to operating system, but the upgrade methods fall into two broad buckets:
    - **Binary update**
    - Commercial operating systems particularly favour the method of applying a binary update; that is, distributing precompiled binary executables and libraries that are copied to disk, replacing the previous versions. Binary updates cannot make use of custom compiler options and make assumptions about dependencies, but they require less work in general and are fast to install.
    - **Update from source**
    - Many open source operating systems favour updates from source, meaning that they are compiled locally from a copy of the source code and previous versions on disk are replaced by these binaries. Updating from source takes more time and is more complex, however the operating system can include custom compiler optimizations and patches.
    - There are many debates over which system is better, and each has its pros and cons. For the purposes of this book, however, we will assume that you are sticking with the default of your operating system as the majority of arguments centre on topics unrelated to security.
    - Updates to the operating system are typically less frequent than updates to third-party software. Additionally, they are more disruptive, as they typically require a reboot because they often involve an update to the kernel or other subsystems that only load at startup, unlike application updates, which can be instantiated via the restart of the appropriate daemon. Core operating updates are advisable, though as vulnerabilities are often found within both operating systems and applications.
    - As with any other patch of this nature, it is advisable to have a rollback plan in place for any large update such as one for an operating system. In the case of virtualized infrastructure, this can be achieved simply by taking a snapshot of the file system prior to upgrade; thus a failed upgrade can be simply rolled back by reverting to the last snapshot. In physical infrastructure this can be more problematic, but most operating systems have mechanisms to cope with this issue, typically by storing a copy of the old binaries and replacing them if required.
    - Nevertheless, patches to the operating system are often required in order to close security gaps, so you should have a process defined to cope with this. As with applications, the effort to upgrade the operating system is lower the more up-to-date a system already is, so we recommend remaining as current as is reasonable, leaving only small increments to update at any one time.
- **Module 8 : Virus Attacks and How to Defend**
    - ## 8.1 Virus Types and Attacks
    - Understanding what a virus is, how it spreads, and the different variations is essential for defending against virus threats. You will also need to understand how a virus scanner works in order to make intelligent decisions about purchasing a virus scanner for your organisation.
    - ### 8.1.1 What is a Virus
    - Most people are familiar with computer viruses, but may not have a clear definition of what is. A computer virus is a program that self-replicates. A virus will also have some other negative functions such as deleting files or changing system settings. However, the self-replication and rapid spread that define a virus. Often this growth, in and of itself, can be a problem for an infected network. It can lead to excessive network traffic and prevent the network from functioning properly. The more a virus floods a network with traffic, the less capacity is left for real work to be performed.
    - ### 8.1.2 What is a Worm
    - A worm is a special type of virus. Some texts go to great lengths to differentiate worms and viruses, while others treat the worm as simply a subset of a virus. A worm is a virus that can spread without human intervention. In other words, a virus requires some human action in order to infect a machine (downloading a file, opening an attachment, and so on), but a worm can spread without such interaction. In recent years, worm eruptions have become more common than the standard, non-worm virus. Today most of what is called a “virus” is actually a worm.
    - ### 8.1.3 How a Virus Spreads
    - The best way to combat viruses is to limit their spread, so it is critical that you understand how they spread. A virus will usually spread in one of two ways. The most common, and the simplest, method is to read your e-mail address book and e-mail itself to everyone in your address book. The second method is to simply scan your computer for connections to a network, and then copy itself to other machines on the network to which your computer has access. This is actually the most efficient way for a virus to spread, but it requires more programming skills than the other method.
    - The first method is, by far, the most common method for virus propagation. Microsoft Outlook may be the one e-mail program most often hit with such virus attacks. The reason is not so much a security flaw in Outlook, as it is the ease of working with Outlook.
    - Another way a virus can spread is by examining the affected system looking for any connected computers and copying itself to them. This sort of self-propagation does not require user interaction, so the program that uses this method to infect a system is classified as a worm.
    - Regardless of the way a virus arrives at your doorstep, once it is on your system, it will attempt to spread and, in many cases, will attempt to cause some harm to your system. Once a virus is on your system, it can do anything that any legitimate program can do. That means it could potentially delete files, change system settings, or cause other harm. The threat from virus attacks cannot be overstated. Some recent virus eruptions went so far as to disable existing security software, such as antivirus scanners and firewalls.
    - ### 8.1.3.1 Rombertik
    - Rombertik caused chaos in 2015. This malware uses the browser to read user credentials to websites. It is sent as an attachment to an e-mail. Perhaps even worse, in some situations Rombertik will either overwrite the master boot record on the hard drive, making the machine unbootable, or begin encrypting files in the user’s home directory.
    - ### 8.3.1.2 Shamoon
    - Shamoon is a computer virus discovered in 2012 designed to target computers running Microsoft Windows in the energy sector. Symantec, Kaspersky Lab, and Seculert announced its discovery on August 16, 2012. It is essentially a data-stealing program that seems to target systems in energy companies. A variant of Shamoon appeared again in 2017.
    - Several other viruses, worm and malware exist such as Gameover Zeus, Mirai, Linux Encoder 1, Kedi RAT and much more.
    - ### 8.1.3.3 Ransomware
    - It is impossible in modern times to discuss malware and not discuss ransomware. While many people first began discussing ransomware with the advent of CrytpoLocker in 2103, ransomware has been around a lot longer than that. The first known ransomware was the 1989 PC Cyborg Trojan, which only encrypted filenames with a weak symmetric cipher. In early 2017 the WannaCry ransomware spread, starting in health care systems in the United Kingdom. It attacked unpatched Windows systems. This states the need for patching.
    - The Bad Rabbit computer virus spread in late 2017. This virus is ransomware. It began attacking in Russia and Ukraine, but quickly spread around the world.
    - ### 8.1.4 Types of Viruses
    - There are many types of viruses. A virus can be classified by either its propagation method or by its activities on the target computers.
        - **Macro:** Macro viruses infect the macros in office documents. Many office products, including Microsoft Office, allow users to write mini-programs called macros. These macros can also be written as a virus. A macro virus is written into a macro in some business application. For example, Microsoft Office allows users to write macros to automate some tasks. Microsoft Outlook is designed so that a programmer can write scripts using a subset of the Visual Basic programming language, called Visual Basic for Applications (VBA).
        - This scripting language is, in fact, built into all Microsoft Office products. Programmers can also use the closely related VBScript language. Both languages are quite easy to learn. If such a script is attached to an e-mail and the recipient is using Outlook, then the script can execute. That execution can do any number of things, including scanning the address book, looking for addresses, sending out e-mail, deleting e-mail, and more.
        - Boot Sector: As the name suggests, a boot sector virus infects the boot sector of the drive, rather than the operating system. This makes them more difficult to eliminate, as most antivirus software works within the operating system.
        - Multipartite: Multipartite viruses attack the computer in multiple ways—for example, infecting the boot sector of the hard disk and one or more files.
        - Memory resident: A memory-resident virus installs itself and then remains in RAM from the time the computer is booted up to when it is shut down.
        - Armored: An Armored virus uses techniques that make it hard to analyse. Code confusion is one such method. The code is written such that if the virus is disassembled, the code won’t be easily followed. Compressed code is another method for armouring the virus.
        - Stealth: There are several types of stealth virus. A stealth virus attempts to hide itself from antivirus. A few common methods of stealth are shown below:
            - Sparse infector: A sparse infector virus attempts to escape detection by performing its malicious activities only sporadically. With a sparse infector virus, the user will see symptoms for a short period, then no symptoms for a time. In some cases the sparse infector targets a specific program but the virus only executes every 10th time or 20th time that target program executes. Or a sparse infector may have a burst of activity and then lie dormant for a period of time. There are a number of variations on the theme, but the basic principle is the same: to reduce the frequency of attack and thus reduce the chances for detection.
            - Encrypted: Sometimes a virus is encrypted, even with weak encryption, just enough to prevent an antivirus program from recognizing the virus. Then when it is time to launch an attack, the virus is decrypted.
            - Polymorphic: A polymorphic virus literally changes its form from time to time to avoid detection by antivirus software. A more advanced form of this is called the metamorphic virus; it can completely change itself.
    - ## 8.2 Virus Scanners
    - The most obvious defence against viruses is the virus scanner. A virus scanner is essentially software that tries to prevent a virus from infecting your system. Usually it scans incoming e-mail and other incoming traffic. Most virus scanners also have the ability to scan portable media devices such as USB drives.
    - In general, virus scanners work in two ways. The first method is that they contain a list of all known virus files. Generally, one of the services that vendors of virus scanners provide is a periodic update of this file. This list is typically in a small file, often called a .dat file (short for data). When you update your virus definitions, what actually occurs is that your current file is replaced by the more recent one on the vendor’s website.
    - The antivirus program then scans your PC, network, and incoming e-mail for known virus files. Any file on your PC or attached to an e-mail is compared to the virus definition file to see whether there are any matches. With e-mail, this can be done by looking for specific subject lines and content. Known virus files often have specific phrases in the subject line and the body of the messages they are attached to. Yet viruses and worms can have a multitude of headers, some of which are very common, such as re:hello or re:thanks.
    - Scanning against a list of known viruses alone would result in many false positives. Therefore, the virus scanner also looks at attachments to see whether they have a certain size and creation date that matches a known virus or whether it contains known viral code. The file size, creation date, and location are the tell-tale signs of a virus. Depending on the settings of your virus scanner, you may be prompted to take some action, the file may be moved to a quarantined folder, or the file may simply be deleted outright. This type of virus scanning works only if the .dat file for the virus scanner is updated, and only for known viruses.
    - Another way a virus scanner can work is to monitor your system for certain types of behaviour that are typical of a virus. This might include programs that attempt to write to a hard drive’s boot sector, change system files, alter the system registry, automate e-mail software, or self-multiply. Another technique virus scanners often use is searching for files that stay in memory after they execute. This is called a Terminate and Stay Resident (TSR) program. Some legitimate programs do this, but it is often a sign of a virus.
    - Many virus scanners have begun employing additional methods to detect viruses. Such methods include scanning system files and then monitoring any program that attempts to modify those files. This means the virus scanner must first identify specific files that are critical to the system. With a Windows system, these include the registry, the boot.ini, and possibly other files. Then, if any program attempts to alter these files, the user is warned and must first authorize the alteration before it can proceed.
    - It is also important to differentiate between on-demand virus scanning and ongoing scanners. An ongoing virus scanner runs in the background and is constantly checking a PC for any sign of a virus. On-demand scanners run only when you launch them. Most modern antivirus scanners offer both options.
    - ### 8.2.1 Email and Attachment Scanning
    - Since the primary propagation method for a virus is e-mail, e-mail and attachment scanning is the most important function of any virus scanner. Some virus scanners actually examine your e-mail on the e-mail server before downloading it to your machine. Other virus scanners work by scanning your e-mail and attachments on your computer before passing it to your e-mail program. In either case, the e-mail and its attachments should be scanned prior having any chance to open it and release the virus on your system. This is a critical difference. If the virus is first brought to your machine, and then scanned, there is a chance, however small, that the virus will still be able to infect your machine. Most commercial network virus scanners will scan the e-mail on the server before sending it on to the workstations.
    - ### 8.2.2 Download Scanning
    - Anytime you download anything from the Internet, either via a web link or with an FTP program, there is a chance you might download an infected file. Download scanning works much like e-mail and attachment scanning, but does so on files you select for downloading.
    - ### 8.2.3 File Scanning
    - Download and e-mail scanning will only protect your system against viruses that you might get downloading from a site, or that come to you in e-mail. Those methods will not help with viruses that are copied over a network, deposited on a shared drive, or that are already on your machine before you install the virus scanner.
    - This is the type of scanning in which files on your system are checked to see whether they match any known virus. This sort of scanning is generally done on an on-demand basis instead of an ongoing basis. It is a good idea to schedule your virus scanner to do a complete scan of the system periodically. I personally recommend a weekly scan, preferably at a time when no one is likely to be using the computer.
    - It does take time and resources to scan all the files on a computer’s hard drive for infections. This type of scanning uses a method similar to e-mail and download scanning. It looks for known virus signatures. Therefore, this method is limited to finding viruses that are already known and will not find new viruses.
    - ### 8.2.4 Heuristic Scanning
    - This is perhaps the most advanced form of virus scanning. This sort of scanning uses rules to determine whether a file or program is behaving like a virus, and is one of the best ways to find a virus that is not a known virus. A new virus will not be on any virus definition list, so you must examine its behaviour to determine whether it is a virus. However, this process is not fool proof. Some actual virus infections will be missed, and some non-virus files might be suspected of being a virus.
    - The unfortunate side effect of heuristic scanning is that it can easily lead to false positives. This means that it might identify a file as a virus, when in fact it is not. Most virus scanners do not simply delete viruses. They put them in a quarantined area, where you can manually examine them to determine whether you should delete the file or restore it to its original location. Examining the quarantined files rather than simply deleting them all is important because some can be false positives. In this author’s personal experience, false positives are relatively rare with most modern virus scanners.
    - As the methods for heuristic scanning become more accurate, it is likely that more virus scanners will employ this method, and will rely on it more heavily. Such algorithms are constantly being improved. One area of research now is adding machine learning to antivirus algorithms.
    - ### 8.2.5 Active Code Scanning
    - Modern websites frequently embed active codes, such as Java applets and ActiveX. These technologies can provide some stunning visual effects to any website. However, they can also be vehicles for malicious code. Scanning such objects before they are downloaded to your computer is an essential feature in any quality virus scanner.
    - ### 8.2.6 Instant Messaging Scanning
    - Instant message scanning is a relatively new feature of virus scanners. Virus scanners using this technique scan instant messaging communications looking for signatures of known virus or Trojan horse files. In recent years the use of instant messaging has increased dramatically. It is now frequently used for both business and recreational purposes. This growing popularity makes virus scanning for instant messaging a vital part of effective virus scanning. If your antivirus scanner does not scan instant messaging, then you should either avoid instant messaging or select a different antivirus package.
    - Most commercial virus scanners use a multi-modal approach to scanning. They employ a combination of most, if not all, of the methods we have discussed here. Any scanner that does not employ most of these methods will have very little value as a security barrier for your system.
    - ## 8.3 Antivirus
    - There are a number of antivirus packages available for individual computers and for network-wide virus scanning. It is important to consider the following factors when purchasing a virus scanning solution for your own organisation or recommending a solution to a client:
        - Budget: Price should not be the only, or even the most important, consideration, but it certainly must be considered.
        - Vulnerability: An organisation with diverse users who frequently get e-mail from outside the organisation or download from the Internet will need more antivirus protection than a small similar group that uses the Internet only occasionally.
        - Skill: Whoever will ultimately use the product must be able to understand how to use it. Are you getting a virus scanner for a group of tech-savvy engineers or a group of end users who are unlikely to be technically proficient?
        - Technical: How does the virus scanner work? What methods does it use to scan? How often are the .dat files updated? How quickly does the vendor respond to new virus threats and release new .dat files?
    - All of these factors must be considered when selecting antivirus solutions. Too often security experts simply recommend a product they are familiar with, without doing significant research.
    - ### 8.3.1 McAfee
    - McAfee is a well-known antivirus vendor. Their antivirus has been marketed under many names, including VirusScan, Endpoint Security, and Total Protection. This company offers solutions for the home user and large organisations. All of McAfee’s products have some common features, including e-mail scanning and file scanning. They also scan instant messaging traffic.
    - McAfee scans e-mail, files, and instant messaging for known virus signatures, and uses heuristic methods to locate new worms. Given the growing use of worms (in contrast with traditional viruses), this is an important benefit. McAfee offers a relatively easy download and install, and you can get a trial version from the company’s website.
    - ### 8.3.2 Norton Antivirus
    - Norton Antivirus is also a widely known vendor of antivirus software. You can purchase Norton solutions for individual computers or for entire networks. Norton offers e-mail and file scanning, as well as instant messaging scanning. It also offers a heuristic approach to discovering worms and traditional signature scanning. Recent versions of Norton Antivirus have also added anti-spyware and anti-adware scanning, both very useful features. An additional interesting feature of Norton Antivirus is the pre-install scan. During the installation, the install program scans the machine for any virus infections that might interfere with Norton. Because it is becoming more common to find virus attacks that actually seek to disable antivirus software, this feature is very helpful
    - While Norton, like most antivirus vendors, offers versions for individual PCs and for entire networks, the individual version has a free trial version you can download and experiment with for 15 days without any charge.
    - ### 8.3.3 Avast Antivirus
    - This product is offered free for home, non-commercial uses. You can download the product from the vendor’s website: [www.avast.com/](http://www.avast.com/). You can also find professional versions, versions for Unix or Linux, and versions specifically for servers. Of particular interest is that this product is available in multiple languages including English, Dutch, Finnish, French, German, Spanish, Italian, and Hungarian.
    - If you download it, you can see that Avast opens up with a tutorial. This feature, combined with the fact that the home version is free, makes this a very attractive tool for the novice home user. The Multilanguage and multioperating system support make it attractive to many professionals. When it finds a virus, it sounds an alarm and then a voice states “Warning: There is a virus on your computer.”
    - ### 8.3.4 AVG
    - AVG antivirus has become quite popular. One reason is that there is a free version of it as well as a commercial version.
    - AVG is robust and full-featured antivirus software. It integrates with e-mail clients such as Microsoft Outlook and it also filters web traffic and downloads.
    - ### 8.3.5 Kaspersky
    - Kaspersky has been growing in popularity. It includes business and personal versions. Like most antivirus products, it also includes additional features not directly related to detecting viruses. For example, Kaspersky includes an encrypted password vault to keep your passwords in, if you want to.
    - ### 8.3.6 Panda
    - Panda is available in both commercial editions and free versions. The commercial version also comes with anti-spyware. Like Norton and McAfee, you can get a personal firewall bundled with the antivirus software. This product is available in English, French, and Spanish. This wide range of features makes this product a robust and effective solution.
    - ### 8.3.7 Malwarebytes
    - This product is available from [](https://www.malwarebytes.com/)https://www.malwarebytes.com/. There is a free version of the product and a paid premium version. Malwarebytes has a strong reputation in the industry, it is well regarded, and it is rather simple to use.
    - ### 8.3.8 Antivirus Policies and Procedures
    - Antivirus scanners are not the only facet of protecting yourself against viruses. In fact, there are situations in which a virus scanner is simply not enough. You will need policies and procedures to complete your antivirus strategy. Policies and procedures are simply written rules that dictate certain actions that administrators and end users should take and other activities they should avoid. Below are listed some policies and procedures:
        - Always use a virus scanner. It costs only about $30 a year to keep your virus scanner updated. It can cost much more to not do it.
        - If you are not sure about an attachment, do not open it. When you have specifically requested a file from someone, then opening an attachment from that person is probably safe. However, unexpected attachments are always cause for concern.
        - Consider exchanging a code word with friends and colleagues. Tell them to put the code word in the title of the message if they wish to send you an attachment. Without the code word, do not open any attachment.
        - Be sceptical of any e-mail you are sent. Keeping e-mail to official traffic will help reduce your danger. Jokes, flash movies, and so on simply should not be sent on a company e-mail system.
        - Do not download files from the Internet. If you need a file downloaded, the IT department should do that, carefully scan the file, and then forward it to the user. If you feel compelled to download files you should follow two simple rules:
            - Only download from well-known, reputable sites.
            - Download to a machine that is off the network first. Then you can scan that system for viruses. In fact, if you do request your IT department to download something for you, this is likely to be the process they use.
    - ## 8.4 Guided Exercise: Scanning for Viruses
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b7b2c5fa-d89c-4aaa-9764-47b9f996cc6d/Annotation_2020-05-31_093417.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b7b2c5fa-d89c-4aaa-9764-47b9f996cc6d/Annotation_2020-05-31_093417.png)
    - In this exercise, you are required to scan a zip file with an antivirus and identify if the file is malicious.
    - Open the desktop folder called Exercises and then the folder Malwarebytes. Double click the file mb3-setup-consumer, to install Malwarebytes.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7cfcb226-2aec-45d3-8021-2edd6174513a/Annotation_2020-05-31_093506.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7cfcb226-2aec-45d3-8021-2edd6174513a/Annotation_2020-05-31_093506.png)
    - On the windows Open File – Security Warning select Run.
    - On the User Account Control windows select Yes.
    - Click OK on the Select Setup Language
    - On the Setup – Malwarebytes window Select Personal computer and then click Continue
    - Click Agree and Continue on the Setup – Malwarebytes window.
    - Once the installation finishes click Finish on the Setup – Malwarebytes window
    - Click Scan Now on the Malwarebytes window. If you get a warning for network error just ignore it after the scan finishes.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/208c43ef-abec-4afc-ba2c-7fb44a6aa754/Annotation_2020-05-31_093636.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/208c43ef-abec-4afc-ba2c-7fb44a6aa754/Annotation_2020-05-31_093636.png)
    - Once the scan finishes you can observer that Malwarebytes was able to identify the file trojan simulator as a malicious file.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a8f69b00-ef83-4d90-84b3-22ef2b488be2/Annotation_2020-05-31_093704.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a8f69b00-ef83-4d90-84b3-22ef2b488be2/Annotation_2020-05-31_093704.png)
    - ## 8.5 Virus Infection and Identification
    - The unfortunate reality is that no matter what steps you take to prevent virus infections, there is still a chance your system being infected with a virus. The next question is, what do you do? Some facets of your response will depend upon the severity of the virus and how far it has spread, but generally, you need to focus on three things:
        - Stopping the spread of the virus.
        - Removing the virus.
        - Finding out how the infection started
    - ### 8.5.1 Stopping the Spread of the Virus
    - In the event of a virus infection, the first priority is to stop the spread of the infection. How this is done will, depend on how far the virus has spread. If the virus has only affected one machine, you can simply disconnect that machine from the network. However, it is unlikely that you will detect a virus before it has spread beyond a single machine. Given that fact, you will generally wish to follow these steps:
        - If the infection is on a segment of a WAN, then immediately disconnect from that WAN connection.
        - If the infection is on a subnetwork, immediately disconnect that subnetwork.
        - If there are servers with sensitive data that are connected (in any way) to the infected machine (or machines), disconnect those servers. This will prevent loss of sensitive data.
        - If there are backup devices connected to the infected machine or machines, disconnect them. This will prevent your backup media from becoming infected.
    - Obviously, your goal is to avoid getting a virus on your system. However, if that unfortunate event occur, following these steps can minimize the damage and get your system back up and functioning in a shorter period.
    - ### 8.5.2 Removing the Virus
    - Once you have isolated the infected machine or machines, the next step is to clean them. If you know the specific virus, then you should be able to remove it by running an antivirus program, or you should be able to find virus removal instructions on the Internet. In the highly unlikely event that you cannot remove the virus, then you may have no other choice but to format the machine (or machines) and restore them from backups. However, it must be stressed that such a situation is very unlikely.
    - If you do successfully remove the virus, you will want to scan the machine thoroughly for any other virus infections before reconnecting it to your network. You should be certain it is completely clean before putting it back online.
    - ### 8.5.3 Finding how the Infection Started
    - Once you have contained and removed the virus, the next goal is to see that it does not reappear. This is done by finding out how the virus got onto your system in the first place. To do this, you need to investigate the situation in three ways:
        - Talk to users of the infected machines and see if anyone opened any e-mail attachments, downloaded anything, or installed anything. Since these are the three most likely avenues for virus infection, they should be checked first.
        - Read any online documentation for that specific virus. It will tell you the normal method of propagation.
        - If neither of those avenues tells you what occurred, check any activity
    - ### 8.6 Trojan Horses
    - A Trojan horse is an application that appears to have a benign purpose but actually performs some malicious function. This deception is what makes these applications a dangerous threat to your system. The Internet is full of useful utilities (including many security tools), screen savers, images, and documents. Most Internet users do download some of these things. Creating an attractive download that has a malicious payload is an effective way of gaining access to a person’s computer.
    - One defence against Trojan horses is to prevent all downloads, but that is not particularly practical. The value of the Internet is the easy access it provides to such a wide variety of information—restricting that access in such a draconian manner disrupts one of the most important reasons for giving employees Internet access. Instead of using such a heavy-handed tactic, you will learn other ways to protect your systems from Trojan horses.
    - Once you have a Trojan horse on your system, it may perform any number of unwanted activities. Some of the most common actions Trojan horses take include:
        - Erasing files on a computer.
        - Spreading other malware, such as viruses. Another term for a Trojan horse that does this is a dropper.
        - Using the host computer to launch distributed denial of service (DDoS) attacks or send spam.
        - Searching for personal information such as bank account data.
        - Installing a back door on a computer system. This means providing the creator of the Trojan horse easy access to the system, such as creating a username and password she can use to access the system.
    - Of the items on the above list, installing back doors and executing distributed denial of service attacks are probably the most frequent results of a Trojan horse attack, though installing spyware and dropping viruses are becoming much more common as well.
    - Below there is a list with some famous Trojan Horses:
        - Back Orifice
        - Anti-Spyware 2011
        - Shedun
        - Brain Test
        - FinFisher
        - NetBus
        - FlashBack
    - ### 8.6.1 Trojan Horses Symptoms
    - It is difficult to determine whether your system is victim of a Trojan horse. There are a number of symptoms that might indicate that you have a Trojan horse. Assuming, of course, that you or another legitimate user are not making these changes, such symptoms include:
        - Home page for your browser changing
        - Any change to passwords, usernames, accounts, etc.
        - Any changes to screen savers, mouse settings, backgrounds, etc.
        - Any device (such as a CD door) seeming to work on its own
    - Any of these changes are symptoms of a Trojan horse and indicate your system is probably infected.
    - ## 8.7 Spyware or Adware
    - Spyware is a growing problem both for home computer users and for organisations. There is, of course, the risk that such applications might compromise some sensitive information. Another problem of such applications is that they consume too much of your system’s resources. Spyware and adware both use memory. If your system has too many such applications, then they can consume so much of your system’s resources that your legitimate software will have trouble running.
    - The primary difference between spyware and adware is what they do on your machine. They both infect your machine in the same manner. Spyware seeks to get information from your machine and make it available to some other person. This can be done in a number of ways. Adware seeks to create pop-up ads on your machine. Because these ads are not generated by the web browser, many traditional pop-up blockers will not stop them.
    - Both spyware and adware are growing problems for network security and home PC security. This is an important element of computer security software that was at one time largely ignored. Even today, not enough people take spyware seriously enough to guard against it. Some of these applications simply change your home page to a different site (these are known as home page hijackers); others add items to your favourites (or read items from them). Other applications can be even more intrusive.
    - Below there is a list with some famous spyware and adware:
        - Gator
        - RedSheriff
    - ### 8.7.1 Anti-Spyware
    - Most antivirus products include anti-spyware. However, you can purchase dedicated anti-spyware software. Anti-spyware is an excellent way to defend against spyware and adware, just as antivirus software defends against viruses and Trojan horses. Essentially, it is software that scans your computer to check for spyware running on your machine. Most anti-spyware works by checking your system for known spyware files. It is difficult to identify specific activities that identify spyware, as you can with viruses. Each application must simply be checked against a list of known spyware. This means that you must maintain some sort of subscription service so that you can obtain routine updates to your spyware definition list.
    - In today’s Internet, running anti-spyware is as essential as running antivirus software. Failing to do so can lead to serious consequences. Personal data and perhaps sensitive business data can easily leak out of your organisation without your knowledge due to spyware. You should also keep in mind that it is entirely possible for spyware to be the vehicle for purposeful industrial espionage.
- **Module 9 : Security Policies**
    - ## 9.1 User Policies Definition
    - Misuse of systems is a major problem for many organisations. A large part of the problem comes from the difficulty in defining what exactly misuse is. Some things might be obvious misuse, such as using company time and computers to search for another job or to view forbidden websites.
    - However, other areas are not so clear, such as an employee using her lunchtime to look up information about a car she is thinking of buying. Generally, good user policies outline specifically how people may use systems and how they may not. For a policy to be effective, it needs to be very clear and quite specific. Statements such as “computers and Internet access are only for business use” are simply inadequate.
    - Every organisation must have specific policies that will be applied fairly across the organisation. In the previous example, using a general statement of “computers and Internet access are only for business use” can be problematic. Assume you have an employee who occasionally takes just a few minutes to check home e-mail with the company computer. You decide that this is acceptable, and choose not to apply the policy. Later another employee spends two to three hours per day surfing the Net and you fire him for violating company policy. That employee might sue the company for wrongful termination.
    - Other areas for potential misuse are also covered by user policies, including password sharing, copying data, leaving accounts logged on while employees go to lunch, and so on. All of these issues ultimately have a significant impact on your network’s security and must be clearly spelled out in your user policies. We will now examine several areas that effective user policies must cover:
        - Passwords
        - Internet use
        - E-mail attachments
        - Software installation and removal
        - Instant messaging
        - Desktop configuration
        - BYOD
    - ### 9.1.1 Passwords
    - Keeping passwords secure is critical. Appropriate passwords are part of operating system hardening. You should recall that a good password has in the past been defined as one that is six to eight characters long, uses numbers and special characters, and has no obvious relevance to the end user. For example, a user will use a password like “cowboys” or “godallas,” but it should be advised to use a password like “%trEe987” or “123DoG$$” because those do not reflect the person’s personal interests and therefore will not be easily guessed.
    - Issues such as minimum password length, password history, and password complexity come under administrative policies, not user policies. Those complexity requirements are still good recommendations. However, you should consider longer passwords, such as those 12 characters or longer. User policies dictate how the end user should behave.
    - However, no password is secure, no matter how long or how complex, if it is listed on a Post-it note stuck to the user’s computer monitor. This may seem obvious, but it is not at all uncommon to go into an office and find a password either on the monitor or in the top drawer of the desk. Every janitor or anyone who simply passes by the office can get that password.
    - It is also common to find employees sharing passwords. For example, Bob is going to be out of town next week, so he gives Alice his password so that Alice can get into his system, check e-mail, and so on. The problem is that now two people have that password. And what happens if, during the week Bob is gone, Alice gets ill and decides she will share the password with Shelly so she can keep checking that system while Alice is out sick? It does not take long for a password to get to so many people that it is no longer useful at all from a security perspective.
    - Issues like minimum length of passwords, password age, password history are issues of administrative policies. System administrators can force these requirements. However, none of that will be particularly helpful if the users do not manage their passwords in a secure fashion.
    - All of this means you need explicit policies regarding how users secure their passwords. Those policies should specify:
        - Passwords are never to be kept written down in any accessible place. The preference is that they not be written down at all, but if they are, they should be in a secure area such as a lock box.
        - Passwords must never be shared with any person for any reason.
        - If an employee believes his password has been compromised, he should immediately contact the IT department so that his password can be changed and so that logon attempts with the old password can be monitored and traced.
    - A recommendation is to choose a passphrase, something like ILikeCheeseBurgers, and then change the e’s to 3’s and use some capitalization. Perhaps add a symbol so it becomes ILik3Ch33s3Burg3rs. This is a very secure password. It can be remembered and it has complexity and length.
    - The complexity requirements prevent dictionary attacks (using words from a dictionary) and guessing. However, you might be wondering why a long password is so important. The reason has to do with how passwords are stored. In Windows when you select a password, that password is stored in hashed format in a SAM file. Remember that a hash cannot be undone. Therefore, when you log in, Windows will hash whatever you type in and compare it to what’s in the SAM file. If they match, you are in.
    - Hashing passwords leads to the use of an interesting hacking technique called the rainbow table. A rainbow table contains all the possible hashes of all the key combinations that might have been used in a password, up to a given size. For example, all the single-character combinations are hashed, all the two-character combinations are hashed, and so on up to some finite limit (often 8 to 10 characters). If you get the SAM file then you can search the rainbow table for any matches. If you find a match, then the associated plaintext must be the password. Tools such as OphCrack boot into Linux and then run a rainbow table against the SAM file. However, larger rainbow tables are cumbersome. No current rainbow tables can handle passphrases of 20 characters or more.
    - ### 9.1.2 Internet use Policy
    - Most organisations provide users with some sort of Internet access. There are several reasons for this. The most obvious reason is e-mail. However, that is hardly the only reason to have Internet access in a business. There is also the web, and even chat rooms. All of these can be used for legitimate purposes within any organisation but can also be serious security problems. Appropriate polices must be in place to govern the use of these technologies.
    - The web is a wonderful resource for a tremendous wealth of data. The Internet is also full with useful tutorials on various technologies. However, even nontechnology-related business interests can be served via the web. Here are a few examples of legitimate business uses of the web:
        - Sales staff checking competitors websites to see what products or services they offer in what areas, perhaps even getting prices
        - Creditors checking a business’s AM Best or Standard and Poor’s rating to see how their business financial rating is doing
        - Business travellers checking weather conditions and getting prices for travel
    - Of course, other web activities are clearly not appropriate on a company’s network:
        - Using the web to search for a new job
        - Any pornographic use
        - Any use which violates local, state, or federal laws
        - Use of the web to conduct employee’s own business (i.e., an employee who is involved in another enterprise other than the company’s business, such as eBay)
    - In addition, there are grey areas. Some activities might be acceptable to some organisations but not to others. Such activities might include:
        - Online shopping during the employee’s lunch or break time
        - Reading news articles online during lunch or break time
        - Viewing humorous websites
    - What one person might view as absurdly obvious might not be to another. It is critical that any organisation have very clear policies detailing specifically what is and what is not acceptable use of the web at work. Giving clear examples of what is acceptable use and what is not is important. You should also remember that most proxy servers and many firewalls could block certain websites. This will help prevent employees from misusing the company’s web connection.
    - ### 9.1.3 Email Attachments
    - Most business and even academic activity now occurs via e-mail. As we have discussed in several previous chapters, e-mail also happens to be the primary vehicle for virus distribution. This means that e-mail security is a significant issue for any network administrator.
    - Clearly you cannot simply ban all e-mail attachments. However, you can establish some guidelines for how to handle e-mail attachments. Users should open an attachment only if it meets the following criteria:
        - It was expected (i.e., the user requested documents from some colleague or client).
        - If it was not expected, it comes from a known source. If so, first contact that person and ask whether they sent the attachment. If so, open it.
        - It appears to be a legitimate business document (that is, a spread sheet, a document, a presentation, etc.).
    - It should be noted that some people might find such criteria unrealistic. There is no question they are inconvenient. However, with the prevalence of viruses, often attached to e-mail, these measures are sensible. Many people choose not to go to this level to try to avoid viruses, and that may be your choice as well. Just bear in mind that millions of computers are infected with some sort of virus every single year.
    - No one should ever open an attachment that meets any of the following criteria:
        - It comes from an unknown source.
        - It is some active code or executable.
        - It is an animation/movie.
        - The e-mail itself does not appear legitimate. (It seems to tempt you to open the attachment rather than simply being a legitimate business communication that happens to have an attachment.)
    - If the end user has any doubt whatsoever, then should not open the e-mail. Rather, should contact someone in the IT department who has been designated to handle security. That person can then either compare the e-mail subject line to known viruses or can simply come check out the e-mail personally. Then if it appears legitimate, the user can open the attachment.
    - ### 9.1.4 Software Installation and Removal
    - This is one matter that does have an absolute answer. End users should not be allowed to install anything on their machine, including wall papers, screen savers, utilities etc. The best approach is to limit their administrative privileges so they cannot install anything. However, this should be coupled with a strong policy statement prohibiting the installation of anything on users’ PCs. If they wish to install something, it should first be scanned by the IT department and approved.
    - This process might be cumbersome, but it is necessary. Some organisations go so far as to remove media drives (optical drive, USB, etc.) from end users’ PCs so installations can occur only from files that the IT department has put on a network drive. This is usually a more extreme measure than most organisations will require, but it is an option you should be aware of.
    - ### 9.1.5 Instant Messaging
    - Instant messaging is also widely used and abused by employees in companies and organisations. In some cases, instant messaging can be used for legitimate business purposes. However, it does pose a significant security risk. There have been viruses that propagated specifically via instant messaging. In one incident the virus would copy everyone on the user’s buddy list with the contents of all conversations. Thus, a conversation the user thought was private was being broadcast to everyone with whom that user had messaged.
    - Instant messaging is also a threat from a purely informational security perspective. Without the traceability of an e-mail going through the corporate e-mail server, nothing stops an end user from instant messaging out trade secrets or other confidential information undetected. It is recommended that instant messaging simply be banned from all computers within an organisation. If you find your organisation absolutely must use it, then you must establish very strict guidelines for its use, including:
        - Instant messaging may be used only for business communications, no personal conversations. Now this might be a bit difficult to enforce. More common rules, such as prohibiting personal web browsing, are also quite difficult to enforce. However, it is still a good idea to have those rules in place. Then if you find an employee violating them, you can refer to a company policy that prohibits such actions. However, you should be aware that in all likelihood you would not catch most violations of this rule.
        - No confidential or private business information should be sent via instant messaging.
    - ### 9.1.6 Desktop Configuration
    - Many users like to reconfigure their desktop. This means changing the background, screen saver, font size, resolution, and so on. Theoretically speaking, this should not be a security hazard. Simply changing a computer’s background image cannot compromise the computer’s security. However there are other issues involved.
    - The first issue is where the background image comes from. Frequently end users download images from the Internet, creating an opportunity for getting a virus or Trojan horse, particularly one using a hidden extension (e.g., it appears to be a mypic.jpg but is really mypic.jpg.exe). There are also human resources/harassment issues if an employee uses a backdrop or screen saver that is offensive to other employees. Some organisations simply decide to prohibit any changes to the system configuration for this reason.
    - The second problem is technical. In order to give a user access to change screen savers, background images, and resolution, you must give rights that also allow to change other system settings you might not want changed. The graphical display options are not separated from all other configuration options. This means that allowing the user to change screen saver might open the door to alter other settings that would compromise security (such as the network card configuration or the Windows Internet connection firewall).
    - ### 9.1.7 Bring Your Own Device (BYOD)
    - Bring Your Own Device (BYOD) has become a significant issue for most organisations. Most, if not all, of your employees will have their own smart phones, tablets, smart watches, etc. that they will most likely carry with them into the workplace. When they connect to your wireless network, this introduces a host of new security concerns. You have no idea what networks those devices previously connected to, what software was installed on them, or what data might be exfiltrated by these personal devices.
    - In highly secure environments, the answer may be to forbid personally owned devices. However, in many organisations, such a policy is impractical. A workaround for that is to have a Wi-Fi network that is dedicated to BYOD and is not connected to the company’s main network. Another approach, although more technologically complex, is to detect the device on connection, and if it is not a company-issued device, significantly limit its access.
    - There are also alternatives to BYOD. For example, Choose Your Own Device (CYOD) is a policy wherein the company allows the employee to bring their own device, but only if that device is from a list of pre-approved devices. This gives the company some control over what the user is connecting to the company network.
    - COPE, or Company Owned and Provided Equipment, is another option. In this scenario, the company provides the device, and has complete control over it. However, this can become an issue when the employee uses a device for both personal and professional purposes, not to mention the expense of providing employees with devices and maintaining those devices.
    - Whatever approach you take, you must have some policy regarding personal devices. They are already ubiquitous and spreading even more. Just a few years ago, smart phones were really the only BYOD device. But today there are smart watches, smart luggage, etc., and it is difficult to predict what new devices might be coming in the future.
    - # 9.2 Guided Exercise: Analysing Policies
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d36607f7-1697-4e10-9e1e-3a2d7ac0686d/Annotation_2020-05-31_103322.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d36607f7-1697-4e10-9e1e-3a2d7ac0686d/Annotation_2020-05-31_103322.png)
    - In this exercise you will use the PolicyAnalyser tool to analyse existing policies and provide recommendations.
    - Login to Windows 10 and open the Desktop folder Exercises -> PolicyAnalyzer.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bc8e4e02-d281-4a34-a190-8fb33173e1d7/Annotation_2020-05-31_103352.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bc8e4e02-d281-4a34-a190-8fb33173e1d7/Annotation_2020-05-31_103352.png)
    - Double click the file PolicyAnalyzer to start it. Click run on the Security Warning window.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e37d8efe-abf8-4bc0-83aa-ecf2b0f2abd9/Annotation_2020-05-31_103418.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e37d8efe-abf8-4bc0-83aa-ecf2b0f2abd9/Annotation_2020-05-31_103418.png)
    - Check the box Local Policy and then click on View/Comapre button. Click Yes on the User Account Control Window and click Run on the Security Warning window.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/36b49543-17cc-404f-94bd-95dcdb9e1ef1/Annotation_2020-05-31_103439.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/36b49543-17cc-404f-94bd-95dcdb9e1ef1/Annotation_2020-05-31_103439.png)
    - Once the results are shown scroll till you find the Policy Setting for SAM. The Local policy says No Autiding. What will be your recommendation?
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e12713bd-a7b7-432e-9544-a70e6958b0fb/Annotation_2020-05-31_103506.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e12713bd-a7b7-432e-9544-a70e6958b0fb/Annotation_2020-05-31_103506.png)
    - A recommendation will be to audit such object as the SAM file contains the password hashes for the Windows users.
    - ## 9.3 System Administration Policies
    - In addition to determining policies for users, you must have some defined policies for system administrators. There must be a procedure for adding users, removing users, dealing with security issues, changing any system, and so on. There must also be procedures for handling any deviation.
    - ### 9.3.1 New Employees
    - When a new employee is hired, the system administration policy must define specific steps to safeguard company security. New employees must be given access to the resources and applications their job functions require. The granting of that access must be documented (possibly in a log). It is also critical that each new employee receive a copy of the company’s computer security/acceptable use policies and sign a document acknowledging receipt of such.
    - Before a new employee starts to work, the IT department (specifically network administration) should receive a written request from the business unit for which that person will be working. That request should specify exactly what resources this user will need and when will start. It should also have the signature of someone in the business unit with authority to approve such a request. Then, the person who is managing network administration or network security should approve and sign the request. After you have implemented the new user on the system with the appropriate rights, you can file a copy of the request.
    - ### 9.3.2 Leaving Employees
    - When an employee leaves, it is critical to make sure all logins are terminated and all access to all systems is discontinued immediately. Unfortunately, this is an area of security that many organisations do not give enough attention to. It is imperative to have all of the former employee’s access shut down on his last day of work. This includes physical access to the building. If a former employee has keys and is displeased, nothing can stop him from returning to steal or vandalize computer equipment. When an employee leaves the company, you should ensure that on his last day the following actions take place:
        - All logon accounts to any server, VPN, network, or other resources are disabled.
        - All keys to the facility are returned.
        - All accounts for e-mail, Internet access, wireless Internet, cell phones, etc., are shut off.
        - Any accounts for mainframe resources are cancelled.
        - The employee’s workstation hard drive is searched.
    - The last item might seem odd. However, if an employee was gathering data to take with him (proprietary company data) or conducting any other improper activities, you need to find out right away. If you do see any evidence of any such activity, you need to secure that workstation and keep it for evidence in any civil or criminal proceedings.
    - All of this might seem a bit extreme for some people. It is true that with the vast majority of exiting employees, you will have no issues of concern. However, if you do not make it a habit of securing an employee’s access when he departs, you will eventually have an unfortunate situation that could have been easily avoided.
    - ### 9.3.3 Change Requests
    - The nature of IT is change. Not only end users come and go, but requirements change frequently. Business units request access to different resources, server administrators upgrade software and hardware, application developers install new software, web developers change the website, and so on. Change is occurring all of the time. Therefore, it is important to have a change control process. This process not only makes the change run smoothly but also allows the IT security personnel to examine the change for any potential security problems before it is implemented. A change control request should go through the following steps:
        - An appropriate manager within the business unit signs the request, signifying approval.
        - The appropriate IT unit (database administration, network administrator, e-mail administrator, and so on) verifies that the request is one they can fulfil (from both a technological and a budgetary/business perspective).
        - The IT security unit verifies that this change will not cause any security problems.
        - The appropriate IT unit formulates a plan to implement the change and a plan to roll back the change in the event of some failure.
        - The date and time for the change is scheduled, and all relevant parties are notified.
    - Your change control process might not be identical to this one; in fact, yours might be much more specific. However, the key to remember is that in order for your network to be secure, you simply cannot have changes happening without some process for examining their impact prior to implementing them.
    - ### 9.4 Access Control
    - An important area of security policies that usually generates some controversy in any organisation is access control. There is always a conflict between users’ desire for unrestricted access to any data or resources on the network and the security administrator’s desire to protect that data and resources. You cannot simply lock down every resource as completely as possible because that would block the users’ access to those resources. Conversely, you cannot simply allow anyone and everyone complete access to everything.
    - It is worth keeping this acronym in mind when thinking about access control. Your goal is to make sure the data is accurate, confidential, and available only to authorised parties.
    - This is where the least privileges concept comes into play. The idea is simple. Each user, including IT personnel, gets the least access they can have to effectively do the job. Rather than asking the question “Why not give this person access to X?” you should ask “Why give this person access to X?” If you do not have a very good reason, then do not provide the access. This is one of the fundamentals of computer security. The more people who have access to any resource, the more likely some breach of security is to occur.
    - Clearly trade-offs between access and security must be made. One common example involves sales contact information. Clearly, a company’s marketing department needs access to this data. However, what happens if competitors get all of your company’s contact information? That information could allow them to begin targeting your current client list. This requires a trade-off between security and access. In this case, you would probably give sales people access only to the contacts that are within their territory. No one other than the sales manager should have complete access to all contacts.
- **Module 10 : Assessing System Security**
    - ## 10.1 Risk Assessment
    - Evaluating the security of a network always starts with a risk assessment. This involves considering the assets you are trying to protect, the threats against those assets, vulnerabilities in your systems, and what measures you can take to protect them. There are formulas for calculating risk.
    - The most basic calculation is for a single loss expectancy (SLE), or what impact a single loss will cause. This is calculated by multiplying the asset value (AV) by the exposure factor (EF). The exposure factor is a percentage value, representing how much of the asset’s value you will lose in a given incident. For example, a laptop that has depreciated by 20 percent is now only worth 80 percent of its original value, should it be lost or stolen. This formula is
    - SLE = AV × EF
    - Therefore, if a laptop is purchased for $800, and depreciates by 10 percent a year, thus yielding an exposure factor of .9 (90 percent), then the SLE for a stolen or lost laptop is
    - SLE = 800 (AV) × .9 (EF)
    - SLE = $720
    - The next formula is the annualized loss expectancy (ALE). This represents how much loss you can expect from a particular issue in a year. The formula is SLE multiplied by annual rate of occurrence (ARO):
    - ALE = SLE × ARO
    - So, in the previous laptop example, if you think you will lose six laptops per year, the calculation is
    - ALE = 720 (SLE) × 6 (ARO)
    - ALE = $4320
    - As you can see, the math is actually quite simple. Another concept to understand is residual risk. Basically, this is how much risk is left over after you have taken all the steps you can to deal with the risk. In addition, that topic brings us to the issue of how you deal with a risk you have identified. There are really only four categories of responses:
        - Mitigation: This means you take steps to lessen the risk. No matter what you do, there is likely to be some risk left. For example, if you are concerned about malware, then running antivirus is risk mitigation. This is the most common solution.
        - Avoidance: This is difficult to do. It means you have zero risk. For example, if you are concerned about users downloading a virus from a website, the only way to completely avoid that is to not give them access to the web. This is not usually a viable solution.
        - Transference: This is transferring the risk to someone else. The clearest example is cyber breach insurance. If you have such insurance, then the cost of a risk that is realized will be passed on to the insurance company.
        - Acceptance: If the probability of the risk is very remote, or the cost of mitigation is higher than the cost of the risk being realized, you may choose to do nothing, and simply accept the risk.
    - ## 10.2 Conducting an Initial Assessment
    - Disaster recovery, access rights, and appropriate policies are topics that are often overlooked by those new to security. To keep it simple and easy to remember, the stages of assessing a system’s security can be separated into the “Six Ps”:
        - Patch
        - Ports
        - Protect
        - Policies
        - Probe
        - Physical
    - You should note that these Six Ps are not yet standards in the security industry. They are provided here as a framework for approaching system security.
    - ### 10.2.1 Patches
    - Patching a system is perhaps the most fundamental part of security. Therefore, when assessing any system’s security, you should check to see whether a procedure is in place to govern the routine updating of all patches. And you should also, of course, check to see that the machines actually have current patches and updates. A written policy is essential, but when performing a security audit, you need to ensure that those policies are actually being followed.
    - As you are aware, operating system and application vendors occasionally discover security flaws in their products and release patches to correct these flaws. Unfortunately, it is not uncommon to find organisations in which patches have not been applied as late as 30 days or more after their release.
    - ### 10.2.2 Ports
    - All communication takes place via some port (TCP/UDP). This is also true for many virus attacks. Frequently virus attacks will utilize some uncommon port to gain access to your system. Recall that ports 1 through 1024 are assigned and used for well-known protocols. We have examined viruses, Trojan horses, and other dangers that operate on specific port numbers. If those ports are closed, then your vulnerability to these specific attacks is significantly reduced.
    - Unfortunately, some system administrators do not make a policy of closing unused ports. This is probably due to the fact that many administrators think that if the firewall is blocking certain traffic, then there is no need to block that port on individual machines. However, this approach provides you with only perimeter security, not layered security. By closing ports on individual machines, you provide a backup in case the firewall is breached.
    - As a rule, any port you do not explicitly need for operations should be closed, and communication should be disallowed on this port. A port is usually associated with a service. For example, an FTP service is often associated with ports 21 and 20. In order to close a port on an individual machine, you would need to shut down the service that uses that port. This means those unused services on servers and individual workstations should be shut down.
    - Both Windows and Linux have built-in firewall capability that will block certain ports. This means in addition to shutting down the particular unneeded services on all client machines, you should also shut down the ports.
    - You should also shut down any unused router ports in your network. If your network is part of a larger wide-area network (WAN), then it is likely you have a router connecting you to that WAN. Every open port is a possible avenue of entry for a virus or intruder. Therefore, every port you can close is one less opportunity for such attacks to affect your system.
    - The specifics of how to close a port on a router are particular to the individual router. The documentation that came with your router or your vendor should be able to provide you with specific instructions for how to accomplish this. If you have a vendor servicing your router, then you should make a list of all required ports and request that the vendor close all other ports on the router.
    - ### 10.2.3 Protect
    - The next phase is to ensure that all reasonable protective software and devices are employed. This means at a minimum having a firewall between your network and the outside world. Clearly, more advanced firewalls such as stateful packet inspection firewalls are preferred. When auditing a system, you must note not only whether the system has a firewall, but also what type of firewall it has. You should also consider using an intrusion detection system (IDS) on that firewall and any web servers.
    - However, IDSs are the only way to know of imminent attacks, and there are free, open source IDSs available. For that reason, most experts highly recommend them. The firewall and IDS will provide basic security to your network’s perimeter, but you also need virus scanning. Each and every machine, including servers, must have a virus scanner that is updated regularly. The point has already been made that a virus infection is the greatest threat to most networks. As also previously discussed, it is probably prudent to consider anti-spyware software on all of your systems. This will prevent users of your network from inadvertently running spyware on the network.
    - Finally, a proxy server is a very good idea. It not only masks your internal IP addresses, but most proxy servers allow you to discover what websites users visit and put on filters for certain sites. Many security experts consider a proxy server to be as essential as a firewall.
    - In addition to protecting your network, you must also protect data that is transmitted, particularly outside your network. All external connections should be made via a VPN. Having data encrypted prevents hackers from intercepting the data via a packet sniffer. For more secure locations, you might even look for all internal transmissions to be encrypted as well
    - In short, when assessing the protection of the network, check to see whether the following items are present, properly configured, and functioning:
        - Firewall
        - Antivirus protection
        - Anti-spyware protection
        - IDS
        - Proxy server or NAT
        - Data transmissions encryption
    - Be aware that the first two items are met in most networks. Any network that does not have a firewall or antivirus software is so substandard that the audit should probably stop at that point. In fact, it is unlikely that such an organisation would even bother to have a security audit. The IDS and data encryption options are probably less common; however, they should be considered for all systems.
    - ### 10.2.4 Physical
    - In addition to securing your network from unwanted digital access, you must also ensure that it has adequate physical security. The most robustly secure computer that is left sitting unattended in an unlocked room is not at all secure. You must have some policy or procedure governing the locking of rooms with computers as well as the handling of laptops, tablets, and other mobile computer devices. Servers must be in a locked and secure room with as few people as is reasonably possible having access to them. Backup tapes should be stored in a fireproof safe. Documents and old backup tapes should be destroyed before disposal (e.g., by melting tapes, de-magnetizing hard disks, breaking CDs).
    - Physical access to routers and switches should also be tightly controlled. Having the most high-tech, professional information security on the planet but leaving your server in an unlocked room to which everyone has access is a recipe for disaster. One of the most common mistakes in the arena of physical security is co-locating a router or switch in a janitorial closet. This means that, in addition to your own security personnel and network administrators, the entire cleaning staff has access to your router or switch, and any one of them could leave the door unlocked for an extended period of time.
    - There are some basic rules you should follow regarding physical security:
        - Server rooms: The room where servers are kept should be the most fire-resistant room in your building. It should have a strong door with a strong lock, such as a deadbolt. Only those personnel who actually have a need to go in the room should have a key. You might also consider a server room log wherein each person logs in when they enter or exit the room. There are actually electronic locks that record who enters a room, when they enter, and when they leave. Consult local security vendors in your area for more details on price and availability.
        - Workstations: All workstations should have an engraved identifying mark. You should also routinely inventory them. It is usually physically impossible to secure them as well as you secure servers, but you can take a few steps to improve their security.
        - Miscellaneous equipment: Projectors, CD burners, laptops, and so forth should be kept under lock and key. Any employee that wishes to use one should be required to sign it out, and it should be checked to see that it is in proper working condition and that all parts are present when it is returned.
    - These measures should be considered by all organisations. Some organisations go much further in ensuring physical security, and we will list some of the more extreme measures here. Most are probably more extreme than businesses require. However, if you deal with highly sensitive or classified data, then you might want to consider some or all of these measures.
        - Biometric locks to all server rooms, or equipment storage rooms. Such locks are triggered by a fingerprint scan, and the identity of the person as well as the time they entered the room are recorded.
        - All visitors to the building are logged in (both their entry and exit time) and are escorted by an employee at all times.
        - All bags are inspected when personnel leave, or at least some bags are inspected at random.
        - No portable devices that might record data are allowed on the premises. This includes USB drives, camera phones, or any device that might copy data or record screen images.
        - All printing is logged. Who printed, the time the printing occurred, the document name, and the document size.
        - All copying is logged, similarly to printing.
    - If you are in a situation that demands a greater than normal security level, these measures may be considered.
    - ## 10.3 Probing the Network
    - Perhaps the most critical step in assessing any network is to probe the network for vulnerabilities. This means using various utilities to scan your network for vulnerabilities. Some network administrators skip this step. They audit policies, check the firewall logs, check patches, and so on. However, the probing tools discussed in this section are the same ones that most hackers use.
    - If you want to know how vulnerable your network is, it is sensible to try the same tools that an intruder would use. In this section, we review the common scanning/probing tools. There are essentially three types of probes that are usually done. These are the same types of probes that skilled hackers use to evaluate your network:
        - Port scanning: This is a process of scanning the well-known ports (there are 1024) or even all the ports (there are 65,535) and seeing which ports are open. Knowing what ports are open tells a lot about a system. If you see that 160 and 161 are open that tells you that the system is using SNMP. From the perspective of a network administrator, there should be no ports open that are not necessary.
        - Enumeration: This is a process whereby the attacker tries to find out what is on the target network. Items such as user accounts, shared folders, printers, and so on are sought after. Any of these might provide a point of attack.
        - Vulnerability assessment: This is the use of some tool to seek out known vulnerabilities, or the attacker might try to manually assess vulnerabilities. Some outstanding tools are available for vulnerability assessment.
    - A number of tools are freely available on the Internet for active scanning. They range from the simple to complex. Anyone involved in preventing or investigating computer crimes should be familiar with a few of these. The most famous vulnerability scanners are Nessus, Qualys, Openvas, Netsparker, Acunetix, Nexpose Community, Retina and Core Impact.
    - ## 10.4 Guided Exercise: Probing the Network
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b9faa895-3114-46be-84bb-27f70fbeafe6/Annotation_2020-05-31_142653.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b9faa895-3114-46be-84bb-27f70fbeafe6/Annotation_2020-05-31_142653.png)
    - In this exercise you will use a tool called Nmap to scan and identify open ports on the Windows Server and Windows 10.
    - Login to Ubuntu Server. Once logged in run the command nmap 192.168.1.20 to find which ports are open on Windows Server.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ca249004-98e6-4293-aad5-3df0b53a85ed/Annotation_2020-05-31_142752.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ca249004-98e6-4293-aad5-3df0b53a85ed/Annotation_2020-05-31_142752.png)
    - Determine the actual service running on each port by running the command “nmap –sV 192.168.1.20”
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a3faabec-9e2f-4fbd-8644-8a8254295a80/Annotation_2020-05-31_142822.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a3faabec-9e2f-4fbd-8644-8a8254295a80/Annotation_2020-05-31_142822.png)
    - Run the command nmap 192.168.1.10 to identify the open ports on the Windows 10 machine.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/aafc58de-e1d0-457b-83c5-3cf1b0bfe446/Annotation_2020-05-31_142850.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/aafc58de-e1d0-457b-83c5-3cf1b0bfe446/Annotation_2020-05-31_142850.png)
    - Run the command nmap –sV 192.168.1.10 to identify theactual service running on the open ports.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/87883687-12ea-41f2-a79e-7e5a9e30b7e2/Annotation_2020-05-31_142917.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/87883687-12ea-41f2-a79e-7e5a9e30b7e2/Annotation_2020-05-31_142917.png)
    - ## 10.5 Vulnerabilities
    - It is important to understand precisely what a vulnerability is. A vulnerability is some flaw in a system that an attacker could exploit to attack the system.
    - ### 10.5.1 CVE
    - The most common list of vulnerabilities is the CVE list. Common Vulnerabilities and Exposures (CVE) is a list maintained by the Mitre Corporation at [](https://cve.mitre.org/)https://cve.mitre.org/. It is not only the most common, but also the most comprehensive vulnerability list. The CVE list was designed to provide a common name and description for a vulnerability. This allows security professionals to communicate effectively about vulnerabilities. In the past, CVEs had been designated by a CVE ID in the format of CVE-YYYY-NNNN. This format only allows 9,999 unique identifiers per year. The new format is CVE prefix + Year + Arbitrary Digits and allows for any number of digits.
    - ### 10.5.2 NIST
    - The U.S. National Institute of Standards and Technology maintains a database of vulnerabilities that you can access at [](https://nvd.nist.gov/)https://nvd.nist.gov/. NIST also uses the CVE format. For example, CVE-2017-12371 is described as “A ‘Cisco WebEx Network Recording Player Remote Code Execution Vulnerability’ exists in Cisco WebEx Network Recording Player for Advanced Recording Format (ARF) and WebEx Recording Format (WRF) files. A remote attacker could exploit this by providing a user with a malicious ARF or WRF file via email or URL and convincing the user to launch the file. Exploitation of this could cause an affected player to crash and, in some cases, could allow arbitrary code execution on the system of a targeted user.”
    - ### 10.5.3 OWASP
    - The Open Web Application Security Project is the standard for web application security. They publish a number of important documents. For our current purposes, the most important is their top 10 list, located at [](https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project)https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project. Every few years they publish a top 10 web application vulnerabilities list. This list contains the actual vulnerabilities most frequently found in web applications.
    - ## 10.6 Guided Exercise: Learning about Vulnerabilities
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f0e52407-afce-4ed3-9342-80b2384d204c/Annotation_2020-05-31_143238.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f0e52407-afce-4ed3-9342-80b2384d204c/Annotation_2020-05-31_143238.png)
    - In this exercise you will identify details regarding a specific vulnerability. You will need to use a web browser for this exercise not in the lab environment.
    - Open a web browser and type the following link [](https://cve.mitre.org/)https://cve.mitre.org.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b5d2ff37-84f2-45ad-928f-2b7d512fecbb/Annotation_2020-05-31_143349.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b5d2ff37-84f2-45ad-928f-2b7d512fecbb/Annotation_2020-05-31_143349.png)
    - From the menu click on Search CVE List. In the search box enter CVE-2019-0708 and click on Submit.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f665ec4c-09c9-47c6-b1df-0bb1990edd89/Annotation_2020-05-31_143429.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f665ec4c-09c9-47c6-b1df-0bb1990edd89/Annotation_2020-05-31_143429.png)
    - One entrie will be returned and click on it to learn more about that specific vulnerabilitiry.
    - ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3a13297e-c3fa-4ba5-bb97-148bd60c2388/Annotation_2020-05-31_143454.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3a13297e-c3fa-4ba5-bb97-148bd60c2388/Annotation_2020-05-31_143454.png)
    - Read the description carefully and you will note that the vulnerability affects the Remote Desktop Services on Windows machines.
    - ## 10.7 Documenting Security
    - By this point, you are undoubtedly aware that you need to document your security. However, you may not be clear as to exactly what documents you should have. Unfortunately, this is an area of network security for which there are not industry standards. There is no manual on documentation.
    - ### 10.7.1 Physical Security Documentation
    - You should have a document that lists physical security that is in place. Where are the machines located? This means documenting the location of every single server, workstation, router, hub, or other device. The documentation should contain serial numbers as well as what personnel have access to them. If a device is in a locked room, then the documentation should also have a list of who has keys to that room.
    - If you log entry to secured rooms, then copies of those logs should be filed with your other physical documentation. In even a medium-sized network, this would quickly become a rather hefty file rather than a single document. You may consider implementing some method whereby after a certain period of time (1 year, for example) the access logs are archived, then after a longer period of time (such as 3 years) they are destroyed.
    - ### 10.7.2 Policy and Personnel Documentation
    - All policies must be on file. Any revisions should be filed along with the originals. Assuming you have employees sign an agreement stating they are aware of the policies (and you absolutely should), then copies of that should also be on file.
    - Along with policy documentation, you should keep a list of personnel along with what items they have access to. This includes physical access as well as any machines (servers, workstations, or routers) that they have login rights. You should also note what level of access they have (standard user, power user, administrator, and so on).
    - ### 10.7.3 Probe Documents
    - Any time you conduct any security audit, a report of that audit should be filed. Even audits done by outside consultants should be kept on file. The audit report should include any flaws found, and have a follow-up report of what steps were taken to correct them.
    - Should you have a security incident (such as a virus infection or intruder), there should be at least a brief memo summarizing what occurred. That document should state what the security incident was, when it occurred, what machines were affected, and how it was corrected.
    - ### 10.7.4 Network Protections Documents
    - The most obvious item to document is exactly what network protections you have in place. This documentation should detail the following:
        - What firewall are you using and how is configured.
        - What IDS are you using and how is configured.
        - What antivirus and/or anti-spyware you are using.
        - Have you configured any honeypots?
        - What individual machine security measures (such as workstation firewalls) have you taken?
    - One note of caution: These documents should be kept under lock and key, with only limited access. If an intruder were to get access to these documents, they would have a detailed analysis of your network’s weaknesses.
- **Module 11 : Security Standards**
    - ## 11.1 ISO Standards
    - The International Organisation for Standardization creates standards for a wide range of topics. There are hundreds of such standards, and it would be impossible to cover them in a single chapter. In fact, each standard could be the subject of a chapter, or at least a few chapters. Some of the more important standards for network security are listed here:
        - **ISO/IEC 15408:** The Common Criteria for Information Technology Security Evaluation
        - **ISO/IEC 25000:** Systems and Software Engineering
        - **ISO/IEC 27000:** Information technology — Security Technology
        - **ISO/IEC 27001:** Information Security Management
        - **ISO/IEC 27005:** Risk Management
        - **ISO/IEC 27006:** Accredited Certification Standard
        - **ISO/IEC 28000:** Specification for security management systems for the supply chain
        - **ISO 27002:** Information Security Controls
        - **ISO 27003:** ISMS Implementation
        - **ISO 27004:** IS Metrics
        - **ISO 27005:** Risk management
        - **ISO 27006:** ISMS certification
        - **ISO 27007:** Management System Auditing
        - **ISO 27008:** Technical Auditing
        - **ISO 27010:** Inter-organisation communication
        - **ISO 27011:** Telecommunications
        - **ISO 27033:** Network security
        - **ISO 27034:** Application security
        - **ISO 27035:** Incident Management
        - **ISO 27036:** Supply chain
        - **ISO 27037:** Digital forensics
        - **ISO 27038:** Document reduction
        - **ISO 27039:** Intrusion prevention
        - **ISO 27040:** Storage security
        - **ISO 27041:** Investigation assurance
        - **ISO 27042:** Analysing digital evidence
        - **ISO 27043:** Incident Investigation
    - ## 11.2 NIST Standards
    - The U.S. National Institute of Standards and Technology establishes standards for a wide range of things. Some of the standards most important to network security are discussed in this section.
    - ### 11.2.1 NIST SP 800-14
    - Special Publication 800-14, Generally Accepted Principles and Practices for Securing Information Technology Systems, describes common security principles that should be addressed within security policies. The purpose of this document is to describe 8 principles and 14 practices that can be used to develop security policies. This standard is based on 8 principles, which are:
        - Computer security supports the mission of the organisation.
        - Computer security is an integral element of sound management.
        - Computer security should be cost-effective.
        - System owners have security responsibilities outside their own organisations.
        - Computer security responsibilities and accountability should be made explicit.
        - Computer security requires a comprehensive and integrated approach.
        - Computer security should be periodically reassessed.
        - Computer is security is constrained by societal factors.
    - ### 11.2.2 NIST SP 800-35
    - NIST SP 800-35, Guide to Information Technology Security Services, is an overview of information security. In this standard six phases of the IT security life cycle are defined:
        - **Phase 1: Initiation.** At this point the organisation is looking into implementing some IT security service, device, or process.
        - **Phase 2: Assessment.** This phase involves determining and describing the organisation’s current security posture. It is recommended that this phase use quantifiable metrics.
        - **Phase 3: Solution.** This is where various solutions are evaluated and one or more are selected.
        - **Phase 4: Implementation.** In this phase the IT security service, device, or process is implemented.
        - **Phase 5: Operations.** Phase 5 is the ongoing operation and maintenance of the security service, device, or process that was implemented in phase 4.
        - **Phase 6: Closeout.** At some point, whatever was implemented in phase 4 will be concluded. Often this is when a system is replaced by a newer and better system.
    - ### 11.2.3 NIST SP 800-30 Rev. 1
    - NIST SP 800-30 Rev. 1, Guide for Conducting Risk Assessments, is a standard for conducting risk assessments. Risk assessments were discussed in a previous chapter. This standard provides guidance to how to conduct such an assessment. There are nine steps in the process:
    - **STEP 1.** System Characterization
    - **STEP 2.** Threat Identification
    - **STEP 3.** Vulnerability Identification
    - **STEP 4.** Control Analysis
    - **STEP 5.** Likelihood Determination
    - **STEP 6.** Impact Analysis
    - **STEP 7.** Risk Determination
    - **STEP 8.** Control Recommendations
    - **STEP 9.** Results documentation
    - ## 11.3 General Data Protection Regulation (GDPR)
    - This is a European Union law first created in 2016. Its entire purpose is to deal with data privacy. It applies to any entity (business, government agency, etc.) that either collects data or processes that data. Even if an organisation is not within the EU, if it has EU data, then GDPR applies.
    - ## 11.4 PCI DSS
    - The Payment Card Industry Data Security Standard (PCI DSS) is a proprietary information security standard for organisations that handle cardholder information for the major credit and debit cards such as VISA and MasterCard. This industry regulation has several goals and the most important are listed below:
    - 1.1 Requirement: All merchants must protect cardholder information by installing a firewall and router system. Installing a firewall system provides control over who can access an organisation’s network and a router is a device that connects networks, and is therefore, PCI compliant.
    - Program the standards of firewall and router to:
    - **1.** Perform testing when configurations change
    - **2.** Identify all connections to cardholder information
    - **3.** Review configuration rules every six months
    - Configure firewall to prohibit unauthorised access from networks and hosts and deny direct public access to any information about the cardholder. Additionally, install firewall software on all computers that access the organisation’s PCI compliance network.
    - 1.2 Requirement: Change all default passwords. Default passwords provided when first setting up software are discernible and can be easily discovered by hackers to access sensitive information.
    - 2.1 Requirement: Cardholder data is any personal information about the cardholder that is found on the payment card and can never be saved by a merchant—this includes preserving encrypted authentication data after authorization. Merchants can only display the maximum of the first six and last four digits of the primary account number (PAN). If a merchant stores PAN, ensure that the data is secure by saving it in a cryptographic form.
    - 2.2 Requirement: It is required that all information is encrypted when transmitting the data across public networks, such as the Internet, to prevent criminals from stealing the personal information during the process.
    - 3.1 Requirement: Computer viruses make their way onto computers in many ways, but mainly through e-mail and other online activities. The viruses compromise the security of personal cardholder information on a merchant’s computer, and therefore antivirus software must be present on all computers associated on the network.
    - 3.2 Requirement: In addition to antivirus software, computers are also susceptible to a breach in the applications and systems installed on the computer. Merchants must install vendor-provided security patches within a month of their release to avoid exposing cardholder data. Security alert programs, scanning services, or software may be used to signal the merchant of any vulnerable information.
    - 4.1 Requirement: As a merchant, you must limit the accessibility of cardholder information. Install passwords and other security measurements to limit employees’ access to cardholder data. Only employees who must access the information to complete their job are allowed to access the information.
    - 4.2 Requirement: In order to trace employees’ activities when accessing sensitive information, assign each user an unreadable password used to access the cardholder data.
    - 4.3 Requirement: Monitor the physical access to cardholder data; do not allow unauthorised persons the opportunity to retrieve the information by securing printed information as well as digital. Destroy all outdated cardholder information. Maintain a visitor log and save the log for at least three months.
    - 5.1 Requirement: Keep system activity logs that trace all activity and review daily. The information stored in the logs is useful in the event of a security breach to trace employee activities and locate the source of the violation. Record entries reflect at a minimum: the user, event, date and time, success or failure signal, source of the affected data, and the system component.
    - **5.2 Requirement:** Each quarter, use a wireless analyser to check for wireless access points to prevent unauthorised access. Also, scan internal and external networks to identify any possible vulnerable areas in the system. Install software to recognise any modification by unauthorised personnel. Additionally, ensure that all IDS/IPS engines are up to date.
    - If you process credit cards, it is imperative that you comply with this standard.
- **Module 12 : Physical Security and Recovery**
    - 
